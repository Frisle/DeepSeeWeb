"use strict";window.dsw={},window.dsw.mobile=screen.availWidth<=600,window.dsw.desktop=!0,function(){function e(e,t,o){var r;"js"==t?((r=document.createElement("script")).setAttribute("type","text/javascript"),r.setAttribute("src",e)):"css"==t&&((r=document.createElement("link")).setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href",e)),void 0!==r&&(r.onload=o,document.getElementsByTagName("head")[0].appendChild(r,0))}function c(e,s,a){if(!e||!e.length&&!localStorage.devAddons)return s.when();for(var n=[],t=0;t<e.length;t++){var l=e[t]+"?tmp="+Date.parse(new Date);if(localStorage.connectorRedirect&&(l=localStorage.connectorRedirect.split("/").slice(0,-2).join("/")+l),l&&!localStorage.devAddons){var o=s.defer();n.push(o.promise),a.load(l).then(function(e){return function(){e.resolve()}}(o)).catch(function(t,e,o){return function(e){alert("Can't load addon: "+o),t.resolve()}}(o,0,name))}}localStorage.devAddons&&JSON.parse(localStorage.devAddons).forEach(function(e){dsw.addons||(dsw.addons=[]),dsw.addons.push(e);var t,o,r,i=s.defer();n.push(i.promise),a.load(e).then((r=i,function(){r.resolve()})).catch((t=i,o=l,function(e){alert("Can't load addon: "+o+" "+e),t.resolve()}))});return 0===n.length?s.when():s.all(n)}function t(r,i,s,a,e,n){if(!dsw.mobile||dsw.desktop||localStorage.connectorRedirect){var l=i.defer();return void 0!==e.current.params.ns&&(e.current.params.ns||"").toLowerCase()!==(localStorage.namespace||"").toLowerCase()?(delete sessionStorage.dashboarList,d(s,i,r).then(function(){t()}).catch(function(){r.gotoLoginPage()})):r.firstRun?t():l.resolve(),l.promise}function t(){function t(e){a.$broadcast("toggleMenu",!0),a.$broadcast("refresh",!0),s.loadConfig(e),r.loadAddons().catch(function(e){console.log("Can't load addons: "+e)}).then(function(e){if(e&&e.length){dsw.addons=e.slice();for(var t=0;t<dsw.addons.length;t++){var o=dsw.addons[t].split(".");o.pop(),dsw.addons[t]=o.join(".")}}return c(e,i,n)}).then(function(){a.$broadcast("addons:loaded",null)}).then(d(s,i,r)).then(function(){l.resolve()})}function o(){r.loadConfig(e.current.params.ns).catch(function(e){t()}).then(t).catch(function(e){l.resolve()})}r.loadMainConfig().then(function(e){return o()}).catch(function(e){return o()})}r.gotoLoginPage()}function d(t,e,o){var r=e.defer();return o.getSettings().then(function(e){t.loadServerSettings(e),r.resolve()}).catch(function(e){r.resolve()}),r.promise}if(window.dsw.mobile,angular.module("dashboard",[]),angular.module("widgets",[]),angular.module("templates",[]),angular.module("utils",[]),angular.module("app",["oc.lazyLoad","ngRoute","ngCookies","cgNotify","gridster","highcharts-ng","ng-context-menu","ngDialog","utils","dashboard","widgets","templates","color.picker"]).filter("sanitize",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]).constant("CONST",{themes:[{text:"Default",file:""},{text:"Contrast",file:"themes/contrast.css"},{text:"Metro",file:"themes/metro.css"},{text:"Black",file:"themes/black.css"}],bgColorClasses:["","cl1","cl2","cl3","cl4","cl5","cl6","cl7","cl8","cl9"],fontColors:["fc1","fc2","fc3","fc4","fc5"],icons:["","","","","","","","","","","","","","","","","","","","","","","","","","","",""],timeout:6e4,ver:"2.1.51",emptyWidgetClass:"MDX2JSON.EmptyPortlet".toLowerCase()}).config(["$routeProvider",function(e){e.when("/",{templateUrl:"src/views/home.html",controller:"home",resolve:{config:["Connector","$q","Storage","$rootScope","$route","$ocLazyLoad",t]}}).when("/d/:path*",{templateUrl:"src/views/dashboard.html",controller:"dashboard",resolve:{config:["Connector","$q","Storage","$rootScope","$route","$ocLazyLoad",t]}}).when("/f/:folder*",{templateUrl:"src/views/home.html",controller:"home",resolve:{config:["Connector","$q","Storage","$rootScope","$route","$ocLazyLoad",t]}}).when("/login",{templateUrl:"src/views/login.html",controller:"login"}).otherwise({redirectTo:"/"})}]).run(["gridsterConfig","Lang","CONST","Connector","$route","$routeParams",function(e,t,o,r,i,s){e.draggable.handle=".widget-title-drag",e.resizable.handles=["se"],e.columns=12,e.floating=!0,e.pushing=!0,e.defaultSizeX=2,e.defaultSizeY=2,e.isResizing=!1,e.isDragging=!1,e.margins=[5,5],e.isMobile=dsw.mobile,dsw.mobile&&(e.mobileBreakPoint=2e3);-1!==window.location.href.split("#").pop().indexOf("widget=")&&(e.mobileBreakPoint=0);e.resizable.start=function(){e.isResizing=!0},e.resizable.stop=function(){e.isResizing=!1},e.draggable.start=function(){e.isDragging=!0},e.draggable.stop=function(){e.isDragging=!1}}]),dsw.mobile){e("cordova.js","js"),e("css/mobile.css","css");var o=console.error;console.error=function(e){o.apply(this,arguments),dsw.erros||(dsw.errors=[]),dsw.errors.push(e)},document.addEventListener("DOMContentLoaded",function(){document.body.style["background-color"]="black",FastClick.attach(document.body)},!1)}}(),angular.module("app").service("Utils",function(){this.merge=function e(t,o){if(o.constructor===Array){t=[];for(var r=0;r<o.length;r++)"object"==typeof o[r]?t[r]=e({},o[r]):t[r]=o[r];return t}for(var i in o)if(o.hasOwnProperty(i))try{o[i].constructor==Object&&(t[i]=e(t[i]||{},o[i])),o[i].constructor==Object?t[i]=e(t[i]||[],o[i]):t[i]=o[i]}catch(e){t[i]=o[i]}return t},this.removeExt=function(e){var t=e.split(".");return 1===t.length?e:(t.pop(),t.join("."))},this.replaceFilename=function(e,t){var o=e.split("/");return o[o.length-1]=t,o.join("/")},this.isEmbedded=function(){for(var e=window.location.hash.replace("?","").replace("#/","").split("&"),t=0;t<e.length;t++)if(-1!==e[t].indexOf("widget="))return!0;return-1!==e.indexOf("embed=1")}}),angular.module("app").directive("widget",["$compile","CONST",function(i,e){return{scope:!0,restrict:"E",templateUrl:"src/views/widget.html",link:function(e,r,t){if(e._elem=r,dsw.mobile){r[0].offsetTop,$(".navbar").get(0).offsetHeight;e.item.toolbar&&61,"src/views/emptyWidgetToolbar.html"===e.item.toolbarView&&($(r[0].parentElement).addClass("mobile-filters-widget").css("display","none"),e.$on("globalShowFilters",function(e,t){if(t){var o=$(r[0].parentElement).parents("#mobileDashboard").css("transform");$(r[0].parentElement).css("display","block").css("transform",o.replace(/-/g,""))}else $(r[0].parentElement).css("display","none")}))}var o=e.$on("typeChanged",function(){o(),r.empty(),i(r)(e)});e.$on("$destroy",function(){e._elem=null})}}}]),angular.module("app").directive("mobileSlider",["$timeout",function(e){return{restrict:"AE",link:function(a,e){if(window.dsw.mobile){var n=e[0];n.addEventListener("touchstart",function(e){l=e.touches[0].screenX,c=u,d=performance.now()},!1),n.addEventListener("touchend",function(e){var t=e.changedTouches[0].screenX-l,o=window.innerWidth;u+=t;var r=-0==$(e.target).parents(".mobile-filters-widget").length;if(Math.abs(t)<50||!r||1!==e.changedTouches.length||300<performance.now()-d)u=c,$(n).css("transform","translateX(-"+u+"px)");else{var i=Math.floor(c/o);t<0?i++:i--;var s=a.model.items.filter(function(e){return"src/views/emptyWidgetToolbar.html"!==e.toolbarView}).length-1;i<0&&(i=0),s<i&&(i=s),u=i*o,$(n).css("transform","translateX(-"+u+"px)")}},!1),n.addEventListener("touchmove",function(e){if($(e.target).parents(".lpt").length)return;e.preventDefault()},!1);var l,c,d,u=0}}}}]),angular.module("app").directive("widgetContent",["$parse","$compile","TypeMap",function(o,i,s){return{compile:function(e,t){var r=o(t.widgetContent);return function(t,o){o.removeAttr("widget-content"),function(){switch(s.getType(r(t))){case"chart":o.attr("highchart",""),o.attr("id",'{{"chart" + item.key}}'),o.attr("config","chartConfig");break;case"pivot":o.attr("pivot","");break;case"text":o.attr("text-widget","");break;case"map":o.attr("map-widget","");break;case"custom":var e=s.getDesc(r(t)).addonInfo;e&&o.attr(e.directive,"");break;case"empty":o.append("<div class='empty-widget' ng-include=\"'src/views/emptyWidgetContent.html'\"></div>")}}(),i(o)(t)}}}}]),angular.module("app").directive("jsonEditor",["$q",function(n){return{restrict:"AC",link:function(e,t){function o(e,t,o){var r;"js"==t?((r=document.createElement("script")).setAttribute("type","text/javascript"),r.setAttribute("src",e)):"css"==t&&((r=document.createElement("link")).setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href",e)),void 0!==r&&(r.onload=o,document.getElementsByTagName("head")[0].appendChild(r,0))}t.removeAttr("map-widget");var r,i,s=n.defer(),a=n.defer();o("https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/4.2.1/jsoneditor.js","js",function(){s.resolve()}),o("https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/4.2.1/jsoneditor.min.css","css",function(){a.resolve()}),r=t,i=e,n.all([s.promise,a.promise]).then(function(){i.editor=new JSONEditor(r[0],{mode:"code",indentation:4}),i.onInit&&i.onInit()})}}}]),angular.module("app").service("Storage",["CONST","Lang","Utils","$rootScope","$location","Connector",function(r,c,e,d,i,u){var h=this;function o(){var e=u.getNamespace().toLowerCase();if(h.isLocalStorage){var t=JSON.parse(localStorage.userSettings||"{}");t[e]=h.settings,localStorage.userSettings=JSON.stringify(t)}else{var o=JSON.parse(sessionStorage.userSettings||"{}");o[e]=h.settings,sessionStorage.userSettings=JSON.stringify(o)}}this.settings={},this.serverSettings={},this.configLoaded=!1,this.loadConfig=function(e){if(h.settings={},h.configLoaded=!0,e)if(e.constructor===Object)h.settings=e;else{var t;try{t=JSON.parse(e)}catch(e){t={}}h.settings=t}var o=null,r=u.getNamespace().toLowerCase();localStorage.userSettings&&(o=JSON.parse(localStorage.userSettings)[r]);sessionStorage.userSettings&&(o=JSON.parse(sessionStorage.userSettings)[r]);o&&(h.settings=o);var i=h.getAppSettings();window.dsw.mobile||i.theme&&document.getElementById("pagestyle").setAttribute("href","css/"+i.theme);c.current=i.language||"en",d.$broadcast("lang:changed");for(var s=Highcharts.getOptions().colors,a=1;a<=s.length;a++){var n=$(".hc"+a.toString()).css("background-color").toLowerCase();"rgba(0, 0, 0, 0)"!==n&&"transparent"!==n&&(s[a-1]=n)}var l=i.themeColors[i.theme]||{};Highcharts.setOptions({chart:{backgroundColor:l.hcBackground},labels:{style:{color:l.hcTextColor}},colors:l.hcColors||s,global:{useUTC:!1},lang:{loading:"<div class='loader'></div>",shortMonths:c.get("shortMonths"),rangeSelectorZoom:c.get("zoom"),rangeSelectorFrom:c.get("from"),rangeSelectorTo:c.get("to"),noData:c.get("noData")}})},this.getAppSettings=function(){var e=i.search().lang;h.settings.app||(h.settings.app={});var t=h.settings.app;e&&(t.language=e);t.themeColors||(t.themeColors={});var o=i.search().theme;(o=o&&r.themes.find(function(e){return e.text===o}))&&(t.theme=o.file);return t},this.setAppSettings=function(e){h.settings.app=e,o()},this.getWidgetsSettings=function(e){return h.settings&&h.settings.ns&&h.settings.ns.widgets&&h.settings.ns.widgets[e]||{}},this.setWidgetsSettings=function(e,t){h.settings||(h.settings={});h.settings.ns||(h.settings.ns={});h.settings.ns.widgets||(h.settings.ns.widgets={});h.settings.ns.widgets[t]=angular.copy(e),o()},this.getTilesSettings=function(){return h.settings&&h.settings.ns&&h.settings.ns.tiles||{}},this.setTilesSettings=function(e){h.settings||(h.settings={});h.settings.ns||(h.settings.ns={});h.settings.ns.tiles=angular.copy(e),o()},this.getAllSettings=function(){return h.settings},this.loadServerSettings=function(e){h.serverSettings=e||{},d.$broadcast("servSettings:loaded")},this.setAllSettings=function(e){h.settings=e,o()},this.isLocalStorage=!1,function(){try{localStorage.setItem("test","test")}catch(e){return}h.isLocalStorage=!0,delete localStorage.test}()}]),angular.module("app").service("Error",["notify",function(t){t.config({startTop:56,position:"center"}),this.show=function(e){console.error(e),t({message:e,classes:["gmail-notify"]})}}]),angular.module("app").service("Filters",["$rootScope","Connector","Storage","Lang","$location","Utils",function(s,c,d,u,h,p){var g=this;function f(e){if(""===e.value||void 0===e.value)return"";var t=e.value,o=!1;"string"==typeof t&&(o=t.toUpperCase().endsWith(".%NOT")),o&&(t=t.substr(0,t.length-5)),e.value=t;for(var r=0;r<e.values.length;r++)if(e.values[r].path===t)return e.values[r].checked=!0,e.values[r].default=!0,e.defaultExclude=o,e.isExclude=o,e.values[r].name;return""}this.items=[],this.isFiltersOnToolbarExists=!1,this.init=function(e,t){this.filtersChanged=!0,g.dashboard=t,g.items=[],g.isFiltersOnToolbarExists=!1;for(var o=0;o<e.length;o++){g.items.push(e[o]);var r=g.items[g.items.length-1];if(r.valueList&&r.displayList){var i=r.valueList.split(","),s=r.displayList.split(",");r.values=[];for(var a=0;a<i.length;a++)r.values.push({name:s[a],path:i[a]})}if(r.targetArray=[],"*"!==r.target&&""!==r.target&&(r.targetArray=r.target.split(",").concat(["emptyWidget"])),r.sourceArray=[],"*"!==r.source&&""!==r.source&&"dashboard"!==r.location&&(r.sourceArray=r.source.split(",")),""!==r.source&&"dashboard"!==r.location||(g.isFiltersOnToolbarExists=!0),r.label){var n=r.label.match(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(\/\/.*)/g);if(n&&0!==n.length){var l=n[0].substring(2,n[0].length-2);r.additionalParams=l.toLowerCase().trim().split(","),console.log(l),-1!==r.additionalParams.indexOf("inverseorder")&&(r.values=r.values.reverse()),-1!==r.additionalParams.indexOf("ignorenow")&&(r.values=r.values.filter(function(e){return"&[now]"!==e.path.toLowerCase()}))}r.label=r.label.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(\/\/.*)/g,"")}r.valueDisplay=f(r)}(function(){if(p.isEmbedded())return;if(!d.getAppSettings().isSaveFilters)return;var e=d.getWidgetsSettings(g.dashboard,c.getNamespace());if(e._filters)for(var t=0;t<e._filters.length;t++){var o=e._filters[t],i=g.items.filter(function(e){return e.targetProperty===o.targetProperty})[0];if(i){if(i.value=o.value,i.isExclude=o.isExclude,i.isInterval=o.isInterval,i.isInterval)i.fromIdx=o.fromIdx,i.toIdx=o.toIdx,i.valueDisplay=i.values[i.fromIdx].name+":"+i.values[i.toIdx].name;else{var r=o.value.split("|");i.values.forEach(function(e){-1!==r.indexOf(e.path)&&(e.checked=!0)}),i.valueDisplay=o.value.split("|").map(function(t){var e=-1!==t.indexOf(".%NOT");e&&(t=t.replace(".%NOT",""));var o=i.values.find(function(e){return e.path==t}),r="";return o&&o.name&&(r=o.name.toString()),(e?u.get("not")+" ":"")+r}).join(",")}!0}}})(),function(){var e=h.search().FILTERS;if(!e)return;for(var t=e.split(";"),o=null,s="",r=0;r<t.length;r++){var i=t[r].split(":");"target"!==i[0].toLowerCase()?"filter"===i[0].toLowerCase()&&(s=i.slice(1).join(":")):o=i[1]}var a=[];a="*"!=o?g.items.filter(function(e){return-1!==e.targetArray.indexOf(o)||e.target===o||"*"===e.target}):g.items.slice();a.forEach(function(e){for(var t=s.split("~"),o=0;o<t.length;o++){var r=t[o];if(-1!==r.indexOf("{")){if(r.substring(0,r.indexOf("{")-1).replace("%NOT ","")!==e.targetProperty)continue;var i=r.match(/\{([^)]+)\}/)[1].split(",");e.value=i.join("|"),e.valueDisplay=i.map(function(e){return e.replace("&[","").replace("]","")}).join(",")}else{if(r.split(".&")[0]!==e.targetProperty)continue;e.value="&"+r.split(".&")[1],e.valueDisplay=f(e)}}})}()},this.getWidgetModelFilters=function(e){for(var t=[],o=0;o<g.items.length;o++)"hidden"!==g.items[o].type&&"click"!==g.items[o].location&&("emptyWidget"!==e||""!==g.items[o].source&&"dashboard"!==g.items[o].location?"dashboard"!==g.items[o].location&&("*"!==g.items[o].source&&-1===g.items[o].sourceArray.indexOf(e)||t.push({idx:o,label:g.items[o].label,text:g.items[o].valueDisplay,info:g.items[o].info})):t.push({idx:o,label:g.items[o].label,text:g.items[o].valueDisplay,info:g.items[o].info}));return t},this.getWidgetFilters=function(e){for(var t=[],o=0;o<g.items.length;o++)"*"!==g.items[o].target&&""!==g.items[o].target&&-1===g.items[o].targetArray.indexOf(e)||t.push(g.items[o]);return t},this.applyFilter=function(e,t){var o,r="",i="";for(o=0;o<e.values.length;o++)e.values[o].checked&&(r+=e.values[o].name+",",i+=e.values[o].path+"|");""!==r&&(r=r.substr(0,r.length-1));""!==i&&(i=i.substr(0,i.length-1));if(e.valueDisplay=r,e.value=i,!t)if(0!==e.targetArray.length)for(o=0;o<e.targetArray.length;o++)s.$broadcast("filter"+e.targetArray[o],e);else"*"!==e.target&&""!==e.target||s.$broadcast("filterAll",e);g.filtersChanged=!0,function(){var e,t;if(!1===d.getAppSettings().isSaveFilters)return;var o=[];for(e=0;e<g.items.length;e++)""===(t=g.items[e]).value&&!t.isInterval||o.push(t);var r=o.map(function(e){return{targetProperty:e.targetProperty,value:e.value,isExclude:e.isExclude,isInterval:e.isInterval,fromIdx:e.fromIdx,toIdx:e.toIdx}}),i=d.getWidgetsSettings(g.dashboard,c.getNamespace());r.length?i._filters=r:delete i._filters;d.setWidgetsSettings(i,g.dashboard,c.getNamespace())}()},this.getFilter=function(e){return g.items[e]?g.items[e]:void 0},this.clear=function(){g.items=[]},this.getClickFilterTarget=function(e){for(var t=0;t<g.items.length;t++){var o=g.items[t];if("click"===o.location&&(o.source.toLowerCase()===e.toLowerCase()||"*"===o.source))return o.target}},this.getAffectsFilters=function(t){return g.items.filter(function(e){return"*"===e.target||-1!==e.targetArray.indexOf(t)})},this.getFiltersUrlString=function(e){for(var t=[],o=e?g.getAffectsFilters():g.items,r=0;r<o.length;r++){var i=o[r];if(i.value||i.isInterval){var s="";-1!==(s=i.isInterval?i.targetProperty+"."+i.values[i.fromIdx].path+":"+i.values[i.toIdx].path:i.targetProperty+"."+(i.isExclude?"%NOT ":"")+i.value).indexOf("|")&&(s=s.replace(/\|/g,",").replace("&[","{&[")+"}"),t.push(s)}}return encodeURIComponent(t.join("~"))},this.getFiltersShareUrl=function(){var e=window.location.href,t=(e=function(e,t){return e.replace(new RegExp("[?&]"+t+"=[^&#]*(#.*)?$"),"$1").replace(new RegExp("([?&])"+t+"=[^&]*&"),"$1")}(e,"FILTERS")).split("#")[1],o=g.getFiltersUrlString(),r="FILTERS=TARGET:*;FILTER:"+o;o&&(t&&-1!==t.indexOf("?")?e+="&"+r:e+="?"+r);return e},this.dashboard="",this.filtersChanged=!1}]),angular.module("app").service("Variables",["$rootScope",function(e){var i=this;this.items=[],this.init=function(e){if(i.items=[],i.widgets=[],!e.widgets)return;for(var t=0;t<e.widgets.length;t++){var o=e.widgets[t];i.widgets.push(o);for(var r=0;r<o.controls.length;r++)"applyvariable"===o.controls[r].action.toLowerCase()&&i.items.push(o.controls[r])}},this.clear=function(){i.items=[]},this.isExists=function(){return 0!==i.items.length},this.widgets=[]}]),angular.module("app").controller("settings",["$scope","$window","Storage","Utils","Error","Lang","$rootScope","Connector","ngDialog","CONST",function(o,e,r,i,t,s,a,n,l,c){var d=r.getAppSettings(),u=!1,h=o.ngDialogData.isWidgetSettings;function p(e){var t=e.target.files[0];if(t){var o=new FileReader;o.onload=function(e){var t=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e.target.result)));r.setAllSettings(t),g()},o.readAsArrayBuffer(t)}else iasufr.alert("Помилка завантаження файла")}function g(){e.location.reload()}o.model={isWidgetSettings:h,themes:c.themes,showFolders:!d.hideFolders,theme:d.theme||"",isSaveFilters:void 0===d.isSaveFilters||d.isSaveFilters,isRelatedFilters:void 0===d.isRelatedFilters||d.isRelatedFilters,showImages:d.showImages,langs:s.getLanguages(),language:s.current,colCount:d.colCount||12,widgetHeight:d.widgetHeight,colorPickerOpt:{format:"rgb"}},o.model.themeColors=d.themeColors[o.model.theme]||{},o.ngDialogData.widgetSettings&&(o.ngDialogData.widgetSettings.themeColors[o.model.theme]||(o.ngDialogData.widgetSettings.themeColors[o.model.theme]={}),o.model.themeColors=o.ngDialogData.widgetSettings.themeColors[o.model.theme]),function(){var e=o.model.themeColors;e.hcColors||(e.hcColors=Highcharts.getOptions().colors.slice());e.hcTextColor||(e.hcTextColor=Highcharts.getOptions().labels.style.color);e.hcBackground||(e.hcBackground=Highcharts.getOptions().chart.backgroundColor)}(),o.applySettrings=function(){var e=i.merge({},d);d.language=o.model.language||"en",d.hideFolders=!o.model.showFolders,d.showImages=!!o.model.showImages,d.theme=o.model.theme,d.isSaveFilters=!!o.model.isSaveFilters,d.isRelatedFilters=!!o.model.isRelatedFilters,d.colCount=o.model.colCount,d.widgetHeight=o.model.widgetHeight,d.themeColors[d.theme]||(d.themeColors[d.theme]={});var t=d.themeColors[d.theme];h&&(o.ngDialogData.widgetSettings.themeColors||(o.ngDialogData.widgetSettings.themeColors={}),o.ngDialogData.widgetSettings.themeColors[d.theme]||(o.ngDialogData.widgetSettings.themeColors[d.theme]={}),t=o.ngDialogData.widgetSettings.themeColors[d.theme]);d.theme!==e.theme&&!h||(d.themeColors[d.theme]||(d.themeColors[d.theme]={}),t.hcColors=o.model.themeColors.hcColors,t.hcTextColor=o.model.themeColors.hcTextColor,t.hcBackground=o.model.themeColors.hcBackground,t.hcLineColor=o.model.themeColors.hcLineColor,t.hcBorderColor=o.model.themeColors.hcBorderColor,t.hcOpacity=o.model.themeColors.hcOpacity,h||Highcharts.setOptions({chart:{backgroundColor:t.hcBackground},colors:t.hcColors,labels:{style:{color:t.hcTextColor}}}));e.hcOpacity!==t.hcOpacity&&(u=!0);e.hcBorderColor!==t.hcBorderColor&&(u=!0);e.hcLineColor!==t.hcLineColor&&(u=!0);e.hcTextColor!==t.hcTextColor&&(u=!0);e.hcBackground!==t.hcBackground&&(u=!0);e.language!==d.language&&(u=!0);e.theme!==d.theme&&(u=!0);e.isSaveFilters!==d.isSaveFilters&&(u=!0);e.isRelatedFilters!==d.isRelatedFilters&&(u=!0);e.hideFolders!==d.hideFolders&&(u=!0);e.showImages!==d.showImages&&(u=!0);e.colCount!==d.colCount&&(u=!0);e.widgetHeight!==d.widgetHeight&&(u=!0);if(h)return o.ngDialogData.saveWidgetSettings(),void o.closeThisDialog();r.setAppSettings(d),u?g():(a.$broadcast("refresh-all"),o.closeThisDialog())},o.resetSettings=function(){function e(e){var t=e.userSettings;if(t){var o=JSON.parse(t);delete o[r],e.userSettings=JSON.stringify(o)}}var r=n.getNamespace().toLowerCase();e(sessionStorage);try{e(localStorage)}catch(e){}g()},o.exportSettings=function(){var e=n.getNamespace()+"."+(new Date).toLocaleDateString()+".json",t=(n.getNamespace(),JSON.stringify(r.settings));!function(e,t){var o=document.createElement("a");o.style="display: none";var r=new Blob([t],{type:"application/octet-stream"}),i=window.URL.createObjectURL(r);o.href=i,o.download=e,document.body.appendChild(o),o.click(),setTimeout(function(e){document.body.removeChild(o),window.URL.revokeObjectURL(i)},100)}(e,t)},o.readSettings=p,o.showLog=function(){var e="";dsw.errors&&(e+=dsw.errors.join("<br/>"));l.open({template:"src/views/log.html",data:{html:e},controller:"share",className:"ngdialog-theme-default wnd-error-log"})},o.resetColors=function(){if(h)return delete o.ngDialogData.widgetSettings.themeColors,o.ngDialogData.saveWidgetSettings(),void o.closeThisDialog();var e=r.getAppSettings();e.themeColors||(e.themeColors={});e.themeColors[e.theme]={},r.setAppSettings(e),g()},o.onInit=function(){setTimeout(function(e){return document.getElementById("uploader").addEventListener("change",p,!1)},0)}}]),angular.module("app").controller("serverList",["$scope","$window","Storage","Utils","Error","Lang","$rootScope","Connector","ngDialog","CONST",function(r,e,t,o,i,s,a,n,l,c){r.model={isDeleteMode:!1,servers:[]};try{r.model.servers=JSON.parse(localStorage.serverList||"[]")}catch(e){r.model.servers=[],console.error(e)}function d(){r.model.servers.forEach(function(e){return e.doDelete=!1}),r.model.isDeleteMode=!1}r.toggleDeleteMode=function(){r.model.isDeleteMode=!r.model.isDeleteMode},r.cancelDeleteMode=d,r.deleteServers=function(){r.model.servers=r.model.servers.filter(function(e){return!e.doDelete}),localStorage.serverList=JSON.stringify(r.model.servers),d()},r.selectServer=function(e,t){if("INPUT"===t.target.tagName.toUpperCase())return;var o=r.model.servers.indexOf(e);if(-1===o)return;localStorage.selectedServer=o,r.ngDialogData.callback(),r.closeThisDialog()},d()}]),angular.module("app").controller("share",["$scope","$window","Storage","Utils","Error","Lang","$rootScope","Connector",function(e,t,o,r,i,s,a,n){e.model={}}]),angular.module("widgets").controller("filter",["$scope","Filters","Connector","Error","Storage","Variables",function(i,o,r,s,e,t){var a=this,n=e.getAppSettings();function l(){var t="";try{t=i.ngDialogData.widget.desc.dataSource}catch(e){t=""}return t}function c(){o.filtersChanged=!1,i.model.values=[];for(var e=0;e<a.source.values.length;e++)i.model.values.push(a.source.values[e]);0!==i.model.values.length&&(i.model.values[a.source.fromIdx]?i.model.from=i.model.values[a.source.fromIdx]:i.model.from=i.model.values[0],i.model.values[a.source.toIdx]?i.model.to=i.model.values[a.source.toIdx]:i.model.to=i.model.values[0])}function d(){for(var e=0;e<a.source.values.length;e++)if(a.source.values[e].checked)return!0;return!1}function u(e){if(i.model.isLoading=!1,e){var t=e.children.filter(function(e){return e.path===a.source.targetProperty});if(0!==t.length){var o=t[0];if(o.children&&0!==o.children.length){var r=a.source.values.slice();o.children.forEach(function(t){var e=r.find(function(e){return e.path===t.path});e&&Object.assign(t,e)}),a.source.values=o.children,c()}}}}function h(e,t){i.model.isLoading=!1,s.show("Error "+t.toString())}this.isRelatedFilters=void 0===n.isRelatedFilters||n.isRelatedFilters,this.widget=i.ngDialogData.widget,this.source=i.ngDialogData.filter,this.dataSource=i.ngDialogData.dataSource,i.model={search:"",isLoading:!1,filter:this.source,values:[],isAll:!1,isExclude:!0===a.source.isExclude,isInterval:!0===a.source.isInterval},this.isRelatedFilters?function(){var e=l();if(!e)return c();var t=o.items.filter(function(e){return e.targetProperty!==a.source.targetProperty&&""!==e.value||e.isInterval});t.forEach(function(e){e.Value=e.value,e.isExclude&&(e.Value=e.Value.split("|").map(function(e){return e+".%NOT"}).join("|")),e.isInterval&&(e.Value=e.Value.replace("|",":")),-1!==e.value.indexOf("|")&&(e.Value="{"+e.Value.replace(/\|/g,",")+"}")}),t=t.map(function(e){return{Filter:e.targetProperty,Value:e.Value}}),i.model.isLoading=!0,r.searchFilters("",e,t,[a.source.targetProperty]).catch(h).then(u)}():c(),i.acceptFilter=function(){a.source.isExclude=i.model.isExclude,a.source.isInterval=i.model.isInterval,a.source.isInterval?(a.source.fromIdx=i.model.values.indexOf(i.model.from),a.source.toIdx=i.model.values.indexOf(i.model.to)):(delete a.source.from,delete a.source.to);o.applyFilter(a.source),o.filtersChanged=!0,i.closeThisDialog()},i.removeFilter=function(){for(var e=0;e<a.source.values.length;e++)a.source.values[e].checked=!1;o.applyFilter(a.source),a.widget.updateFiltersText(),i.closeThisDialog()},i.setAll=function(){i.model.isAll=!0,i.model.isExclude=!1,i.model.isInterval=!1;for(var e=0;e<a.source.values.length;e++)a.source.values[e].checked=!1},i.onItemSelect=function(){i.model.isAll=!d()},i.searchFilters=function(){var e=l();if(!e)return;var t=i.model.search;if(!t)return;i.model.isLoading=!0,r.searchFilters(t,e).catch(h).then(u)},i.onSearch=function(){if(""===i.model.search)i.model.values=a.source.values;else{i.model.values=[];for(var e=0;e<a.source.values.length;e++)-1!=a.source.values[e].name.toString().toLowerCase().indexOf(i.model.search.toLowerCase())&&i.model.values.push(a.source.values[e])}},i.toggleRow=function(e){for(var t=0;t<a.source.values.length;t++)a.source.values[t].checked=!1;e.checked=!0,i.model.isAll=!e.checked},i.isIntervalControlsVisible=function(){return!0===i.model.isInterval},i.model.isAll=!d()}]),angular.module("app").controller("shareDashboard",["$scope","$window","Storage","Utils","Error","Lang","$rootScope","Connector","ngDialog","CONST",function(e,t,o,r,i,s,a,n,l,c){e.copyUrl=function(){$("#shareText").get(0).select();try{var e=document.execCommand("copy")?"successful":"unsuccessful";console.log("Copying text command was "+e)}catch(e){alert("You browser doesn't support clipboard operations. Use Ctrl + C")}},e.onInit=function(){setTimeout(function(e){var t=$("#shareText").get(0);t.focus(),t.select()},0)}}]),angular.module("app").directive("autoFocus",["$timeout",function(o){return{restrict:"AC",link:function(e,t){dsw.mobile||o(function(){t[0].focus()},0)}}}]).directive("focusNext",function(){return{restrict:"A",link:function(e,t,o){t.bind("keydown",function(e){13===(e.keyCode||e.which)&&(e.preventDefault(),$("#"+o.focusNext).focus())})}}}).directive("blurOnEnter",function(){return{restrict:"A",link:function(e,t,o){t.bind("keydown",function(e){13===(e.keyCode||e.which)&&(e.preventDefault(),e.currentTarget.blur())})}}}).directive("ngEnter",function(){return function(t,e,o){e.bind("keydown keypress",function(e){13===e.which&&(t.$apply(function(){t.$eval(o.ngEnter)}),e.preventDefault())})}}).directive("focusFunc",["$timeout",function(r){return{restrict:"A",link:function(e,t,o){e[o.focusFunc]=function(){r(function(){t[0].focus()},0)}}}}]),angular.module("app").directive("pivot",["$parse","$compile","Lang","Connector",function(e,t,a,n){return{link:function(e,t,o){var r=e.getDesc(e.item.idx),i={initialData:e.item.pivotData,container:t[0],pivotProperties:{},dataSource:{pivot:r.dataSource,MDX2JSONSource:n.url.substring(0,n.url.length-1),basicMDX:e.item.pivotMdx,namespace:n.getNamespace(),sendCookies:!0},triggers:{drillDown:e.item.onDrillDown,back:e.item.onDrillDown,cellDrillThrough:e.item.onDrillThrough},columnResizeAnimation:!0,locale:a.current,hideButtons:!0,formatNumbers:"#,###.##"};delete e.model.pivotMdx;var s=new LightPivotTable(i);e.onInit&&e.onInit(s)}}}]),angular.module("app").controller("login",["Connector","Lang","$scope","$location","$rootScope","CONST","Storage","ngDialog",function(o,a,r,i,s,e,n,t){var l=(new Date).getTime();delete sessionStorage.dashboarList,window.dsw.desktop&&delete localStorage.DSWMobileServer,r.model={isDesktop:dsw.desktop,ver:e.ver,server:localStorage.DSWMobileServer||location.hostname,login:"",password:"",namespace:localStorage.namespace||"Samples",error:"",oAuthUrl:""},dsw.mobile&&u();var c,d=i.search().from;function u(){var e=localStorage.selectedServer;if(e&&(e=parseInt(e),!isNaN(e))){var t=[];try{t=JSON.parse(localStorage.serverList||"[]")}catch(e){console.error(e)}var o=t[e];o&&(r.model.server=o.server||"",r.model.login=o.login||"",r.model.password=o.password||"",r.model.namespace=o.namespace||"",r.$$phase||r.$apply())}}function h(){r.model.error="";var e=p();l=(new Date).getTime(),o.signIn(r.model.login,r.model.password,r.model.namespace,dsw.mobile&&!dsw.desktop?e:void 0).catch(f).then(g)}function p(){var e=r.model.server,t=-1!==e.replace("://","").indexOf("/");return-1==e.toLowerCase().indexOf("http")&&(e="http://"+e),t||(e+="/MDX2JSON/"),"/"!==e.charAt(e.length-1)&&(e+="/"),e}function g(e){if(e){dsw.mobile&&!dsw.desktop&&(o.url=p(),localStorage.connectorRedirect=o.url),localStorage.DSWMobileServer=r.model.server,n.loadServerSettings(e),localStorage.namespace=r.model.namespace,localStorage.userName=o.username;var t=i.search().from;t?i.url(t):i.path("/").search({ns:r.model.namespace}),s.$broadcast("toggleMenu",!0)}}function f(e,t,o,r){var i=(new Date).getTime()-l;if(r&&i>=r.timeout)m(a.get("errTimeout"));else{if(e){var s=null;if("object"==typeof e)s=e;else try{s=JSON.parse(e)}catch(e){}if(s&&s.Error)return void m(s.Error)}switch(t||e.status){case 0:m(a.get("errNotFound"));break;case 401:m(a.get("errUnauth"))}}}function m(e){r.model.error=e}d?(c=function(e,t){e=e.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}("ns",decodeURIComponent(d)))&&(r.model.namespace=c):(c=i.search().ns)&&(r.model.namespace=c),r.onLoginClick=h,r.onLoginOAuthClick=function(){window.location.href=r.model.oAuthUrl},r.showServers=function(){t.open({template:"src/views/serverList.html",data:{callback:u},controller:"serverList",disableAnimation:dsw.mobile,showClose:!0,className:"ngdialog-theme-default wnd-mobile wnd-servers"})},r.scanSettings=function(){cordova.plugins.barcodeScanner.scan(function(e){console.error(JSON.stringify(e));var t=e.text.split("|");"dsw"===t[0].toLowerCase()?(r.model.server=t[1],r.model.login=t[2],r.model.password=t[3],r.model.namespace=t[4],h()):alert("Incorrect QR code")},function(e){alert("Scanning failed: "+e)})},r.saveServer=function(){var e=prompt("Please enter server name",r.model.server),t=[];try{t=JSON.parse(localStorage.serverList||"[]")}catch(e){console.error(e)}t.push({name:e,server:r.model.server,login:r.model.login,password:r.model.password,namespace:r.model.namespace}),localStorage.serverList=JSON.stringify(t),localStorage.selectedServer=t.length-1},r.$on("signinerror",f),s.$broadcast("toggleMenu",!1),o.loadOAuthConfig().then(function(e){try{if("string"==typeof e){var t=JSON.parse(e);r.model.oAuthUrl=t.url||""}else r.model.oAuthUrl=e.url||""}catch(e){}}).catch(function(){})}]),angular.module("app").service("HttpInterceptor",["$q","$location","$routeParams","Lang",function(o,r,e,i){return{request:function(e){e.headers?e.headers["Accept-Language"]=i.current:e.headers={"Accept-Language":i.current};return e},responseError:function(e){null===e.data&&0===e.status&&(e.data={Error:i.get("errTimeout")});if(401===e.status){var t=r.$$url;"/login"!==r.$$path&&r.path("/login").search({from:t})}return o.reject(e)}}}]).config(["$httpProvider",function(e){e.interceptors.push("HttpInterceptor")}]),function(){var d="MDX2JSON",u="MDX2JSON";angular.module("app").service("Connector",["$http","CONST","$cookieStore","$location","$routeParams","$route",function(s,i,e,t,o,r){var a=this;function n(){localStorage.connectorRedirect&&(dsw.mobile||"localhost"===location.host.split(":")[0].toLowerCase())?(a.url=localStorage.connectorRedirect,a.newAPI=localStorage.connectorRedirect.replace("/"+d,"")+"api/deepsee/Data/MDXExecute"):(a.url=t.$$protocol+"://"+t.$$host,t.$$port&&(a.url+=":"+t.$$port),a.url+="/"+d+"/",a.newAPI=t.$$protocol+"://"+t.$$host,t.$$port&&(a.newAPI+=":"+t.$$port),a.newAPI+="/api/deepsee/Data//MDXExecute")}function l(){var e=localStorage.namespace||"samples";return(r.current.params.ns||e).toUpperCase()}function c(e){return e?e.data:void 0}this.firstRun=!0,this.username=localStorage.userName||"",this.url="",this.newAPI="",this.getDashboards=function(){return a.firstRun=!1,s({method:"POST",data:{Folder:""},url:a.url+"Dashboards?Namespace="+l(),withCredentials:!0})},this.getPivotData=function(e){return s({method:"POST",url:a.url+"DataSource?Namespace="+l(),data:{DataSource:e},timeout:i.timeout,withCredentials:!0}).then(c)},this.getKPIData=function(e){return s({method:"POST",url:a.url+"KPI?Namespace="+l(),data:{KPI:e},timeout:i.timeout,withCredentials:!0}).then(c)},this.execMDX=function(e){var t=e.split(" ");if(t&&0!==t.length&&"DRILLTHROUGH"===t[0].toUpperCase())return function(e){return s({method:"POST",url:a.url+"MDXDrillthrough?Namespace="+l(),data:{MDX:e},timeout:i.timeout,withCredentials:!0}).then(c)}(e);return s({method:"POST",url:a.url+"MDX?Namespace="+l(),data:{MDX:e},timeout:i.timeout,withCredentials:!0}).then(c)},this.getWidgets=function(e){return s({method:"POST",url:a.url+"Dashboard?Namespace="+l(),data:JSON.stringify({Dashboard:e}),timeout:i.timeout,withCredentials:!0,headers:{"Content-Type":"application/json"}}).then(c)},this.signIn=function(e,t,o,r){return a.username=e,s({method:"GET",url:r?r+"Test?Namespace="+o:a.url+"Test?Namespace="+o,timeout:i.timeout,headers:{Authorization:"Basic "+btoa(e+":"+t)}}).then(c)},this.signOut=function(){return a.firstRun=!0,e.remove("CSPWSERVERID"),e.remove("CacheLoginToken"),e.remove("CSPSESSIONID-SP-80-UP-"),e.remove("CSPSESSIONID-SP-80-UP-MDX2JSON-"),a.username="",localStorage.userName="",s({method:"Get",data:{},url:a.url+"Logout?Namespace="+l(),withCredentials:!0}).then(function(){t.path("/login").search({})}).then(c)},this.getFile=function(e){return s({method:"GET",data:{},url:e,withCredentials:!0}).then(c)},this.getTermList=function(e){return s({method:"POST",url:a.url+"TermList?Namespace="+l(),data:{TermList:e},timeout:i.timeout,withCredentials:!0})},this.getNamespace=l,this.getFavorites=function(){return s({method:"GET",data:{},url:a.url+"Favorites?Namespace="+l(),withCredentials:!0}).then(c)},this.addFavorite=function(e){return s({method:"POST",data:{},url:a.url+"Favorites/"+encodeURIComponent(e)+"?Namespace="+l(),withCredentials:!0}).then(c)},this.deleteFavorite=function(e){return s({method:"DELETE",data:{},url:a.url+"Favorites/"+encodeURIComponent(e)+"?Namespace="+l(),withCredentials:!0}).then(c)},this.searchFilters=function(e,t,o,r){var i={DataSource:t,Values:1,Search:e};o&&o.length&&(i.RelatedFilters=o);r&&r.length&&(i.RequestedFilters=r);return s({method:"POST",data:i,url:a.url+"Filters?Namespace="+l(),withCredentials:!0}).then(c)},this.loadConfig=function(e){return s({method:"Get",data:{},url:"configs/"+(e||this.getNamespace()).toLowerCase()+".json",withCredentials:!1}).then(c)},this.loadMainConfig=function(){return s({method:"Get",data:{},url:"config.json",withCredentials:!1}).then(c).then(function(e){try{e&&e.endpoints&&e.endpoints.mdx2json&&(d=e.endpoints.mdx2json.replace(/\//gi,"").replace(/ /g,""),u=e.namespace.replace(/\//gi,"").replace(/ /g,""))}catch(e){console.error('Incorrect config in file "config.json"')}n()})},this.execAction=function(e,t){return s({method:"POST",data:{},url:a.url+"Action/"+t+"/"+e+"?Namespace="+l(),withCredentials:!0}).then(c)},this.getSettings=function(){return s({method:"GET",url:a.url+"Test?Namespace="+l(),timeout:i.timeout,withCredentials:!0}).then(c)},this.getPivotVariables=function(e){return s({method:"GET",url:a.url+"PivotVariables/"+e+"?Namespace="+l(),withCredentials:!0}).then(c)},this.loadNamespaceConfig=function(e){return s({method:"Get",data:{},url:a.url+"Config/"+e+"?Namespace="+u,withCredentials:!0}).then(c)},this.saveNamespaceConfig=function(e,t){return s({method:"POST",data:{Application:t,Config:JSON.stringify(e)},url:a.url+"Config?Namespace="+u,withCredentials:!0}).then(c)},this.loadAddons=function(e){return s({method:"Get",data:{},url:a.url+"Addons",withCredentials:!0}).then(c)},this.gotoLoginPage=function(){var e=t.$$url;"/login"!==t.$$path&&t.path("/login").search({from:e})},this.loadOAuthConfig=function(){return s({method:"Get",data:{},url:"dswoauth/check",withCredentials:!1}).then(c)},n()}])}(),angular.module("app").controller("menu",["$scope","$routeParams","Connector","Storage","$rootScope","$location","CONST","ngDialog","Lang","Utils","Filters",function(o,r,i,s,t,a,e,n,l,c,d){var u=this;function h(){0===u.favs.length&&delete localStorage.favs,localStorage.favs=JSON.stringify(u.favs)}function p(){for(var e=[],t=0;t<u.favs.length;t++){var o=u.favs[t].split("/"),r=o[o.length-1].replace(".dashboard","");e.push({idx:t,label:r})}return e}function g(e){for(var t=0;t<u.favs.length;t++)if(u.favs[t]===e)return!0;return!1}function f(){return!!r.path&&-1!==r.path.indexOf(".dashboard")}this.favs=[],function(){if(!localStorage.favs)return;u.favs=JSON.parse(localStorage.favs)}(),o.model={ver:e.ver,searchText:"",canAdd:!g(r.path),username:localStorage.userName||"",visible:s.configLoaded||!1,favs:p(),onDashboard:f(),namespace:r.ns||"Samples",title:r.folder,devMode:localStorage.connectorRedirect,lblHome:l.get("home"),lblFav:l.get("fav"),lblSearch:l.get("search"),lblSettings:l.get("options"),lblAbout:l.get("about"),lblLang:l.get("language"),lblLogout:l.get("signout"),lblFilter:l.get("filters"),showLabels:!0,lang:l.current,langs:l.getLanguages(),filterButton:!1,filtersVisible:!1,namespaces:[]},o.search=function(e){t.$broadcast("search:dashboard",e)},o.gotoDeepSee=function(){if(!f())return;var e=(s.serverSettings.DefaultApp||"/csp/"+i.getNamespace())+"/_DeepSee.UserPortal.DashboardViewer.zen?DASHBOARD="+r.path;window.open(e)},o.onHomeClick=function(){a.path("/"),a.search("SETTINGS",null)},o.onSingoutClick=function(){i.signOut()},o.addToFavorites=function(){var e=r.path;if(g(e))return;i.addFavorite(e),u.favs.push(e),o.model.favs=p(),o.model.canAdd=!g(r.path),h()},o.removeFromFav=function(){var e=r.path;if(!g(e))return;var t=u.favs.indexOf(e);if(-1==t)return;i.deleteFavorite(e),u.favs.splice(t,1),o.model.favs=p(),o.model.canAdd=!g(r.path),h()},o.navigateFav=function(e){if(!u.favs[e.idx])return;a.path("/d/"+u.favs[e.idx])},o.showSettings=function(){n.open({template:"src/views/settings.html",data:{},controller:"settings",disableAnimation:dsw.mobile,showClose:!0,className:"ngdialog-theme-default wnd-settings"})},o.changeNamespace=function(e){r.ns=e,a.path("/").search({ns:e})},o.setLang=function(e){var t=s.getAppSettings(),o=c.merge({},t);t.language=e||"en",o.language!==t.language&&(s.setAppSettings(t),i.saveConfig(s.settings).then(function(){window.location.reload()}))},o.about=function(){n.open({template:"src/views/about.html",controller:"about",data:{},showClose:!0,className:"ngdialog-theme-default wnd-about"})},o.showGlobalFilter=function(){o.model.filtersVisible=!o.model.filtersVisible,t.$broadcast("globalShowFilters",o.model.filtersVisible)},o.shareDashboard=function(){var e=d.getFiltersShareUrl();n.open({template:"src/views/shareDashboard.html",controller:"shareDashboard",data:{url:e},showClose:!0,className:"ngdialog-theme-default wnd-about"})},t.$on("toggleMenu",function(e,t){t&&(o.model.username=localStorage.userName||"");o.model.visible=t&&!c.isEmbedded()}),t.$on("menu:changeTitle",function(e,t){t&&(o.model.title=t.replace(".dashboard",""))}),t.$on("menu:showFilterButton",function(e,t){o.model.filterButton=t,o.model.filtersVisible=!1}),o.$on("$routeChangeSuccess",function(){var e="InterSystems DeepSee™";dsw.mobile&&(e="DeepSight");o.model.onDashboard=f(),o.model.searchText="",o.model.canAdd=!g(r.path),o.model.title=r.path||e,o.model.title=o.model.title.replace(".dashboard",""),o.model.namespace=r.ns||localStorage.namespace||"Samples";var t=localStorage.namespace;t=t&&t.toLowerCase();t!==o.model.namespace.toLowerCase()&&(delete sessionStorage.dashboarList,localStorage.namespace=o.model.namespace,i.firstRun=!0)}),o.$on("servSettings:loaded",function(){s.serverSettings.Mappings&&s.serverSettings.Mappings.Mapped&&(o.model.namespaces=s.serverSettings.Mappings.Mapped.filter(function(e){return"%"!==e.charAt(0)}))}),t.$on("lang:changed",function(){o.model.lang=l.current,o.model.lblHome=l.get("home"),o.model.lblSearch=l.get("search"),o.model.lblFav=l.get("fav"),o.model.lblSettings=l.get("options"),o.model.lblAbout=l.get("about"),o.model.lblLang=l.get("language"),o.model.lblLogout=l.get("signout"),o.model.lblFilter=l.get("filters")}),c.isEmbedded()&&$("body").css("margin-top","-50px")}]),angular.module("dashboard").controller("dashboard",["$scope","$rootScope","$routeParams","Connector","Error","Filters","Lang","Utils","CONST","Storage","Variables",function(a,n,l,r,c,d,u,h,p,i,g){var f=this;this.desc=[],this.ctxItem=void 0,this.sharedWidget=l.widget,a.model={items:[]};var m=i.getAppSettings();function v(){for(var e=[],t=0;t<f.desc.length;t++)if(0!==f.desc[t].dependents.length){var o=f.desc[t];if(-1!=e.indexOf(o.key))continue;e.push(o.key),n.$broadcast("widget:"+o.key+":refreshDependents")}}function C(e,t){e.dependents=[];for(var o=0;o<t.length;o++)if(t[o]!=e){if(!t[o].Link)continue;t[o].Link==e.name&&e.dependents.push(t[o].key)}}function b(e,t){var o=i.getWidgetsSettings(l.path,r.getNamespace())[t];o&&(void 0!==o.sizeX&&(e.sizeX=o.sizeX),void 0!==o.sizeY&&(e.sizeY=o.sizeY),void 0!==o.col&&(e.col=o.col),void 0!==o.row&&(e.row=o.row))}a.gridsterOpts={columns:parseInt(m.colCount)||12,rowHeight:parseInt(m.widgetHeight)||Math.floor((parseInt($(window).height())-78)/10)},this.sharedWidget&&(a.gridsterOpts.columns=1,l.height?a.gridsterOpts.rowHeight=parseInt(l.height):a.gridsterOpts.rowHeight="match",a.gridsterOpts.draggable={enabled:!1,handle:""},a.gridsterOpts.resizable={enabled:!1,handles:[]}),a.isMobile=dsw.mobile,a.getDesc=function(e){return f.desc[e]?f.desc[e]:void 0},a.onCtxMenuShow=function(e){f.ctxItem=e.$$hashKey,a.ctxItem=e},a.refreshItem=function(){if(!f.ctxItem)return;a.$broadcast("refresh:"+f.ctxItem),f.ctxItem=void 0},a.printItem=function(){if(!f.ctxItem)return;a.$broadcast("print:"+f.ctxItem),f.ctxItem=void 0},a.shareItem=function(){if(!f.ctxItem)return;a.$broadcast("share:"+f.ctxItem)},a.setType=function(e){if(!f.ctxItem)return;a.$broadcast("setType:"+f.ctxItem,e)},a.copyMDX=function(){if(!f.ctxItem)return;a.$broadcast("copyMDX:"+f.ctxItem)},a.$on("resetWidgets",function(){window.location.reload()}),r.getWidgets(l.path).then(function(e){var t;if(e)if(e.Error)c.show(e.Error);else if(e.widgets){e.displayInfo&&e.displayInfo.gridRows&&!m.widgetHeight&&!f.sharedWidget&&(a.gridsterOpts.rowHeight=Math.floor((window.innerHeight-60)/e.displayInfo.gridRows)),g.init(e),e.filters&&d.init(e.filters,l.path);var o=!1;if((d.isFiltersOnToolbarExists||g.isExists())&&!f.sharedWidget){for(t=0;t<e.widgets.length;t++)e.widgets[t].type.toLowerCase()===p.emptyWidgetClass&&(o=!0);o||(e.widgets.push({dashboard:l.path,autocreated:!0,name:"emptyWidget",type:p.emptyWidgetClass,key:"emptyWidgetFor"+l.path}),o=!0)}for(dsw.mobile&&n.$broadcast("menu:showFilterButton",o),e.info&&n.$broadcast("menu:changeTitle",e.info.title),a.model.items=[],f.desc=[],t=0;t<e.widgets.length;t++)if(e.widgets[t].dashboard=l.path,!f.sharedWidget||t==f.sharedWidget){var r={idx:t,sizeX:2,sizeY:2,row:2*parseInt(t/6),col:2*t%12,title:e.widgets[t].title,toolbar:!0,backButton:!1,menuDisabled:!1};if(e.widgets[t].displayInfo){var i=1,s=1;e.displayInfo&&((i=Math.floor(12/e.displayInfo.gridCols))<1&&(i=1),s<1&&(s=1)),r.col=e.widgets[t].displayInfo.topCol*i,r.row=e.widgets[t].displayInfo.leftRow*s,r.sizeX=(e.widgets[t].displayInfo.colWidth||1)*i,r.sizeY=e.widgets[t].displayInfo.rowHeight||2}e.widgets[t].autocreated&&(delete r.row,delete r.col),e.widgets[t].name&&b(r,e.widgets[t].name.toString()),f.sharedWidget&&(r.col=0,r.row=0,r.idx=0,r.sizeX=1,r.sizeY=1,r.menuDisabled=!0),a.model.items.push(r),r={},h.merge(r,e.widgets[t]),f.sharedWidget||C(r,e.widgets),f.desc.push(r)}f.sharedWidget||setTimeout(v,0)}else c.show(u.get("errNoWidgets"))})}]),angular.module("dashboard").controller("home",["$scope","$location","$routeParams","Connector","Error","CONST","Lang","Filters","Storage","$q",function(i,o,e,s,t,r,a,n,u,l){var h=this,p=u.getAppSettings(),g=r.icons;this.search="";var c=[];function d(e){e&&(i.model.widgetList=e.widgets.map(function(e,t){return{idx:t,name:e.title||e.name}}))}function f(){!sessionStorage.dashboarList||s.firstRun?s.getDashboards().then(h.retrieveData):i.dashboards=h.getFolderItems(JSON.parse(sessionStorage.dashboarList),h.curFolder)}function m(e){for(var t=0;t<e.length;t++)p.showImages||(e[t].Cover=""),e[t].Cover&&(localStorage.connectorRedirect&&(e[t].Cover=localStorage.connectorRedirect.toLowerCase().replace("/mdx2json","")+e[t].Cover),e[t].icon=0),null!==e[t].widget&&(e[t].Cover="",e[t].icon=0,e[t].requestedWidget=e[t].widget,s.getWidgets(e[t].path).then(v(e[t])))}function v(t){return function(e){!function(e,t){if(!e.widgets[t.widget])return console.warn("Can't find widget with index "+t.widget);e.widgets[t.widget].inline=!0,e.widgets[t.widget].tile=t,c.push(e.widgets[t.widget]),t.idx=c.length-1,t.template="src/views/tile.html"}(e,t)}}n.clear(),this.getFolderItems=function(e,t){var o,r,i,s,a,n=[],l=u.getTilesSettings(),c=p.hideFolders?"/":h.curFolder;""!==c||l[c]||(c="/");if(l=l[c]||{},p.hideFolders||h.search){for(o=0;o<e.children.length;o++)-1!==(r=e.children[o]).path.toLocaleLowerCase().indexOf(h.search.toLocaleLowerCase())&&(i=r.path).substr(0,t.length).toLowerCase()==t.toLowerCase()&&(i=i.substr(t.length,i.length),0!==(a=i.split("/")).length&&(r.title=a[a.length-1],r.title=r.title.replace(".dashboard",""),n.push(r)));for(o=0;o<n.length;o++)void 0!==(s=l[n[o].title]||{}).hideTitle&&(n[o].hideTitle=s.hideTitle),void 0!==s.row?n[o].row=s.row:n[o].row=parseInt(o/12),void 0!==s.col?n[o].col=s.col:n[o].col=o%12,n[o].widget=null,n[o].requestedWidget=null,void 0!==s.widget&&(n[o].widget=parseInt(s.widget)),n[o].template="",n[o].sizeX=s.sizeX||1,n[o].sizeY=s.sizeY||1,void 0!==s.icon?n[o].icon=s.icon:n[o].icon=""===n[o].title?g.length-1:n[o].isFolder?2:1,n[o].color=s.color||(""===n[o].title?2:n[o].isFolder?3:1),n[o].fontColor=s.fontColor||0,n[o].customTitle=s.title||n[o].title;return m(n),n}function d(e){return e.title==a[0]}for(o=0;o<e.children.length;o++)r=e.children[o],(i=r.path).substr(0,t.length).toLowerCase()==t.toLowerCase()&&(i=i.substr(t.length,i.length),0!==(a=i.split("/")).length&&(1===a.length?(""===r.title&&(r.title=a[0],r.title=r.title.replace(".dashboard","")),n.push(r)):0===n.filter(d).length&&""!==a[0]&&n.push({title:a[0],path:"",isFolder:!0,Cover:""})));""!==h.curFolder&&n.splice(0,0,{title:"",path:"",isFolder:!0,isBack:!0,Cover:""});for(n=n.sort(function(e,t){return e.isFolder&&!t.isFolder?-1:t.isFolder&&!e.isFolder?1:e.title>t.title?1:-1}),o=0;o<n.length;o++)void 0!==(s=l[n[o].title]||{}).hideTitle&&(n[o].hideTitle=s.hideTitle),void 0!==s.row?n[o].row=s.row:n[o].row=parseInt(o/12),void 0!==s.col?n[o].col=s.col:n[o].col=o%12,n[o].widget=null,n[o].requestedWidget=null,void 0!==s.widget&&(n[o].widget=parseInt(s.widget)),n[o].template="",n[o].sizeX=s.sizeX||1,n[o].sizeY=s.sizeY||1,void 0!==s.icon?n[o].icon=s.icon:n[o].icon=""===n[o].title?g.length-1:n[o].isFolder?2:1,n[o].color=s.color||(""===n[o].title?2:n[o].isFolder?3:1),n[o].fontColor=s.fontColor||0,n[o].customTitle=s.title||n[o].title;return m(n),n},this.setCurrentFolder=function(){h.curFolder="",e.folder&&(h.curFolder=e.folder);""!==h.curFolder&&"/"!=h.curFolder[h.curFolder.length-1]&&(h.curFolder+="/")},this.retrieveData=function(e){if(e.data&&e.data.Error)return void t.show(e.data.Error);if(e.data){0===e.data.children.length&&t.show(a.get("errNoDashboards"));try{sessionStorage.dashboarList=JSON.stringify(e.data)}catch(e){console.error(e)}i.dashboards=h.getFolderItems(e.data,h.curFolder)}},this.requestData=f,i.model={widgetList:[],editing:!1,colors:r.bgColorClasses,fontColors:r.fontColors,icons:g,edItem:null,optW:0,optH:0,opt:!1},i.tilesOpt={minRows:4,margins:[10,10],draggable:{handle:".metro-tile-icon",enabled:!1},resizable:{enabled:!1}},i.enableEditing=function(){i.model.editing=!i.model.editing,i.tilesOpt.draggable.enabled=i.model.editing,i.tilesOpt.resizable.enabled=i.model.editing,i.model.editing||(i.model.edItem=null,function(){var e=u.getTilesSettings(),t="";p.hideFolders||(t=h.curFolder);for(var o=0;o<i.dashboards.length;o++){var r=i.dashboards[o];e[t]||(e[t]={}),e[t][r.title]||(e[t][r.title]={}),e[t][r.title].row=r.row,e[t][r.title].col=r.col,e[t][r.title].sizeX=r.sizeX,e[t][r.title].sizeY=r.sizeY,e[t][r.title].color=r.color,e[t][r.title].fontColor=r.fontColor,e[t][r.title].icon=r.icon,e[t][r.title].hideTitle=r.hideTitle,null!==r.widget&&""!==r.widget?e[t][r.title].widget=parseInt(r.widget):delete e[t][r.title].widget,void 0!==r.customTitle&&(e[t][r.title].title=r.customTitle)}for(u.setTilesSettings(e,s.getNamespace()),o=0;o<i.dashboards.length;o++)if(i.dashboards[o].widget!==i.dashboards[o].requestedWidget)return h.requestData()}())},i.onItemClick=function(e){if(i.model.editing)return i.model.edItem=e,i.model.widgetList=[],void(e.isFolder||s.getWidgets(e.path).then(d));if(e.isFolder)if(""===e.title){var t=h.curFolder.split("/");t.splice(t.length-2,2),0===t.length?o.path("/"):o.path("/f/"+t.join("/"))}else h.curFolder+=e.title,o.path("/f/"+h.curFolder);else o.path("/d/"+e.path);o.search("SETTINGS",null)},i.setTileColor=function(e){if(!i.model.edItem)return;i.model.edItem.color=e},i.setFontColor=function(e){if(!i.model.edItem)return;i.model.edItem.fontColor=e},i.setIcon=function(e){if(!i.model.edItem)return;i.model.edItem.icon=e},i.getDesc=function(e){return c[e]},i.$on("refresh",function(){h.requestData()}),i.$on("search:dashboard",function(e,t){if(h.search=t,!sessionStorage.dashboarList)return;i.dashboards=h.getFolderItems(JSON.parse(sessionStorage.dashboarList),h.curFolder)}),this.setCurrentFolder(),o.search("FILTERS",null),f()}]),angular.module("widgets").factory("BaseWidget",["$rootScope","Lang","Connector","Filters","Utils","$q","Storage","$routeParams","Variables","$location",function(A,$,k,P,E,M,_,R,W,z){return function(d){var m=this;if(this.drills=[],d.item&&d.item.drills&&(this.drills=d.item.drills),d.item&&void 0===d.item.baseTitle&&(d.item.baseTitle=d.item?d.item.title:d.$parent.title),this.drillFilter="",this.drillFilterDrills=[],this.pivotVariables=null,this.showLoading=function(){d.item.isLoading=!0},this.hideLoading=function(){d.item.isLoading=!1},this.restoreWidgetType=v,this.changeWidgetType=function(e){m.desc.oldType=m.desc.type,m.desc.type=e,d.item.drills=m.drills,d.$broadcast("typeChanged")},this.drillFilterWidgets=null,this._currentData=null,this._kpiData=null,d.tile&&(d.item={},E.merge(d.item,d.tile)),d.item&&(this.desc=d.getDesc(d.item.idx)),this.supported=!0,d.item.acItems=[],d.item.pvItems=[],d.item.dsItems=[],d.item.dsLabel="",d.item.dsSelected="",m.desc&&m.desc.dataSource&&(d.item.dsSelected=E.removeExt(m.desc.dataSource.split("/").pop())),d.onDataSourceChange=function(e){var t,o,r;(t=e.dsSelected)&&-1!==(r=e.labels.indexOf(t))&&(o=e.values[r]);switch(e.action){case"chooseDataSource":S(o,e);break;case"chooseRowSpec":!function(e){console.log(e),m.customRowSpec=e||"";m.requestData()}(o);break;case"chooseColumnSpec":!function(e,t){var o="";e&&(o=e.replace(/\\/g,""));var r=t.control.target;A.$broadcast("setColSpec:"+r,o)}(o,e)}},d.emitVarChange=function(e){var t=e.target;A.$broadcast("updatePivotVar:"+t)},d.item.drillUp=C,d.item.resetClickFilter=function(){if(d.item.clickFilterActive=!1,!m.drillFilterWidgets||!m.drillFilterWidgets.length)return;for(var e=0;e<m.drillFilterWidgets.length;e++)A.$broadcast("drillFilter:"+m.drillFilterWidgets[e],"",[])},d.performAction=function(e){var t=e.action.toLowerCase();"navigate"===t?g(e):"newwindow"===t?g(e,!0):"setColumnSpec"===t?(m.customColSpec=e.targetProperty,m.requestData()):k.execAction(e.action,m.desc.cube?m.desc.cube:m.desc.dataSource.replace(".kpi","")).then(L)},d.item.toggleExpanded=function(){(function(e){d.item[e]=!d.item[e];var t=_.getWidgetsSettings(m.desc.dashboard,k.getNamespace());t[m.desc.name]||(t[m.desc.name]={});t[m.desc.name][e]=d.item[e],_.setWidgetsSettings(t,m.desc.dashboard,k.getNamespace())})("isExpanded"),d.expandWidget&&d.expandWidget()},d.item.doExport=function(e){var t={sourceWidth:Math.floor(screen.width/2),sourceHeight:Math.floor(screen.height/2),filename:d.item.title||"chart"};switch(e){case"svg":t.type="image/svg+xml";break;case"jpg":t.type="image/jpeg";break;case"pdf":t.type="application/pdf";break;case"xls":var o=m.getMDX();if(m.lpt){var r=m.lpt;o=r._dataSourcesStack[r._dataSourcesStack.length-1].BASIC_MDX+r.dataSource.FILTERS}var i=(_.serverSettings.DefaultApp||"/csp/"+k.getNamespace())+"/_DeepSee.UI.MDXExcel.zen?MDX="+encodeURIComponent(o);return void window.open(i);case"csv":return void function(){var e,t,o,r=m._currentData;if(!m.lpt&&!r)return;o=m.lpt?(t=m.lpt.dataController.getData().dimensions[0],e=m.lpt.dataController.getData().dimensions[1],m.lpt.dataController.getData().dataArray):(e=r.Cols[1].tuples,t=r.Cols[0].tuples,r.Data);var i,s,a="\r\n",n='"sep=|"'+a;e[0]&&e[0].dimension&&(n+=e[0].dimension+"|");for(s=0;s<t.length;s++)n+=t[s].caption,s!==t.length-1&&(n+="|");for(n+=a,i=0;i<(e.length||o.length/t.length);i++){for(e[i]&&e[i].caption&&(n+=e[i].caption+"|"),s=0;s<t.length;s++)n+=o[i*t.length+s]||"0",s!==t.length-1&&(n+="|");n+=a}var l=(m.desc.title||"data")+".csv",c=new Blob([n],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(c,l);else{var d=document.createElement("a");if(void 0!==d.download){var u=URL.createObjectURL(c);d.setAttribute("href",u),d.setAttribute("download",l),d.style.visibility="hidden",document.body.appendChild(d),setTimeout(function(){d.click(),document.body.removeChild(d)},10)}}}()}m.chart&&m.chart.exportChart(t)},this.customColSpec="",this.customRowSpec="",this.customDataSource="",this.pivotData=null,this.linkedMdx="",this.hasDatasourceChoser=!1,this.hasActions=!1,this._onRequestError=function(e,t){d.chartConfig&&(d.chartConfig.loading=!1);var o=$.get("errWidgetRequest");switch(t){case 401:o=$.get("errUnauth");break;case 404:o=$.get("errNotFound")}m.showError(o)},this._retrieveData=function(){},this._retriveDataSource=function(e){if(!m)return;m.pivotData=e,m.customDataSource&&(m.desc.mdx=e.mdx,m.requestData())},this._retriveKPI=function(e){if(!m)return;if(m._kpiData=e,m.lpt)return void m.lpt.dataController.setData(m.lpt.dataSource._convert(F(e)));m._retrieveData(F(e))},this.doDrill=w,this.onInit=function(){},this.getMDX=function(){var e,t,o,r,i=!1;if(m.isLinked())return y(r=T(r=I(m.linkedMdx||this.desc.linkedMdx||"")));var s=P.getWidgetFilters(m.desc.name);if(m.drillFilter){var a=m.drillFilter.indexOf("&");-1!==a&&s.push({targetProperty:m.drillFilter.substring(0,a-1),value:"&"+this.drillFilter.substring(a+1,m.drillFilter.length)})}for(e=0;e<s.length;e++)if(""!==(t=s[e]).value||t.isInterval){i=!0;break}var n=I(m.desc.mdx);n||console.warn("Widget without MDX");if(m.customRowSpec){var l=n.match(/ON 0,(.*)ON 1/);if(2===l.length){var c=-1!==(r=l[1]).indexOf("NON EMPTY");n=n.replace(r,(c?"NON EMPTY ":" ")+m.customRowSpec+" ")}}if(n=function(s){var e=z.search().SETTINGS;if(!e)return s;for(var t=e.split(";"),o=null,r="",i=0;i<t.length;i++){var a=t[i].split(":");"target"!==a[0].toLowerCase()?"filter"===a[0].toLowerCase()&&(r=a.slice(1).join(":")):o=a[1]}if(o&&(m.desc.name===o||"*"===o||-1!==o.split(",").indexOf(m.desc.name))&&r)for(var n=r.split("~"),l=function(e){var t=n[e],o=-1!==t.indexOf("%NOT");if(-1!==t.indexOf("{")){var r=t.substring(0,t.indexOf("{")).replace("%NOT ",""),i=t.match(/\{([^)]+)\}/)[1].split(",");s+=" %FILTER %OR({",s+=i.map(function(e){return r+e+(o?".%NOT":"")}).join(","),s+="})"}else s+=" %FILTER "+t},c=0;c<n.length;c++)l(c);return s}(n=T(n)),!i||m.desc.tile)return y(n);for(e=0;e<s.length;e++)if((t=s[e]).isInterval){o=t.targetProperty;var d=t.values[t.fromIdx].path,u=t.values[t.toIdx].path;n+=" %FILTER %OR("+o+"."+d+":"+u+")"}for(e=0;e<s.length;e++)if(""!==(t=s[e]).value&&!t.isInterval){var h="{";t.isExclude&&(h="(");var p=t.value.toString().split("|");o=t.targetProperty,t.isExclude?n+=" %FILTER "+h:n+=" %FILTER %OR("+h;for(var g=0;g<p.length;g++)t.isExclude?n+=o+"."+p[g]+".%NOT,":n+=o+"."+p[g]+",";h="}",t.isExclude&&(h=")"),n=n.substr(0,n.length-1)+" "+h,t.isExclude||(n+=")")}{}return y(n)},this.clearError=function(){d.model.error=""},this.showError=function(e){d.model.error=e},this.hideToolbar=function(){d.item.toolbar=!1},this.showToolbar=N,this.requestData=L,this.updateFiltersText=function(){var e,t;if("mdx2json.emptyportlet"===m.desc.type)for(t=0;t<m.filterCount;t++)!(e=m.getFilter(t)).valueDisplay&&e.value&&(e.valueDisplay=e.value.replace("&[","").replace("]",""));for(t=0;t<m.filterCount;t++)(e=m.getFilter(t)).isInterval?d.model.filters[t].text=e.values[e.fromIdx].name+":"+e.values[e.toIdx].name:d.model.filters[t].text=(!0===e.isExclude&&e.valueDisplay?$.get("not")+" ":"")+e.valueDisplay},this.getFilter=function(e){return P.getFilter(d.model.filters[e].idx)},this.isLinked=function(){return!!m.desc&&m.desc.Link},this.hasDependents=function(){return m.desc&&m.desc.dependents?0!==m.desc.dependents.length:0},this.broadcastDependents=O,this.destroy=function(){this._currentData=null,m.liveUpdateInterval&&clearInterval(m.liveUpdateInterval);m.liveUpdateInterval=null,m=null},this.getDrillTitle=function(e){if(!e)return d.item.baseTitle||"";var t=e.path.split(".");return t.pop(),(d.item.baseTitle?d.item.baseTitle+" - ":"")+(e.name?t[t.length-1]+" - ":"")+(e.name||e.category)},this.drillUp=C,this.doDrillFilter=h,this.getDataByColumnName=function(e,t,o){if(!(e&&e.Data&&e.Cols&&e.Cols[0]&&e.Cols[0].tuples))return;var r=e.Cols[0].tuples.filter(function(e){return e.caption.toLowerCase()===t.toLowerCase()});if(0===r.length)return;var i=e.Cols[0].tuples.indexOf(r[0]);return e.Data[o+i]},this.getDrillthroughMdx=b,this.liveUpdateInterval=null,this.onResize=function(){},this.canDoDrillthrough=!1,m.desc.controls&&m.desc.controls.length&&(this.canDoDrillthrough=void 0!==m.desc.controls.find(function(e){return"showListing"===e.action})),m.desc&&m.desc.controls){var e=m.desc.controls.filter(function(e){return"setColumnSpec"===e.action});0!==e.length&&(m.customColSpec=e[0].targetProperty);var t=m.desc.controls.filter(function(e){return"refresh"===e.action&&0<parseInt(e.timeout)});0!==t.length&&(this.liveUpdateInterval=setInterval(m.requestData,1e3*parseInt(t[0].timeout)))}d.item.toolbarView="src/views/filters.html";var o,r=d.$on("drillFilter:"+m.desc.name,p),i=d.$on("drillFilter:*",p),s=d.$on("setColSpec:"+m.desc.name,D),a=d.$on("setColSpec:*",D),n=d.$on("updatePivotVar:"+m.desc.name,u),l=d.$on("updatePivotVar:*",u),c=d.$on("changeDataSource:"+m.desc.name,function(e,t){S(t)});function u(){m.requestData()}function h(e,t){if(m.drillFilterWidgets&&m.drillFilterWidgets.length){var o,r=t.slice();for(e||r.pop(),d.item.clickFilterActive=!!e,o=0;o<m.drillFilterWidgets.length;o++)A.$broadcast("drillFilter:"+m.drillFilterWidgets[o],e,r)}}function p(e,t,o){m.drillFilter=t,m.drillFilterDrills=o,m.requestData()}function g(e,t){var o=void 0!==t&&t,r=e.targetProperty,i=r.toUpperCase().indexOf("DASHBOARD=");if(-1!==i){var s=r.substring(i+10,r.length);-1==s.indexOf("?")&&(s=s.replace("&","?"));var a=z.absUrl();-1!==a.indexOf("#")?r=a.split("#")[0]+"#!/d/"+s:r+=NaN+s}if(r=r.replace("$$$FILTERS",P.getFiltersUrlString(m.desc.name)),m.lpt&&m.lpt.getSelectedRows().length){var n=m.lpt.dataController.getData(),l=n.dataArray[(m.lpt.getSelectedRows()[0]-1)*n.columnProps.length],c=r.toLowerCase().indexOf("$$$currvalue");-1!==c&&(r=r.substring(0,c)+l+r.substring(c+12,r.length))}if(m.lpt&&m.lpt.getSelectedRows().length){for(var d=m.lpt.dataController.getData(),u=m.lpt.getSelectedRows(),h=[],p=0;p<u.length;p++){var g=d.dataArray[(u[p]-1)*d.columnProps.length];h.push(g)}var f=r.toLowerCase().indexOf("$$$valuelist");-1!==f&&(r=r.substring(0,f)+h.join(",")+r.substring(f+12,r.length))}z.search().embed&&(r+="&embed=1"),o?window.open(r,"_blank"):window.location=r}function f(e){return!(e&&e.Cols&&e.Cols[1]&&e.Cols[1]&&e.Cols[1].tuples&&0!==e.Cols[1].tuples.length&&e.Data&&0!==e.Data.length&&"@NOPROPERTY"!==e.Data[0])}function v(){delete d.item.pivotMdx,delete d.item.pivotData,d.item.backButton=0!==m.drills.length,m.desc.type=m.desc.oldType,d.$broadcast("typeChanged")}function C(){d.item.isDrillthrough?(v(),d.item.isDrillthrough=!1):w()}function b(e){var t=e.toLowerCase(),o="select non empty",r=t.indexOf(o);-1===r&&(o="select",r=t.indexOf(o));var i=t.indexOf("from");if(-1!==r){if(-1!==i){var s="";if(m.pivotData.listingRows){var a=parseInt(m.pivotData.listingRows);a&&(s=" MAXROWS "+a+" ")}var n=m.desc.controls.find(function(e){return"showListing"===e.action});if(n){var l=n.targetPropertyDisplay;if(l)return"DRILLTHROUGH "+s+e.substring(0,r+o.length)+" "+e.substring(i,e.length)+" %LISTING ["+l+"]"}return"DRILLTHROUGH "+s+e.substring(0,r+o.length)+" "+e.substring(i,e.length)}console.warn("Can't find 'from' in MDX during calculation drillthrough mdx")}else console.warn("Can't find 'select' in MDX during calculation drillthrough mdx")}function w(t,o,r,e){var i=M.defer();m.clearError(),h(t,m.drills);var s=m.drills.slice();t?m.drills.push({path:t,name:o,category:r}):m.drills.pop();var a=m.getMDX();function n(){if(e)e();else if(m.canDoDrillthrough){var t=b(a);k.execMDX(t).then(function(e){e&&e.children&&0!==e.children.length&&(d.item.isDrillthrough=!0,d.item.backButton=!0,d.item.pivotData=e,d.item.displayAsPivot(t))})}}return m.drills=s,m.showLoading(),k.execMDX(a).catch(function(){n()}).then(function(e){e&&(d.chartConfig&&(d.chartConfig.loading=!1),f(e)&&t?n():f(e)||(t?m.drills.push({path:t,name:o,category:r}):m.drills.pop(),d.item.backButton=0!==m.drills.length,d.item.title=m.getDrillTitle(m.drills[m.drills.length-1]),m.broadcastDependents(a),m._retrieveData(e)))}).finally(function(){m.hideLoading(),i.resolve()}),i.promise}function y(e){var t;R.filter&&(e=e+" %FILTER "+R.filter);var o=m.drills;if(0===o.length&&(o=m.drillFilterDrills),0===o.length)return e;var r=[];for(m.pivotData&&m.pivotData.rowAxisOptions&&m.pivotData.rowAxisOptions.drilldownSpec&&(r=m.pivotData.rowAxisOptions.drilldownSpec.split("^")),t=0;t<o.length;t++)o[t].path&&(e+=" %FILTER "+o[t].path);var i=r[o.length-1],s=i||o[o.length-1].path,a=e.match(/ON 0,(.*)ON 1/);if(a&&2===a.length){var n=a[1],l=-1!==n.indexOf("NON EMPTY");e=e.replace(n,(l?"NON EMPTY ":" ")+s+" ")}return(i||0===r.length)&&0!==r.length||e.match(/\{.*\} ON 1/)?(m.drillFilter&&(e=e+" %FILTER "+m.drillFilter),e):e=-1===e.indexOf(".Members ON 1 FROM")?e.replace(" ON 1 FROM"," .children ON 1 FROM"):e.replace(".Members ON 1 FROM","."+s.split(".").pop()+".children ON 1 FROM")}function S(e,t){if(t&&""!==t.control.target)for(var o=t.control.target.split(","),r=0;r<o.length;r++)A.$broadcast("changeDataSource:"+o[r],e);else m.customDataSource=e||"",x()}function D(e,t){m.customColSpec=t,m.requestData()}function x(){var e=m.customDataSource||m.desc.dataSource;m.desc.kpitype?e&&k.getKPIData(e).then(m._retriveKPI):e&&k.getPivotData(e).then(m._retriveDataSource)}function F(e){var t=e;e=e.Result;var o,r,i={Info:{cubeName:t.Info.KpiName},Cols:[],Data:[]},s=[];for(o=0;o<e.Properties.length;o++)s.push({caption:e.Properties[o].caption||e.Properties[o].name});i.Cols.push({tuples:s});var a=[];for(o=0;o<e.Series.length;o++){for(r=0;r<e.Properties.length;r++)i.Data.push(e.Series[o][e.Properties[r].name]);a.push({title:e.Series[o]["%series"],caption:e.Series[o]["%series"]})}return i.Cols.push({tuples:a}),i}function L(){if(m.supported)if(m.desc.kpitype){var e=m.customDataSource||m.desc.dataSource;e&&k.getKPIData(e).then(m._retriveKPI)}else{var t=m.getMDX();t&&(m.clearError(),setTimeout(O,0),!1,-1===t.indexOf("$")||this.pivotVariables||k.getPivotVariables(m.desc.cube).then(function(e){m.pivotVariables=e,console.log(e)}),k.execMDX(t).catch(m._onRequestError).then(function(e){m&&(m._currentData=e,m._retrieveData(e))}))}}function O(e){if(m.hasDependents())for(var t=0;t<m.desc.dependents.length;t++)A.$broadcast("setLinkedMDX:"+m.desc.dependents[t],e||m.getMDX())}function T(e){if(m.customColSpec){var t="SELECT NON EMPTY",o=e.lastIndexOf(t);if(-1===o&&(t="SELECT",o=e.lastIndexOf(t)),-1===o)return e;var r=e.lastIndexOf("ON 0");return-1===r?e:r<o?e:e=e.replace(e.substring(o,r),t+" "+m.customColSpec+" ")}return e}function I(e){if(!W.items.length||-1===e.indexOf("$"))return e;for(var t=0;t<W.items.length;t++){var o=W.items[t];if(""!==o.value)for(var r,i=o.targetProperty.toLowerCase();-1!==(r=e.toLowerCase().indexOf(i));)e=e.substr(0,r)+o.value+e.substr(r+i.length,e.length)}return e}function N(){d.item.toolbar=!0}d.$on("$destroy",function(){r(),i(),s(),a(),n(),l(),c(),m.destroy()}),void 0===this.filterCount&&Object.defineProperty(this,"filterCount",{get:function(){return d.model.filters.length}}),this.isLinked()&&d.$on("setLinkedMDX:"+m.desc.key,function(e,t){m.desc.linkedMdx=t,m.linkedMdx=t,m.requestData()}),this.hasDependents()&&d.$on("widget:"+m.desc.key+":refreshDependents",function(){m.broadcastDependents()}),(o=P.getClickFilterTarget(m.desc.name))&&(m.drillFilterWidgets=o.split(",")),function(){if(!m.desc)return;function e(r){return function(e){if(e.data&&"object"==typeof e.data){for(var t in e.data)e.data[t]===m.desc.dataSource&&(d.item.dsSelected=t);for(var o in r.labels=[],r.values=[],e.data)r.labels.push(o),r.values.push(e.data[o]);-1===r.labels.indexOf(r.dsSelected)&&(r.dsSelected=r.labels[0])}}}function t(e){return"chooseDataSource"===e.action||"chooseRowSpec"===e.action||"chooseColumnSpec"===e.action}var o="mdx2json.emptyportlet"===m.desc.type;if(!(o||m.desc.controls&&0!==m.desc.controls.length))return;var r=[];m.desc.controls&&(r=m.desc.controls.filter(t).filter(function(e){return"dashboard"!==e.location}));if(o)for(var i=0,s=d.getDesc(i);s;)s.controls&&(r=r.concat(s.controls.filter(t).filter(function(e){return"dashboard"===e.location}))),i++,s=d.getDesc(i);if(0===r.length)return;m.hasDatasourceChoser=!0,d.item.dsItems=[];for(var a=0;a<r.length;a++){var n=r[a].targetProperty;if(n){var l=n.split(".");l.pop(),n=l.join(".");var c={action:r[a].action,label:r[a].label||$.get("dataSource"),dsSelected:r[a].value,control:r[a]};d.item.dsItems.push(c),k.getTermList(n).then(e(c))}}N()}(),function(){if(!m.desc.controls||0===m.desc.controls.length)return;var t=["chooserowspec","choosedatasource","choosecharttype","applyfilter","setfilter","refresh","reloaddashboard","showlisting","showgeolisting","showbreakdown","setdatasource","applyvariable","viewdashboard","setrowcount","setrowsort","setcolumncount","setcolumnsort","choosecolumnspec"],e=m.desc.controls.filter(function(e){return-1===t.indexOf(e.action.toLowerCase())&&"hidden"!==e.type});if(0===e.length)return;m.hasActions=!0,N(),d.item.acItems=e}(),function(){var e,t="mdx2json.emptyportlet"===m.desc.type;if(!W.isExists())return;e=W.items.filter(function(e){return t?"dashboard"===e.location:"dashboard"!==e.location&&("*"===e.location||e.location===m.desc.name)}),d.item.pvItems=e,N()}(),x()}}]),angular.module("widgets").factory("EmptyWidget",["$rootScope","Lang","Filters","Storage","Connector",function(r,i,s,a,n){return function(t){var e,o=this;t.item.title=i.get("filters"),t.item.toolbar=!0,t.item.toolbarView="src/views/emptyWidgetToolbar.html",t.item.setFiltersToDefaults=function(){for(var e=0;e<o.filterCount;e++){var t=o.getFilter(e);t.isInterval=!1,t.isExclude=t.defaultExclude,t.fromIdx=-1,t.toIdx=-1,t.values.forEach(function(e){e.checked=!0===e.default}),s.applyFilter(t,!0)}r.$broadcast("filterAll"),o.updateFiltersText()},t.item.viewSize=(e=a.getWidgetsSettings(o.desc.dashboard,n.getNamespace()))[o.desc.name]?void 0===e[o.desc.name].viewSize?100:e[o.desc.name].viewSize:100,t.item.setViewSize=function(e){t.item.viewSize=e,function(){var e=a.getWidgetsSettings(o.desc.dashboard,n.getNamespace());e[o.desc.name]||(e[o.desc.name]={});e[o.desc.name].viewSize=t.item.viewSize,a.setWidgetsSettings(e,o.desc.dashboard,n.getNamespace())}()},this.requestData=function(){}}}]),angular.module("widgets").factory("BaseChart",["Lang","Utils","Connector","$timeout","CONST","Storage","ngDialog","$window","$routeParams",function(w,h,p,g,y,S,D,x,F){return function(f){this.addSeries=function(e){if(e&&e.data&&0!==e.data.length){for(var t=!0,o=!1,r=0;r<e.data.length;r++){var i=e.data[r];if("object"==typeof i&&(!(i instanceof Array)&&(o=!0,0!==i.y&&""!==i.y&&null!==i.y&&void 0!==i.y))){t=!1;break}}t&&o&&(e.showInLegend=!1)}var s=n.hcColors||Highcharts.getOptions().colors;e.color=s[f.chartConfig.series.length%s.length];var a=f.chartConfig.series.length;this.seriesTypes&&this.seriesTypes[a]&&(e.type=this.seriesTypes[a]);f.chartConfig.series.push(e)},this.setType=function(e){f.chartConfig.options.chart.type=e},this.getMinValue=C,this.enableStacking=function(){h.merge(f.chartConfig.options,{plotOptions:{series:{stacking:"normal"}}})},this.baseRequestData=this.requestData,this.requestData=function(){f.chartConfig.loading=!0,m.baseRequestData()},this.parseData=function(e){var t,o=e;o.Cols[1]||(o.Cols[1]={tuples:[]});0===o.Cols[1].tuples.length&&o.Cols[1].tuples.push({caption:w.get("count")});(function(e){var t=(m.desc.controls||[]).filter(function(e){return"setRowCount"===e.action})[0],o=t&&t.value||20;if("normal"===f.chartConfig.options.plotOptions.series.stacking||!f.chartConfig.options.plotOptions.series.stacking){e.Cols[1].tuples;var r=e.Cols[0].tuples;if(f.item.isTop){if(1!==r.length)return e.Cols[1].tuples.splice(o,e.Cols[1].tuples.length-o);for(var i=!0;i;){var s;for(i=!1,s=0;s<e.Data.length-1;s++)if(e.Data[s]<e.Data[s+1]){i=!0;var a=e.Data[s];e.Data[s]=e.Data[s+1],e.Data[s+1]=a,a=e.Cols[1].tuples[s],e.Cols[1].tuples[s]=e.Cols[1].tuples[s+1],e.Cols[1].tuples[s+1]=a}}e.Cols[1].tuples.splice(o,e.Cols[1].tuples.length-o)}}})(e),e&&e.Info&&(m.dataInfo=e.Info);for(f.chartConfig.yAxis.min=C(o.Data),f.chartConfig.series=[],f.chartConfig.xAxis.categories=[],t=0;t<o.Cols[1].tuples.length;t++)f.chartConfig.xAxis.categories.push(o.Cols[1].tuples[t].caption.toString());var r=[],i=!1,s=m.desc.controls.find(function(e){return"setcolumncount"===e.action.toLowerCase()});0!==o.Cols[0].tuples.length&&o.Cols[0].tuples[0].children&&0!==o.Cols[0].tuples[0].children.length&&(i=!0);if(i)for(var a=0,n=0;n<o.Cols[0].tuples.length;n++)for(var l=o.Cols[0].tuples[n].children?o.Cols[0].tuples[n].children.length:1,c=0;c<l;c++){r=[];for(var d=0;d<o.Cols[1].tuples.length;d++)r.push({y:+o.Data[o.Cols[0].tuples.length*l*d+n*l+c],cube:o.Info.cubeName,drilldown:!0,path:o.Cols[1].tuples[d].path,title:o.Cols[1].tuples[d].title}),a++;v(r),o.Cols[0].tuples[n].children?m.addSeries({data:r,name:o.Cols[0].tuples[n].caption+"/"+o.Cols[0].tuples[n].children[c].caption,format:o.Cols[0].tuples[n].children[c].format||b(o)}):m.addSeries({data:r,name:o.Cols[0].tuples[n].caption,format:o.Cols[0].tuples[n].format||b(o)})}else for(var u=o.Cols[0].tuples.length-1;0<=u;u--)if(!(s&&u>=s.value)){for(r=[],t=0;t<o.Cols[1].tuples.length;t++)r.push({y:+o.Data[t*o.Cols[0].tuples.length+u],drilldown:!0,cube:o.Info.cubeName,path:o.Cols[1].tuples[t].path,name:o.Cols[1].tuples[t].caption,title:o.Cols[1].tuples[t].title});v(r);var h=w.get("count"),p="";o.Cols[0].tuples[u]&&(h=o.Cols[0].tuples[u].caption,p=o.Cols[0].tuples[u].format),m.addSeries({data:r,name:h,format:p||b(o)})}if("combochart"===m.desc.type.toLowerCase()){var g=f.chartConfig.series;for(a=0;a<g.length;a++)g[a].yAxis=g.length-1-a}},this.onResize=function(){m.chart&&m.chart.reflow()},this._retrieveData=function(e){if(!m)return;var t;if(m.widgetData={},angular.copy(e,m.widgetData),f.chartConfig.loading=!1,e.Error)return void m.showError(e.Error);if(e){var o=m.getMinValue(e.Data);if(0<o&&o<=10&&(f.chartConfig.yAxis.currentMin=0),!e.Cols)return;if(0===e.Cols[0].tuples.length&&0!==e.Data.length&&e.Cols[0].tuples.push({caption:w.get("count")}),m.parseData(e),"combochart"===m.desc.type.toLowerCase())for(t=0;t<f.chartConfig.series.length;t++)if(!f.chartConfig.series[t].type){switch(t%3){case 0:f.chartConfig.series[t].type=this.seriesTypes[t]||"bar",f.chartConfig.series[t].zIndex=2,f.chartConfig.series[t].color=Highcharts.getOptions().colors[1];break;case 1:f.chartConfig.series[t].type=this.seriesTypes[t]||"line",f.chartConfig.series[t].yAxis=1,f.chartConfig.series[t].color=Highcharts.getOptions().colors[2],f.chartConfig.series[t].zIndex=0;break;case 2:f.chartConfig.series[t].type=this.seriesTypes[t]||"area"}f.chartConfig.yAxis[t].title={text:f.chartConfig.series[t].name}}if(f.item.showZero&&c(),a){var r=S.getWidgetsSettings(m.desc.dashboard,p.getNamespace());if(h.isEmbedded()){var i=F.hiddenSeries,s=[];i&&(s=i.split(",")),s.forEach(function(e){f.chartConfig.series[e]&&(f.chartConfig.series[e].visible=!1)})}else if(r[m.desc.name]&&r[m.desc.name].series)for(t=0;t<f.chartConfig.series.length;t++)!1===r[m.desc.name].series[t]&&(f.chartConfig.series[t].visible=!1);r=null,a=!1,m.onResize()}}},this.formatNumber=function(e,t){var o;o=t?numeral(e).format(t.replace(/;/g,"")):e.toString();m.dataInfo&&(o=o.replace(/,/g,m.dataInfo.numericGroupSeparator).replace(/\./g,m.dataInfo.decimalSeparator));return o},this.initFormatForSeries=function(e){for(var t=f.chartConfig.series,o=0;o<t.length;o++)t[o].format||(t[o].format=r(e));function r(e){if(!e||!e.Info)return"";for(var t="",o=0;o<e.Info.numericGroupSize;o++)t+="#";return t+=",#.##"}},this.limitSeriesAndData=d,this.toggleButton=l,this.hasOption=function(e){var t=S.getWidgetsSettings(m.desc.dashboard,p.getNamespace());return!!t[m.desc.name]&&(void 0!==t[m.desc.name][e]&&!1!==t[m.desc.name][e])},this.dataInfo=null,this.widgetData=null,this.labelsFormatter=u,this._selectedPoint=null,this.seriesTypes=[];var m=this,a=!0,e=S.getAppSettings();f.item.isLegend=!0;var r=S.getWidgetsSettings(m.desc.dashboard,p.getNamespace())||{},n=e.themeColors[e.theme]||{};if(r[m.desc.name]&&r[m.desc.name].themeColors&&r[m.desc.name].themeColors[e.theme]&&(n=r[m.desc.name].themeColors[e.theme]),s(r,"isLegend"),s(r,"isTop"),s(r,"showZero"),s(r,"showValues"),this.desc.overrides&&this.desc.overrides[0]&&this.desc.overrides[0].seriesTypes&&(this.seriesTypes=this.desc.overrides[0].seriesTypes.split(",")),f.item.isChart=!0,f.item.displayAsPivot=function(e){"pivot"===m.desc.type?(f.item.isDrillthrough=null,m.restoreWidgetType()):(f.item.pivotMdx=e||m.getMDX(),m.changeWidgetType("pivot"))},f.item.toggleLegend=function(){if(l("isLegend"),m.chart)try{f.item.isLegend?m.chart.legendShow():m.chart.legendHide()}catch(e){}f.chartConfig.legend={enabled:f.item.isLegend}},f.item.toggleTop=function(){l("isTop"),d()},f.item.toggleValues=function(){l("showValues"),f.chartConfig.options.plotOptions.series.dataLabels.enabled=!0===f.item.showValues},f.item.showZeroOnAxis=function(){if(l("showZero"),f.item.showZero)c();else if(f.chartConfig.yAxis instanceof Array)for(var e=0;e<f.chartConfig.yAxis.length;e++)f.chartConfig.yAxis[e].currentMin=f.chartConfig.yAxis[e].prevMin;else f.chartConfig.yAxis.currentMin=f.chartConfig.yAxis.prevMin},f.item.showSettings=function(){r[m.desc.name]||(r[m.desc.name]={});r[m.desc.name].themeColors||(r[m.desc.name].themeColors={});D.open({template:"src/views/settings.html",data:{isWidgetSettings:!0,widgetSettings:r[m.desc.name],saveWidgetSettings:function(){S.setWidgetsSettings(r,m.desc.dashboard,p.getNamespace()),x.location.reload()}},controller:"settings",disableAnimation:dsw.mobile,showClose:!0,className:"ngdialog-theme-default wnd-settings"})},f.item.isBtnZero=!1,f.item.isBtnValues=!1,f.$on("print:"+f.item.$$hashKey,function(){m.chart&&m.chart.print()}),f.chartConfig={options:{labels:{style:{color:n.hcTextColor}},drilldown:{activeAxisLabelStyle:{color:n.hcTextColor},activeDataLabelStyle:{color:n.hcTextColor}},legend:{enabled:f.item.isLegend,itemStyle:{color:n.hcTextColor}},navigation:{buttonOptions:{align:"center"}},chart:{type:"line",backgroundColor:n.hcBackground},credits:{enabled:!1},tooltip:{formatter:function(){var e=this,t=e.series.options.format,o=e.y;t&&(o=m.formatNumber(o,t));var r=(e.point.name||e.x||"")+"<br>"+(e.point.title?e.point.title+"<br>":"")+e.series.name+": <b>"+o+"</b><br>";e.point.percentage&&(r+=parseFloat(e.point.percentage).toFixed(2).toString()+"%");return r}},exporting:{enabled:!1},plotOptions:{column:{borderColor:n.hcBorderColor},bar:{borderColor:n.hcBorderColor},pie:{borderColor:n.hcBorderColor},treemap:{borderColor:n.hcBorderColor},series:{fillOpacity:n.hcOpacity,cursor:"pointer",point:{events:{click:function(e){if(!e.point)return;if(dsw.mobile&&m._selectedPoint!==e.point)return void(m._selectedPoint=e.point);f.chartConfig.loading=!0,m.doDrill(e.point.path,e.point.name,e.point.category).then(function(){f.chartConfig.loading=!1})}}},dataLabels:{enabled:!0===f.item.showValues,formatter:u},events:{legendItemClick:function(e){!function(e,t){f.item[name]=!f.item[name];var o=S.getWidgetsSettings(m.desc.dashboard,p.getNamespace());o[m.desc.name]||(o[m.desc.name]={});o[m.desc.name].series||(o[m.desc.name].series={});t?delete o[m.desc.name].series[e]:o[m.desc.name].series[e]=!1;S.setWidgetsSettings(o,m.desc.dashboard,p.getNamespace())}(this.index,!this.visible)}}}}},yAxis:{events:{},title:{text:""},labels:{style:{color:n.hcTextColor}},minorGridLineColor:n.hcLineColor,gridLineColor:n.hcLineColor,lineColor:n.hcLineColor,tickColor:n.hcLineColor},xAxis:{events:{},title:{text:""},labels:{style:{color:n.hcTextColor}},minorGridLineColor:n.hcLineColor,gridLineColor:n.hcLineColor,lineColor:n.hcLineColor,tickColor:n.hcLineColor},series:[],title:{text:""},func:function(e){m.chart||(m.chart=e),g(function(){e&&e.reflow()},0)},loading:!0},f.chartConfig.options.navigator={outlineColor:n.hcLineColor,xAxis:{gridLineColor:n.hcLineColor},yAxis:{gridLineColor:n.hcLineColor}},"combochart"===m.desc.type.toLowerCase()&&(f.chartConfig.yAxis=[{events:{},gridLineColor:n.hcLineColor,lineColor:n.hcLineColor,tickColor:n.hcLineColor,labels:{style:{color:n.hcTextColor}}},{events:{},opposite:!0,gridLineColor:n.hcLineColor,lineColor:n.hcLineColor,tickColor:n.hcLineColor,labels:{style:{color:n.hcTextColor}}}],this.desc.overrides&&this.desc.overrides[0]&&"comboChart"===this.desc.overrides[0]._type)){var t=this.desc.overrides[0].yAxisList;if(t&&t.length)for(var o=0;o<t.length;o++)t[o].title&&(f.chartConfig.yAxis[o].title=t[o].title),f.chartConfig.yAxis[o].axisType=t[o].axisType,"percent"===t[o].axisType&&(f.chartConfig.yAxis[o].labels={formatter:function(){return 100*this.value+"%"}})}if(m.desc.inline&&(f.chartConfig.options.chart.backgroundColor=null,f.chartConfig.options.plotOptions={series:{enableMouseTracking:!1}},f.chartConfig.options.legend={enabled:!1},m.desc.tile)){var i={xAxis:{events:{},labels:{style:{color:$("."+y.fontColors[m.desc.tile.fontColor]).css("color")}}},yAxis:{events:{},labels:{style:{color:$("."+y.fontColors[m.desc.tile.fontColor]).css("color")}}}};h.merge(f.chartConfig,i)}function s(e,t){if(h.isEmbedded()&&F[t]){var o=F[t];return"true"===o.toLowerCase()?o=!0:"false"===o.toLowerCase()&&(o=!1),void(f.item[t]=o)}e[m.desc.name]&&void 0!==e[m.desc.name][t]&&(f.item[t]=r[m.desc.name][t])}function l(e){f.item[e]=!f.item[e];var t=S.getWidgetsSettings(m.desc.dashboard,p.getNamespace());t[m.desc.name]||(t[m.desc.name]={}),t[m.desc.name][e]=f.item[e],S.setWidgetsSettings(t,m.desc.dashboard,p.getNamespace())}function c(){if(f.chartConfig.yAxis instanceof Array)for(var e=0;e<f.chartConfig.yAxis.length;e++)f.chartConfig.yAxis[e].prevMin=f.chartConfig.yAxis[e].currentMin,f.chartConfig.yAxis[e].currentMin=0;else f.chartConfig.yAxis.prevMin=f.chartConfig.yAxis.currentMin,f.chartConfig.yAxis.currentMin=0}function d(){m.requestData()}function u(){var e=this.series.options.format,t=this.y;return e&&(t=m.formatNumber(t,e)),t}function v(e){for(var t=0;t<e.length;t++)e[t].y||0===e[t].y||(e[t].y=null),""!==e[t].y&&void 0!==e[t].y||(e[t].y=null)}function C(e){for(var t=1/0,o=0;o<e.length;o++)e[o]<t&&(t=e[o]);return t}function b(e){if(!e.Info)return""}}}]),angular.module("widgets").factory("LineChart",["BaseChart","Utils",function(o,r){return function(e){o.apply(this,[e]),this.setType("line"),e.item.isBtnZero=!0,e.item.isBtnValues=!0;var t={};"combochart"!=this.desc.type.toLowerCase()&&(t={series:{lineWidth:3,marker:{enabled:!1}}}),"linechartmarkers"===this.desc.type.toLowerCase()&&(t={series:{marker:{enabled:!0}}}),r.merge(e.chartConfig.options.plotOptions,t),this.requestData()}}]),angular.module("widgets").factory("AreaChart",["BaseChart","Utils",function(t,o){return function(e){t.apply(this,[e]),this.setType("area"),e.item.isBtnZero=!0,e.item.isBtnValues=!0,o.merge(e.chartConfig.options,{plotOptions:{series:{colorByPoint:!1},area:{stacking:"normal",marker:{enabled:!1}}}}),this.requestData()}}]),angular.module("widgets").factory("BarChart",["BaseChart","Utils",function(t,e){return function(e){t.apply(this,[e]),this.setType("bar"),e.item.isBtnZero=!0,e.item.isBtnValues=!0,"barchartstacked"===this.desc.type.toLowerCase()&&this.enableStacking(),this.requestData()}}]),angular.module("widgets").factory("BarChartPercent",["BaseChart","Utils",function(a,n){return function(h){a.apply(this,[h]),h.item.menuDisabled=!0,h.item.isBtnValues=!0;var p=this;p.oldParseData=this.parseData,p.parseData=function(e){for(;0<p.chart.series.length;)p.chart.series[0].remove(!1);p.noPlanCats=[],p.oldParseData(e);var t,o,r,i,s,a;if(s=0,4<h.chartConfig.series.length)for(o=0;o<h.chartConfig.series[0].data.length;o++){for(a=0,t=5;t<h.chartConfig.series.length;t++)h.chartConfig.series[t].data[o]&&(a+=h.chartConfig.series[t].data[o].y);s<a&&(s=a)}s<1&&(s=1.1);for(h.chartConfig.yAxis.max=s,t=0,r=h.chartConfig.series[0].data.length;t<r;t++)if(null===h.chartConfig.series[0].data[t].y||void 0===h.chartConfig.series[0].data[t].y||""===h.chartConfig.series[0].data[t].y||0===h.chartConfig.series[0].data[t].y){var n=(h.chartConfig.series[1].data[t].y||0)+(h.chartConfig.series[2].data[t].y||0)+(h.chartConfig.series[3].data[t].y||0)+(h.chartConfig.series[4].data[t].y||0);0!==n?(h.chartConfig.series[1].data[t].y&&(h.chartConfig.series[5].data[t].y=h.chartConfig.series[1].data[t].y/n),h.chartConfig.series[2].data[t].y&&(h.chartConfig.series[6].data[t].y=h.chartConfig.series[2].data[t].y/n),h.chartConfig.series[3].data[t].y&&(h.chartConfig.series[7].data[t].y=h.chartConfig.series[3].data[t].y/n),h.chartConfig.series[4].data[t].y&&(h.chartConfig.series[8].data[t].y=h.chartConfig.series[4].data[t].y/n)):h.chartConfig.series[8].data[t].y=1,p.noPlanCats.push(h.chartConfig.series[8].data[t].name)}var l=[];for(l[3]="#7fa645",l[3]="#9fd84b",l[2]="#00b9ff",l[1]="#f7a35c",l[0]="#aaaaaa",t=0;t<h.chartConfig.series.length;t++)h.chartConfig.series[t].color=l[(t-1)%l.length],t<5&&(h.chartConfig.series[t].visible=!1,h.chartConfig.series[t].showInLegend=!1);var c=h.chartConfig.xAxis.categories.length;if(1<c){i=h.chartConfig.xAxis.categories[0],h.chartConfig.xAxis.categories[0]=h.chartConfig.xAxis.categories[c-1],h.chartConfig.xAxis.categories[c-1]=i;for(var d=0,u=h.chartConfig.series.length;d<u;d++)1<(c=h.chartConfig.series[d].data.length)&&(i=h.chartConfig.series[d].data[0],h.chartConfig.series[d].data[0]=h.chartConfig.series[d].data[c-1],h.chartConfig.series[d].data[c-1]=i)}},p.basePointClick=h.chartConfig.options.plotOptions.series.point.events.click,p.baseDrillup=h.item.drillUp,p.noPlanCats=[],p.getDrillMDX=function(e){var t,o,r=e.indexOf("&"),i=e.substr(0,r)+"Members",s=p.getMDX(),a="";if(p.pivotData){var n="";if(p.pivotData.rowAxisOptions&&p.pivotData.rowAxisOptions.drilldownSpec&&(n=p.pivotData.rowAxisOptions.drilldownSpec),n){var l=n.split("^");if(0!==l.length){l[p.drillLevel]&&(a=l[p.drillLevel]);for(var c=0;c<p.drills.length;c++)l[c]&&(s+=" %Filter "+p.drills[c])}}}if(a){-1===a.indexOf('"ИТОГО"')&&(a="{"+a+',%LABEL([podrReal].[All podrReal],"ИТОГО","")}');var d=s.match(/ON 0,(.*)ON 1/);2===d.length&&(t=d[1],o=-1!==t.indexOf("NON EMPTY"),s=s.replace(t,(o?"NON EMPTY ":" ")+i+" ")),s=s.replace(i,a)}else-1===s.indexOf(i)?(d=s.match(/SELECT(.*)ON 1/))&&2===d.length&&(t=d[1],o=-1!==t.indexOf("NON EMPTY"),s=s.replace(t,(o?" NON EMPTY ":" ")+e+".Children ")):s=s.replace(i,e+".Children");return s=s+" %FILTER "+e,console.log(s),s},p.onResize=function(){p.chart&&p.chart.container&&p.chart.container.parentNode&&(p.chart.container.parentNode.offsetHeight<450?h.chartConfig.xAxis.labels.style["font-size"]=6:h.chartConfig.xAxis.labels.style["font-size"]=11,p.chart.setSize(p.chart.container.parentNode.offsetWidth,p.chart.container.parentNode.offsetHeight,!1))};var t=h.item.title,o=[];if(h.item.drillUp=function(){p.baseDrillup(),o.pop();var e=o.pop();h.item.title=e?t+" - "+e:t},h.model.filters)for(var e=0;e<h.model.filters.length;e++){var r=this.getFilter(e);if(r.values)for(var i=0;i<r.values.length;i++)if(r.values[i].name&&("СЕЙЧАС"===r.values[i].name.toUpperCase()||"NOW"===r.values[i].name.toUpperCase())){r.values.splice(i,1);break}}this.setType("bar"),this.enableStacking();var s={options:{chart:{events:{redraw:function(){if(p.chart&&4<p.chart.series.length)for(var e=5;e<p.chart.series.length;e++)0!==p.chart.series[e].data.length&&p.chart.series[e].data[0].graphic&&p.chart.series[e].data[0].graphic.element&&p.chart.series[e].data[0].graphic.element.setAttribute("class","bar-summary")}}},legend:{reversed:!0},tooltip:{useHTML:!0,formatter:function(){var e=this,t=p.chart.series[0].processedYData[e.point.index]||0,o=p.chart.series[3].processedYData[e.point.index]||0,r=p.chart.series[4].processedYData[e.point.index]||0,i=p.chart.series[2].processedYData[e.point.index]||0,s=p.chart.series[1].processedYData[e.point.index]||0,a="<b>"+e.point.name+"</b><br>";-1!==p.noPlanCats.indexOf(e.point.name)?a+="Запланировано: план отсутствует<br/>":a+="Запланировано: "+t+"<br/>";a+="<span>&nbsp;</span><br/>",a+="Всего пролечено: "+(r+o),0!==t&&(a+=" ("+Math.round((r+o)/t*100).toFixed(0)+"%)");a+="<br/>",a+="из них:<br/>",a+="<span>&nbsp;</span><span>&nbsp;</span><span>&nbsp;</span><span>принято к оплате: "+r,0!==t&&(a+=" ("+Math.round(r/t*100).toFixed(0)+"%)</span>");a+="<br/>",a+="<span>&nbsp;</span><span>&nbsp;</span><span>&nbsp;</span><span>не принято к оплате: "+parseInt(o),0!==t&&(a+=" ("+Math.round(o/t*100).toFixed(0)+"%)</span>");a+="<br/>",a+="<span>&nbsp;</span><br/>",a+="Пребывает в стационаре: "+i,0!==t&&(a+=" ("+Math.round(i/t*100).toFixed(0)+"%)");a+="<br/>",a+="В очереди: "+s,0!==t&&(a+=" ("+Math.round(s/t*100).toFixed(0)+"%)");a+="<br/>",a+="<span>&nbsp;</span><br/>",a+="Проноз выполнения плана: "+(r+o+i+s),0!==t&&(a+=" ("+Math.round((r+o+i+s)/t*100).toFixed(0)+"%)");return a}},plotOptions:{series:{point:{events:{click:function(e){if("ИТОГО"===e.point.name)return;p.basePointClick(e),o.push(e.point.name),h.item.title=t+" - "+e.point.name}}}}}},xAxis:{labels:{formatter:function(){var e=this;return"ИТОГО"!==e.value?-1===p.noPlanCats.indexOf(e.value)?e.value:'<span style="color: red">'+e.value+"<span>":'<span style="font-weight: bold; color: black">'+e.value+"<span>"},step:1,style:{padding:"0px",margin:"0px"}}},yAxis:{plotLines:[{color:"red",value:1,width:2,zIndex:3}],labels:{formatter:function(){return 1!==this.value?parseFloat(100*this.value).toFixed(0)+"%":'<span style="font-size: 110%;font-weight:bold;color: red">100%</span>'},step:1}}};n.merge(h.chartConfig,s),this.requestData()}}]),angular.module("widgets").factory("ColumnChart",["BaseChart",function(t){return function(e){t.apply(this,[e]),this.setType("column"),e.item.isBtnZero=!0,e.item.isBtnValues=!0,"columnchartstacked"===this.desc.type.toLowerCase()&&this.enableStacking(),this.requestData()}}]),angular.module("widgets").factory("PieChart",["BaseChart","Utils",function(i,s){return function(e){i.apply(this,[e]);var o=this;o.labelsFormatter=function(){var e=this.series.options.format,t=this.y;e&&(t=o.formatNumber(t,e));return this.key+", "+t},e.item.toggleLegend=function(){o.toggleButton("isLegend"),o.chart&&(e.chartConfig.options.plotOptions.series.dataLabels={enabled:e.item.isLegend})},e.item.toggleValues=function(){o.toggleButton("showValues"),e.chartConfig.options.plotOptions.pie.dataLabels={enabled:e.item.showValues,formatter:o.labelsFormatter},e.item.showValues||(delete e.chartConfig.options.plotOptions.series.dataLabels.formatter,delete e.chartConfig.options.plotOptions.pie.dataLabels.formatter)};var t={series:{allowPointSelect:e.item.isBtnValues=!0,stickyTracking:!1}};e.chartConfig.options.plotOptions||(e.chartConfig.options.plotOptions={}),s.merge(e.chartConfig.options.plotOptions,t),"donutChart"!==this.desc.type&&"donutChart3D"!==this.desc.type||(t={plotOptions:{pie:{innerSize:"20%"}}},s.merge(e.chartConfig.options,t)),"pieChart3D"!==this.desc.type&&"donutChart3D"!==this.desc.type||(t={chart:{options3d:{enabled:!0,alpha:55,beta:0}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35}}},s.merge(e.chartConfig.options,t));var r={plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:e.item.showValues}},series:{dataLabels:{formatter:o.labelsFormatter}}}};s.merge(e.chartConfig.options,r),e.chartConfig.options.plotOptions.series.dataLabels||(e.chartConfig.options.plotOptions.series.dataLabels={}),e.chartConfig.options.plotOptions.series.dataLabels.enabled=e.item.isLegend,e.item.showValues||(delete e.chartConfig.options.plotOptions.series.dataLabels.formatter,delete e.chartConfig.options.plotOptions.pie.dataLabels.formatter),this.setType("pie"),this.requestData()}}]),angular.module("widgets").factory("XyChart",["BaseChart",function(e){return function(i){e.apply(this,[i]),this.setType("scatter"),i.chartConfig.options.chart.zoomType="xy",i.chartConfig.options.plotOptions={series:{lineWidth:3,marker:{enabled:!0}}},i.chartConfig.options.tooltip={formatter:function(){var e=this.series.userOptions.format1,t=this.series.userOptions.format2,o=this.y,r=this.x;return e&&(o=numeral(o).format(e)),t&&(r=numeral(r).format(t)),i.chartConfig.yAxis.title.text+":<b>"+o+"</b><br/>"+i.chartConfig.xAxis.title.text+":<b>"+r+"</b>"}},this.parseData=function(e){var t="";1<=e.Cols[0].tuples.length&&(i.chartConfig.xAxis.title.text=e.Cols[0].tuples[0].caption,t=e.Cols[0].tuples[0].format),2<=e.Cols[0].tuples.length&&(i.chartConfig.yAxis.title.text=e.Cols[0].tuples[1].caption,t=e.Cols[0].tuples[1].format),i.chartConfig.series=[];var o=[];if(e.Cols[0].tuples[0].children)this.showError("Data converter for this xy chart not implemented!");else{o=[];for(var r=0;r<e.Cols[1].tuples.length;r++)o.push([parseFloat(e.Data[2*r]),parseFloat(e.Data[2*r+1])]);this.addSeries({data:o,name:"",format1:t,fotmat2:""}),i.chartConfig.xAxis.tickInterval=Math.round((o[o.length-1][0]-o[0][0])/10)}},this.requestData()}}]),angular.module("widgets").factory("TimeChart",["BaseChart","Utils","$timeout",function(t,o){return function(d){t.apply(this,[d]);var u=this,e={options:{chart:{zoomType:"x"},tooltip:{formatter:function(){var e,t,o,r=this,i=new Date(r.x),s=i.toLocaleDateString();0!==i.getHours()&&0!==i.getMinutes()&&0!==i.getSeconds()&&(s+=" "+i.toLocaleTimeString());{if(r.series)return t=r.series.options.format,o=r.y,o=u.formatNumber(o,t),e="<b>"+s+'</b><br><span style="color:'+r.series.color+'">●</span>'+r.series.name+":<b> "+o;e="<b>"+s+"</b><br>";for(var a=r.points.length-1;-1<a;a--)t=r.points[a].series.options.format,o=r.points[a].y,o=u.formatNumber(o,t),e+='<span style="color:'+r.points[a].series.color+'">●</span>'+r.points[a].series.name+":<b> "+o+"<br>";return e}}},navigator:{enabled:d.item.isBtnValues=!0},scrollbar:{enabled:!1}},series:[],useHighStocks:!0,loading:!0};function h(e){var t=e.indexOf("&[");return-1==t?"":e.substring(t+2,e.length-1)}function l(e){var t=Date.parse(e);if(!isNaN(t))return t;if(2==e.split("-").length){var o=e.split("-"),r=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"].indexOf(o[0].toLowerCase());if(-1!=r)return Date.parse((r+1).toString()+"/01/"+o[1])}else if(2==e.split(" ").length){if(0===e.split(" ")[1].split(":").length&&(e+=":00"),t=Date.parse(e.replace(/-/g,"/")),!isNaN(t))return t}return 0}function p(e){var t,o;if(""===e&&void 0===e||null===e)return null;var r=e.toString();if(7===e.length&&"W"===e.charAt(4))return o=1+7*(parseInt(e.substring(5,7))-1),t=parseInt(e.substring(0,4)),Date.parse(new Date(t,0,o));if(4==r.length)return l(e);if(-1!=r.indexOf("-"))return l(e);if(-1!=r.indexOf(" "))return l(e);if(6==r.length){t=r.substr(0,4);var i=r.substr(4,2);return Date.parse(new Date(parseInt(t),parseInt(i)-1,1))}if(5!=r.length||isNaN(parseInt(r)))return l(e);var s=new Date(1840,11,31),a=r.toString().split(",");o=parseInt(a[0]);var n=null;return 1<a.length&&(n=parseInt(a[1])),s=function(e,t){var o=new Date(e);return o.setDate(e.getDate()+t),o}(s,parseInt(o)),n&&s.setSeconds(n),Date.parse(s)}o.merge(d.chartConfig,e),this.parseData=function(e){e&&e.Info&&(u.dataInfo=e.Info),d.chartConfig.yAxis.min=u.getMinValue(e.Data),d.chartConfig.series=[];var t,o,r=[];if(e.Cols[0].tuples[0].children)for(var i=0;i<e.Cols[0].tuples.length;i++)for(var s=0;s<e.Cols[0].tuples[i].children.length;s++){r=[];for(var a=0;a<e.Cols[1].tuples.length;a++)t=p(h(e.Cols[1].tuples[a].path)),r.push([t,+e.Data[e.Cols[0].tuples.length*e.Cols[0].tuples[i].children.length*a+i*e.Cols[0].tuples[i].children.length+s]||0]),""===r[r.length-1][1]&&(r[r.length-1][1]=null),0;u.addSeries({data:r,name:e.Cols[0].tuples[i].caption+"/"+e.Cols[0].tuples[i].children[s].caption,format:e.Cols[0].tuples[i].format})}else for(var n=e.Cols[0].tuples.length-1;0<=n;n--){for(r=[],o=0;o<e.Cols[1].tuples.length;o++){t=p(h(e.Cols[1].tuples[o].path));var l=+e.Data[o*e.Cols[0].tuples.length+n];""!==l&&r.push([t,l||0])}u.addSeries({data:r,name:e.Cols[0].tuples[n].caption,format:e.Cols[0].tuples[n].format})}if(u.chart&&0!==d.chartConfig.series.length&&u.chart.xAxis){for(o=0;o<u.chart.xAxis.length;o++)u.chart.xAxis[o].setExtremes();var c=u.chart.get("highcharts-navigator-series");c&&c.setData(d.chartConfig.series[0].data)}u.initFormatForSeries(e)},this.requestData()}}]),angular.module("widgets").factory("HiLowChart",["BaseChart","Utils",function(t,o){return function(n){t.apply(this,[n]);var l=this;this.parseData=function(e){var t;for(n.chartConfig.xAxis.categories=[],t=0;t<e.Cols[1].tuples.length;t++)n.chartConfig.xAxis.categories.push(e.Cols[1].tuples[t].caption.toString());n.chartConfig.series=[];var o=[];if(e.Cols[0].tuples[0].children)l.showError("Data converter for this hi-low chart not implemented!");else{for(o=[],t=0;t<e.Cols[1].tuples.length;t++)o.push({q1:e.Data[2*t],q3:e.Data[2*t+1],low:e.Data[2*t],high:e.Data[2*t+1],cube:e.Info.cubeName,path:e.Cols[1].tuples[t].path});var r="",i="",s="",a="";e.Cols[0].tuples[0]&&(r=e.Cols[0].tuples[0].caption,s=e.Cols[0].tuples[0].format),e.Cols[0].tuples[1]&&(i=e.Cols[0].tuples[1].caption,a=e.Cols[0].tuples[1].format),l.addSeries({data:o,caption1:r,caption2:i,format1:s,format2:a})}},this.setType("boxplot"),this.requestData();var e={series:{fillColor:"#dddddF"},plotOptions:{boxplot:{fillColor:"#fafafF",whiskerLength:0,colorByPoint:!0,lineWidth:3,stemWidth:0}},tooltip:{formatter:function(){var e=this.series.userOptions.caption1||"Minimum",t=this.series.userOptions.caption2||"Maximum",o=this.series.userOptions.format1,r=this.series.userOptions.format2,i=this.point.low,s=this.point.high;return o&&(i=numeral(i).format(o)),r&&(s=numeral(s).format(r)),this.key+"<br/>"+t+":<b>"+s+"</b><br/>"+e+":<b>"+i+"</b>"}}};o.merge(n.chartConfig.options,e)}}]),angular.module("widgets").factory("TreeMapChart",["BaseChart","Utils",function(t,o){return function(a){t.apply(this,[a]);var n=this;this.setType("treemap"),this.parseData=function(e){var t;a.chartConfig.series=[];var o=[];if(!e.Cols[0].tuples.length)return;if(e.Cols[0].tuples[0].children)console.error("Data converter for this treemap chart not implemented!");else{o=[];var r=0;for(t=0;t<e.Data.length;t++)r+=parseFloat(e.Data[t]);for(t=0;t<e.Cols[1].tuples.length;t++)o.push({caption:e.Cols[1].tuples[t].caption,id:e.Cols[1].tuples[t].caption+"<br>"+parseFloat(parseFloat(e.Data[t])/r*100).toFixed(2).toString()+"%",value:parseFloat(e.Data[t]),path:e.Cols[1].tuples[t].path,name:e.Cols[1].tuples[t].caption});var i="",s="";e.Cols[0].tuples[0]&&(i=e.Cols[0].tuples[0].caption,s=e.Cols[0].tuples[0].format),n.totalSum=e.Data.map(function(e){return parseFloat(e)||0}).reduce(function(e,t){return e+t},0),n.addSeries({data:o,layoutAlgorithm:"squarified",caption:i,format:s,dataLabels:{enabled:!0}})}},this.requestData(),this.isPercent=!0,this.totalSum=0,this.desc.overrides&&this.desc.overrides[0]&&0===this.desc.overrides[0].showPercentage&&(this.isPercent=!1),this.hasOption("isLegend")&&(this.isPercent=a.item.isLegend);var e={legend:{enabled:!0},plotOptions:{treemap:{colorByPoint:!0,dataLabels:{enabled:!0,formatter:function(){if(n.isPercent&&n.totalSum){var e=(this.point.value/n.totalSum*100).toFixed(2);return this.point.caption+" - "+e+"%"}return""+this.point.caption}}}},tooltip:{formatter:function(){var e=this.series.userOptions.caption,t=this.series.userOptions.format,o=this.point.value;return t&&(o=numeral(o).format(t)),this.point.caption+"<br>"+e+": <b>"+o+"</b>"}}};o.merge(a.chartConfig.options,e),delete a.chartConfig.options.plotOptions.series.dataLabels,a.item.toggleLegend=function(){n.toggleButton("isLegend"),n.isPercent=a.item.isLegend,n.requestData()}}}]),angular.module("widgets").factory("BubbleChart",["BaseChart","Utils",function(t,o){return function(g){t.apply(this,[g]);var f=this;this.thirdTitle="",this.setType("bubble"),this.parseData=function(e){!function(e){var t={};if(4==e.Cols[0].tuples.length)for(var o=3;o<e.Data.length;o+=4)t[e.Data[o]]=!0;Object.keys(t)}(e);g.chartConfig.series=[],1<=e.Cols[0].tuples.length&&(g.chartConfig.xAxis.title.text=e.Cols[0].tuples[0].caption);2<=e.Cols[0].tuples.length&&(g.chartConfig.yAxis.title.text=e.Cols[0].tuples[1].caption);3<=e.Cols[0].tuples.length&&(f.thirdTitle=e.Cols[0].tuples[2].caption);if(e.Cols[0].tuples[0].children)f.showError("Data converter for this bubble chart not implemented!");else{var t=e.Cols[0].tuples.length,o="",r="",i="";e.Cols[0].tuples[0]&&(o=e.Cols[0].tuples[0].format),e.Cols[0].tuples[1]&&(r=e.Cols[0].tuples[1].format),e.Cols[0].tuples[2]&&(i=e.Cols[0].tuples[2].format);var s={},a=!1;if(f.hasOption("isTop")){a=!0;var n=(f.desc.controls||[]).filter(function(e){return"setRowCount"===e.action})[0],l=n&&n.value||20}var c=a?l:e.Data.length;c>e.Data.length&&(c=e.Data.length);for(var d=0;d<c;d+=t){var u=e.Cols[1].tuples[Math.floor(d/t)].caption;s[u]||(s[u]=[]);var h={};h.x=e.Data[d],h.y=e.Data[d+1],h.z=e.Data[d+2],s[u].push(h)}for(var p in s)f.addSeries({data:s[p],name:p,format1:o,format2:r,format3:i})}},this.requestData();var e={plotOptions:{bubble:{minSize:"5%",maxSize:"35%",sizeBy:"width"},series:{cursor:null,point:{events:{click:null}}}},chart:{zoomType:"xy"},legend:{enabled:!0},xAxis:{tickWidth:10},tooltip:{formatter:function(){var e=this.series.userOptions.format1,t=this.series.userOptions.format2,o=this.series.userOptions.format3,r=this.x,i=this.y,s=this.point.z;e&&(r=numeral(r).format(e)),t&&(i=numeral(i).format(t)),o&&(s=numeral(s).format(o));var a=f.thirdTitle||"radius";return this.series.name+"<br/>"+g.chartConfig.xAxis.title.text+":<b>"+r+"</b><br/>"+g.chartConfig.yAxis.title.text+":<b>"+i+"</b>"+(s?"<br>"+a+": <b>"+s.toString()+"</b>":"")}}};o.merge(g.chartConfig.options,e)}}]),angular.module("widgets").factory("BullseyeChart",["BaseChart","Utils",function(e,t){return function(i){e.apply(this,[i]);var s=this;this.setType("pie"),t.merge(i.chartConfig.options,{plotOptions:{series:{cursor:null,point:{events:{click:null}}},pie:{allowPointSelect:!1,dataLabels:{enabled:!0,color:"#000000",connectorColor:"#000000",formatter:function(){return"<b>"+this.point.name+"</b>: "+this.series.options.size}}}},tooltip:{formatter:function(){return this.key+": <b>"+this.y+"</b><br/>"}}}),this.parseData=function(e){var t=[];i.chartConfig.series=[];for(var o=Math.max.apply(null,e.Data),r=0;r<e.Cols[1].tuples.length;r++)t.push([e.Cols[1].tuples[r].caption,e.Data[r]]),s.addSeries({innerSize:"0%",size:Math.floor(e.Data[r]/o*100).toString()+"%",data:[[e.Cols[1].tuples[r].caption,e.Data[r]]],borderWidth:2})},this.requestData()}}]),angular.module("widgets").factory("SpeedometerChart",["BaseChart","Utils",function(t,o){return function(i){t.apply(this,[i]);var s=this;this.parseData=function(e){var t=0;1<e.Cols[0].tuples.length&&(t=1);var o=e.Data[t];o=o||0;if(i.chartConfig.series=[],i.chartConfig.yAxis.title={text:e.Cols[0].tuples[t].caption},0===parseInt(o))i.chartConfig.yAxis.min=0,i.chartConfig.yAxis.max=10;else{var r=(o=parseInt(o)).toString().length;i.chartConfig.yAxis.max=Math.pow(10,r),i.chartConfig.yAxis.min=0}s.addSeries({data:[e.Data[t]||0],name:e.Cols[0].tuples[t].caption,format:e.Cols[0].tuples[t].format||""})},this.setType("gauge");var e={tooltip:{enabled:!1},chart:{plotBackgroundColor:null,plotBackgroundImage:null,plotBorderWidth:0,plotShadow:!1},plotOptions:{series:{dataLabels:{formatter:function(){var e=this.point.y,t=this.series.userOptions.format;return t&&(e=numeral(e).format(t)),e}}}},pane:{startAngle:-150,endAngle:150,background:[{backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#FFF"],[1,"#333"]]},borderWidth:0,outerRadius:"109%"},{backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#333"],[1,"#FFF"]]},borderWidth:1,outerRadius:"107%"},{},{backgroundColor:"#DDD",borderWidth:0,outerRadius:"105%",innerRadius:"103%"}]}};o.merge(i.chartConfig.options,e),i.chartConfig.yAxis={minorTickInterval:"auto",minorTickWidth:1,minorTickLength:10,minorTickPosition:"inside",minorTickColor:"#666",tickWidth:2,tickPosition:"inside",tickLength:10,tickColor:"#666"},this.requestData()}}]),angular.module("widgets").factory("FuelGaugeChart",["BaseChart","Utils",function(t,o){return function(i){t.apply(this,[i]);var s=this;this.parseData=function(e){var t=0;1<e.Cols[0].tuples.length&&(t=1);var o=e.Data[t];o=o||0;if(i.chartConfig.series=[],i.chartConfig.yAxis.title={text:e.Cols[0].tuples[t].caption},0===parseInt(o))i.chartConfig.yAxis.min=0,i.chartConfig.yAxis.max=10;else{var r=(o=parseInt(o)).toString().length;i.chartConfig.yAxis.max=Math.pow(10,r),i.chartConfig.yAxis.min=0}s.addSeries({data:[e.Data[t]||0],name:e.Cols[0].tuples[t].caption,dataLabels:{enabled:!1},format:e.Cols[0].tuples[t].format||""})},this.setType("gauge");var e={pane:[{startAngle:-45,endAngle:45,background:null,center:["50%","90%"],size:300}],plotOptions:{gauge:{dial:{baseLength:"0%",baseWidth:5,radius:"110%"}}},tooltip:{formatter:function(){var e=this.point.y,t=this.series.userOptions.format;return t&&(e=numeral(e).format(t)),e}}};o.merge(i.chartConfig.options,e),i.chartConfig.yAxis={minorTickPosition:"outside",tickPosition:"outside",labels:{rotation:"auto",distance:20}},this.requestData()}}]),angular.module("widgets").factory("PivotWidget",function(){return function(t){var m=this;this.lpt=void 0,this.onInit=function(e){m.lpt=e},this.requestData=function(){if(m.lpt){var e=m.getMDX();if(m.lpt.isListing()&&(delete m.lpt.CONFIG.initialData,"drillthrough"!==e.toLowerCase().substr(0,12)&&(e=m.getDrillthroughMdx(e))),""===e)return;m.drillFilter&&(e=e+" %FILTER "+m.drillFilter),m.broadcastDependents(),m.lpt.getActualMDX()!=e&&m.lpt.changeBasicMDX(e)}},this.onResize=function(){m.lpt&&m.lpt.updateSizes()},this._oldMdx="",t.item.pivotMdx||(t.item.pivotMdx=m.getMDX()),t.$on("print:"+t.item.$$hashKey,function(){if(!m.lpt)return;var e=m.lpt.CONFIG.container,t=$(e).find(".lpt-topHeader > table"),o=$(e).find(".lpt-leftHeader > table"),r=$(e).find(".lpt-tableBlock > table");if(!(t.length&&o.length&&r.length))return;var i={body:[]},s=$(t[0]).find("tr"),a=$(o[0]).find("tr:eq(0) th").length,n=[],l={text:$(e).find(".lpt-headerValue").text(),rowSpan:s.length,colSpan:a};n.push(l);for(var c=0;c<s.length;c++){for(var d=$(s[c]).find("th"),u=0;u<d.length;u++){var h=$(d[u]),p=h.attr("rowspan")||1,g=h.attr("colspan")||1;l={text:h.text(),rowSpan:p,colSpan:g},n.push(l)}i.body.push(n),n=[]}var f=[{table:i}];pdfMake.createPdf({content:f}).open()}),t.item.onDrillDown=function(e){e.path?(m.doDrillFilter(e.path,m.drills),m.drills.push({path:e.path,name:"",category:""}),t.item.backButton=!0):(m.drills.pop(),m.doDrillFilter(e.path,m.drills));m.broadcastDependents(e.mdx)},t.item.onDrillThrough=function(){return!!m.canDoDrillthrough&&(m._oldMdx=m.lpt.getActualMDX(),t.item.backButton=!0)},t.item.drillUp=function(){t.item.isDrillthrough&&m.restoreWidgetType?(t.item.isDrillthrough=null,m.restoreWidgetType()):m.lpt.CONTROLS.back();t.item.backButton=0!==m.lpt.DRILL_LEVEL}}}),angular.module("widgets").factory("TextWidget",["CONST","Storage",function(f,e){return function(h){var p=this;function g(e){if(p.desc.dataProperties)for(var t=0;t<p.desc.dataProperties.length-1;t++)if(p.desc.dataProperties[t].dataValue===e)return p.desc.dataProperties[t]}h.model.textData=[],e.getAppSettings(),this._retrieveData=function(e){if(h.model.textData=[],e)for(var t=0;t<e.Cols[0].tuples.length;t++){var o="";p.desc&&p.desc.properties&&p.desc.properties.format&&(o=p.desc.properties.format);var r=e.Data[t],i=e.Cols[0].tuples[t].format||o;i&&(r=numeral(r).format(i));var s="#000";p.desc.tile&&(s=$("."+f.fontColors[p.desc.tile.fontColor]).css("color"));var a=e.Cols[0].tuples[t].caption,n=g(e.Cols[0].tuples[t].dimension);if(n&&(a="$auto"===n.label?n.dataValue||a:n.label||a),"delta"===a.substr(0,5).toLowerCase()){var l=parseInt(a.substring(5,a.length))-1;!isNaN(l)&&h.model.textData[l]&&"0"!==r.toString()&&("-"!==r.toString()[0]?h.model.textData[l].delta="+"+r.toString():h.model.textData[l].deltaNeg=r.toString())}else{var c=s;if(n){var d=n.thresholdLower,u=n.thresholdUpper;void 0!==d&&""!==d&&p.desc.properties.lowRangeColor&&parseFloat(r)<d&&(c=p.desc.properties.lowRangeColor),void 0!==u&&""!==u&&p.desc.properties.highRangeColor&&parseFloat(r)>u&&(c=p.desc.properties.highRangeColor)}h.model.textData.push({label:a,value:r,color:s,valueColor:c})}}},this.requestData()}}]),function(){function MapWidgetFact(Storage,CONST,$timeout,Connector){function MapWidget($scope){var _this=this;this.CLUSTER_RANGE=1,this.map=null,this.markers=null,this.polys=null,this.iconStyle=null,this.popup=null,this.isRGBColor=!1,this._selectedFeature=null,_this.featureOverlay=null,$scope.model.tooltip={visible:!1,content:""},this.onInit=onInit,this.onResize=onResize,this._retrieveData=retrieveData,this.requestData(),_this.mapData=null,$scope.item.drillUp=doDrillUp,$scope.model.tooltip.name="",$scope.model.tooltip.items=[],$scope.item.displayAsPivot=displayAsPivot,$scope.item.isMap=!0;var polys=null;function doDrillUp(){hideTooltip(),_this.doDrill()}function displayAsPivot(e){hideTooltip(),$scope.rejectTooltipCreation(),"pivot"===_this.desc.type?($scope.item.isDrillthrough=null,_this.restoreWidgetType()):($scope.item.pivotMdx=e||_this.getMDX(),_this.changeWidgetType("pivot"))}function requestPolygons(){var e=_this.desc.name+".js";_this.desc.properties&&_this.desc.properties.coordsJsFile&&(e=_this.desc.properties.coordsJsFile);var t=(Storage.serverSettings.DefaultApp||"/csp")+"/"+e;"localhost"===window.location.host.split(":")[0].toLowerCase()?t=localStorage.connectorRedirect.split("/").slice(0,-2).join("/")+t:dsw.mobile?t=localStorage.connectorRedirect.split("/").slice(0,-2).join("/")+t:localStorage.connectorRedirect&&(t="map.js"),Connector.getFile(t).then(onPolyFileLoaded)}function onPolyFileLoaded(result){polys={},result="("+result+")(polys)",eval(result),buildPolygons()}function colorGradient(e,t,o,r){var i=t,s=o,a=e;r&&1<=(a*=2)&&(a-=1,i=o,s=r);var n=s.red-i.red,l=s.green-i.green,c=s.blue-i.blue;return"rgb("+parseInt(Math.floor(i.red+n*a),10)+","+parseInt(Math.floor(i.green+l*a),10)+","+parseInt(Math.floor(i.blue+c*a),10)+")"}function getFeatureColor(name,value){var item=_this.mapData.Cols[1].tuples.filter(function(e){return e.caption===name});if(0!==item.length){var parts;item=item[0];var idx=_this.mapData.Cols[1].tuples.indexOf(item),l=_this.mapData.Cols[0].tuples.length,colorProp="ColorExplicitValue",color;if(_this.desc.properties&&void 0!==_this.desc.properties.colorProperty&&(colorProp=_this.desc.properties.colorProperty),color=isNaN(parseInt(colorProp))?_this.mapData.Cols[0].tuples.filter(function(e){return e.caption===colorProp}):_this.mapData.Cols[0].tuples.slice(colorProp,1),0!==color.length){color=color[0];var colorIdx=_this.mapData.Cols[0].tuples.indexOf(color),col=_this.mapData.Data[idx*l+colorIdx];return-1===col.indexOf("rgba")&&(col=col.replace("rgb","rgba"),col=col.substr(0,col.length-1)+", 0)"),parts=col.split(","),parts[3]="0.4)",parts.join(",")}var f="hsl((255-x)/255 * 120, 100%, 50%)";_this.isRGBColor&&(f="rgb(x, 255-x, 0)"),_this.desc.properties&&_this.desc.properties.colorFormula&&(f=_this.desc.properties.colorFormula);var fidx=f.indexOf("("),firstPart=f.substring(0,fidx).toLowerCase();f=f.substring(fidx+1,f.length-1),parts=f.split(",");for(var x=value||0,tmp,i=0;i<parts.length;i++)-1!==parts[i].indexOf("x")&&(parts[i]=parts[i].replace(/x/g,x.toString()),eval("tmp = "+parts[i]+";"),255<tmp&&(tmp=255),tmp<0&&(tmp=0),parts[i]=Math.floor(tmp).toString());return firstPart+"a("+parts.join(",")+", 0.65)"}}function centerView(e,t){var o,r,i;if(_this.desc.properties&&(o=parseFloat(_this.desc.properties.latitude),r=parseFloat(_this.desc.properties.longitude),i=parseFloat(_this.desc.properties.zoom)),0!==_this.drills.length||isNaN(o)||isNaN(r)||isNaN(i)||void 0===o||void 0===r||void 0===i){if(Math.abs(e[0]-t[0])<1e-8&&Math.abs(e[1]-t[1])<1e-8)return;var s=ol.proj.transform([e[0],e[1]],"EPSG:4326","EPSG:900913"),a=ol.proj.transform([t[0],t[1]],"EPSG:4326","EPSG:900913");_this.map.getView().fit([s[0],s[1],a[0],a[1]],_this.map.getSize())}else _this.map.getView().setCenter(ol.proj.transform([r,o],"EPSG:4326","EPSG:900913")),_this.map.getView().setZoom(i)}function buildPolygons(){var e,t,o,r,i,s,a,n,l,c;_this.isRGBColor=!1;var d="ColorHSLValue";_this.desc.properties&&_this.desc.properties.colorClientProperty&&(d=_this.desc.properties.colorClientProperty);var u="CoordKeyValue";if(_this.desc.properties&&_this.desc.properties.coordsProperty&&(u=_this.desc.properties.coordsProperty),polys&&_this.map&&_this.mapData){var h=[];i=_this.mapData.Cols[0].tuples.length;var p=Number.MAX_VALUE,g=Number.MIN_VALUE,f=0;for(isNaN(parseInt(d))?(c=_this.mapData.Cols[0].tuples.filter(function(e){return e.caption===d}),-1===(f=_this.mapData.Cols[0].tuples.indexOf(c[0]))&&(_this.isRGBColor=!0,d="ColorRGBValue",c=_this.mapData.Cols[0].tuples.filter(function(e){return e.caption===d}),f=_this.mapData.Cols[0].tuples.indexOf(c[0]))):f=parseInt(_this.desc.properties.colorProperty)||0,s=0;s<_this.mapData.Cols[1].tuples.length;s++)(a=_this.mapData.Data[s*i+f])<p&&(p=a),g<a&&(g=a);var m=[99999999,99999999],v=[-99999999,-99999999];for(l=-1,0===(c=_this.mapData.Cols[0].tuples.filter(function(e){return e.caption===u})).length&&(c=_this.mapData.Cols[0].tuples.filter(function(e){return"Key"===e.caption})),0!==c.length&&(l=_this.mapData.Cols[0].tuples.indexOf(c[0])),s=0;s<_this.mapData.Cols[1].tuples.length;s++){var C=_this.mapData.Cols[1].tuples[s].caption,b=C;if(-1!==l&&(b=_this.mapData.Data[s*i+l]),polys[b]){n=polys[b].split(";");var w=[];for(0,r=0;r<n.length;r++)if(n[r]){var y=n[r].split(" "),S=[];for(o in y)if(y[o]){var D=y[o].split(",");if(!(D.length<2))if(e=parseFloat(D[0]),t=parseFloat(D[1]),isNaN(e)||isNaN(t))console.warn("Wrong poly coordinates: ",y[o]);else{var x=new ol.geom.Point([e,t]);x.transform("EPSG:4326","EPSG:3857");var F=e;F<0&&(F+=360),parseFloat(F)<m[0]&&(m[0]=parseFloat(F)),parseFloat(t)<m[1]&&(m[1]=parseFloat(t)),parseFloat(F)>v[0]&&(v[0]=parseFloat(F)),parseFloat(t)>v[1]&&(v[1]=parseFloat(t)),S.push(x.getCoordinates())}}if(w.push(S),300<w.length){var L=[];for(o=0;o<w.length;o+=2)L.push(w[o]);w=L}}var O=C;if(_this.desc.properties&&_this.desc.properties.polygonTitleProperty){var T=_this.mapData.Cols[0].tuples.filter(function(e){return e.caption===(_this.desc.properties.polygonTitleProperty||"Name")});if(0!==T.length){var I=_this.mapData.Cols[0].tuples.indexOf(T[0]);-1!==I&&(O=_this.mapData.Data[s*i+I])}}var N=new ol.Feature({geometry:new ol.geom.Polygon(w),key:C,title:O,dataIdx:s*i,path:_this.mapData.Cols[1].tuples[s].path,desc:_this.mapData.Cols[1].tuples[s].title});a=_this.mapData.Data[s*i+f],N.setStyle(new ol.style.Style({zIndex:0,fill:new ol.style.Fill({color:getFeatureColor(C,255*(a-p)/(g-p))||"none"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.3)",width:1})})),h.push(N)}}_this.featureOverlay.getSource().clear(),_this.polys.clear(),_this.polys.addFeatures(h),centerView(m,v)}}function retrieveData(e){hideTooltip(),_this.markers.clear(),_this.mapData=e,buildPolygons();var t=[Number.MAX_VALUE,Number.MAX_VALUE],o=[Number.MIN_VALUE,Number.MIN_VALUE];if(e&&_this.map){var r=e.Cols[0].tuples.length,i=0,s=[],a="latitude";_this.desc.properties&&_this.desc.properties.latitudeProperty&&(a=_this.desc.properties.latitudeProperty);var n="longitude";_this.desc.properties&&_this.desc.properties.longitudeProperty&&(n=_this.desc.properties.longitudeProperty);var l=-1,c=-1,d=e.Cols[0].tuples.filter(function(e){return e.caption.toLowerCase()===a});if(0!==d.length&&(c=e.Cols[0].tuples.indexOf(d[0])),0!==(d=e.Cols[0].tuples.filter(function(e){return e.caption.toLowerCase()===n})).length&&(l=e.Cols[0].tuples.indexOf(d[0])),-1===c||-1===l)return;for(var u=0;u<e.Cols[1].tuples.length;u++)if(""!==e.Data[i+l]&&void 0!==e.Data[i+l]&&""!==e.Data[i+c]&&void 0!==e.Data[i+c]){var h=parseFloat(e.Data[i+l]||0),p=parseFloat(e.Data[i+c]||0),g=e.Cols[1].tuples[u].caption,f=new ol.geom.Point([h,p]);f.transform("EPSG:4326","EPSG:900913");for(var m=[],v=[],C=2;C<e.Cols[0].tuples.length;C++)m.push(e.Cols[0].tuples[C].caption),v.push(e.Data[i+C]);var b=new ol.Feature({geometry:f,name:g,labels:m,values:v,dataIdx:i,path:e.Cols[1].tuples[u].path,desc:e.Cols[1].tuples[u].title});parseFloat(p)<t[1]&&(t[1]=parseFloat(p)),parseFloat(h)<t[0]&&(t[0]=parseFloat(h)),parseFloat(p)>o[1]&&(o[1]=parseFloat(p)),parseFloat(h)>o[0]&&(o[0]=parseFloat(h)),t[0]==o[0]&&(t[0]-=.25,o[0]+=.25),t[1]==o[1]&&(t[1]-=.25,o[1]+=.25),s.push(b),i+=r}0!==s.length&&(_this.markers.addFeatures(s),centerView(t,o))}}function onInit(e){_this.map=e,$timeout(onResize,0),_this.iconStyle=new ol.style.Style({zIndex:100,image:new ol.style.Icon({anchor:[.5,40],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:1,src:"img/map-marker-red.png"})}),_this.polyStyle=new ol.style.Style({zIndex:0,stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.5)",width:1})}),_this.hoverStyle=new ol.style.Style({zIndex:1,stroke:new ol.style.Stroke({color:"blue",width:2})}),_this.polys=new ol.source.Vector({features:[]});var t=new ol.layer.Vector({source:_this.polys,style:_this.polyStyle});t.setZIndex(1),_this.map.addLayer(t),_this.markers=new ol.source.Vector({features:[]});var o=new ol.Collection;_this.featureOverlay=new ol.layer.Vector({map:e,source:new ol.source.Vector({features:o,useSpatialIndex:!1}),style:_this.hoverStyle,updateWhileAnimating:!0,updateWhileInteracting:!0}),_this.featureOverlay.setZIndex(10),_this.featureOverlay.setMap(_this.map),(t=new ol.layer.Vector({source:_this.markers,style:_this.iconStyle})).setZIndex(100),_this.map.addLayer(t),_this.popup=new ol.Overlay({element:$scope.popupElement,positioning:"bottom-center",offset:[0,-40],stopEvent:!1}),_this.map.addOverlay(_this.popup),_this.map.on("click",onMapClick),_this.map.on("pointermove",onPointerMove)}function onPointerMove(e){if(!dsw.mobile||!evt.originalEvent.touches||1===e.originalEvent.touches.length){$scope.hideTooltip();var t=_this.map.forEachFeatureAtPixel(e.pixel,function(e,t){return e});if(t){var o,r=t.get("dataIdx"),i="TooltipValue";_this.desc.properties&&_this.desc.properties.markerTitleProperty&&(i=_this.desc.properties.markerTitleProperty),!(o=_this.getDataByColumnName(_this.mapData,i||"Name",r))&&_this.desc.properties.polygonTitleProperty&&t.get("title")&&(o=t.get("title")),(o=(o=o||_this.getDataByColumnName(_this.mapData,"Name",r))||(_this.mapData.Cols[1].tuples[Math.floor(r/_this.mapData.Cols[0].tuples.length)].caption||""))&&$scope.showTooltip(o,e.originalEvent.pageX,e.originalEvent.pageY)}if(e.dragging)hideTooltip();else{var s=_this.map.getEventPixel(e.originalEvent),a=_this.map.hasFeatureAtPixel(s);_this.map.getTarget().style.cursor=a?"pointer":"",_this.featureOverlay.getSource().clear(),t&&_this.featureOverlay.getSource().addFeature(t)}}}function getTooltipData(t){if(_this.mapData){var e=[],o=_this.mapData.Cols[1].tuples.filter(function(e){return e.caption===t});if(0!==o.length){o=o[0];var r=_this.mapData.Cols[1].tuples.indexOf(o),i=_this.mapData.Cols[0].tuples.length,s=_this.mapData.Cols[0].tuples.filter(function(e){return"tooltip"===e.caption});if(0!==s.length){s=s[0];var a=_this.mapData.Cols[0].tuples.indexOf(s);return e.push({label:"",value:_this.mapData.Data[r*i+a].split(":")[1]||""}),e}}}}function onMapClick(a){if(!dsw.mobile||!a.originalEvent.touches||1===a.originalEvent.touches.length){var e=_this.map.forEachFeatureAtPixel(a.pixel,function(e,t){return e});if(e){if(hideTooltip(),dsw.mobile&&_this._selectedFeature!==e)return _this._selectedFeature=e,void onPointerMove(a);_this.doDrill(e.get("path"),e.get("name")||e.get("title"),void 0,function(){!function(e){var t,o,r=e.get("dataIdx"),i="PopupValue";_this.desc.properties&&_this.desc.properties.markerPopupContentProperty&&(i=_this.desc.properties.markerPopupContentProperty);t=i?_this.getDataByColumnName(_this.mapData,i,r):_this.mapData.Cols[1].tuples[Math.floor(r/_this.mapData.Cols[0].tuples.length)].caption||_this.mapData.Cols[1].tuples[Math.floor(r/_this.mapData.Cols[0].tuples.length)].desc||"";t=t||_this.getDataByColumnName(_this.mapData,"Name",r);if(!t)return;if($scope.model.tooltip.content=t,"polygon"===e.getGeometry().getType().toLowerCase())a.pixel[1]+=30,o=_this.map.getCoordinateFromPixel(a.pixel);else{var s=e.getGeometry();(o=s.getCoordinates())[0]+=20037508.34*Math.floor(_this.map.getCoordinateFromPixel(a.pixel)[0]/40075016.68+.5)*2}_this.popup.setPosition(o),$scope.showPopup()}(e)})}else hideTooltip();$scope.$apply()}}function hideTooltip(){$scope.hidePopup()}function onResize(){_this.map&&_this.map.updateSize()}requestPolygons()}return MapWidget}angular.module("widgets").factory("MapWidget",["Storage","CONST","$timeout","Connector",MapWidgetFact])}(),angular.module("app").directive("mapWidget",["$templateCache","$compile","Storage",function(e,t,l){return{template:function(e,t){return"<div style='visibility: hidden'><div class='panel panel-default map-popup'><div ng-bind-html='model.tooltip.content | sanitize'></div></div><div class='arrow_box'></div></div>"},link:function(r,e,t){e.removeAttr("map-widget"),r.popupElement=e.children()[0];var o=$("<div class='map-tooltip'>fff</div>");o.hide().appendTo("body"),r.tooltip=o;var i,s=l.getAppSettings();i=s.tileServer?new ol.source.XYZ({url:s.tileServer}):new ol.source.OSM({wrapX:!0});var a=new ol.Map({layers:[new ol.layer.Tile({source:i})],controls:ol.control.defaults({attributionOptions:{collapsible:!1}}),target:e[0],view:new ol.View({center:[0,0],zoom:2})});a.getViewport().addEventListener("mouseout",function(e){r.hideTooltip()},!1);var n=null;r.hideTooltip=function(){n&&clearTimeout(n),r.tooltip.hide()},r.rejectTooltipCreation=function(){clearTimeout(n)},r.showTooltip=function(e,t,o){n&&clearTimeout(n),n=setTimeout(function(){r.tooltip.text(e).css("left",t.toString()+"px").css("top",o.toString()+"px").show()},600)},r.showPopup=function(){var e=$(r.popupElement);e.css("visibility","hidden"),setTimeout(function(){e.css("visibility","visible"),a.render()},0)},r.hidePopup=function(){$(r.popupElement).css("visibility","hidden")},r.onInit&&r.onInit(a),r.$on("$destroy",function(){r.tooltip.remove(),r.tooltip=null})}}}]),angular.module("app").directive("textWidget",["$parse","$compile","Lang","Connector",function(e,r,t,o){return{link:function(e,t,o){t.removeAttr("text-widget"),t[0].innerHTML="<div resize-after-render ng-repeat='item in model.textData' style='display: none; height: {{(100 / (model.textData.length || 1))}}%' class='text-widget-item'><div class='text-widget-label' style='top: {{100 / (model.textData.length || 1) * $index}}%; color: {{item.color}}'>{{item.label}}</div><svg class='text-widget'><text style='fill: {{item.valueColor}}'>{{item.value}}<tspan style='font-size: 4px;fill:red'>{{item.deltaNeg}}</tspan><tspan style='font-size: 4px;fill:green'>{{item.delta}}</tspan></text></svg></div>",r(t)(e)}}}]).directive("resizeAfterRender",["$timeout",function(t){return{restrict:"A",link:function(s,a,e){s.$last&&!0===s.$last&&t(function(e){for(var t=a[0].parentNode.children,o=0;o<t.length;o++){t[o].style.display="";var r=t[o].children[1],i=r.firstChild.getBBox();r.setAttribute("viewBox",[i.x,i.y,i.width,i.height].join(" "))}s.model.rendered=!0},0,!1,a)}}}]),function(){var O="DSW.Addons.";angular.module("widgets").service("TypeMap",["CONST","AreaChart","BarChart","LineChart","ColumnChart","PieChart","XyChart","TimeChart","PivotWidget","TextWidget","HiLowChart","TreeMapChart","BubbleChart","BullseyeChart","SpeedometerChart","FuelGaugeChart","EmptyWidget","BarChartPercent","MapWidget","Storage","$injector","$rootScope",function(e,t,o,r,i,s,a,n,l,c,d,u,h,p,g,f,m,v,C,b,w,y){var S={fuelgauge:{class:f,type:"chart"},bullseyechart:{class:p,type:"chart"},speedometer:{class:g,type:"chart"},bubblechart:{class:h,type:"chart"},treemapchart:{class:u,type:"chart"},hilowchart:{class:d,type:"chart"},piechart3d:{class:s,type:"chart"},donutchart3d:{class:s,type:"chart"},donutchart:{class:s,type:"chart"},piechart:{class:s,type:"chart"},areachart:{class:t,type:"chart"},barchart:{class:o,type:"chart"},"isc.kkbanalitics.portlets.stacionarkkbportlet":{class:v,type:"chart"},barchartstacked:{class:o,type:"chart"},linechart:{class:r,type:"chart"},linechartmarkers:{class:r,type:"chart"},combochart:{class:r,type:"chart"},columnchart:{class:i,type:"chart"},columnchartstacked:{class:i,type:"chart"},xychart:{class:a,type:"chart"},timechart:{class:n,type:"chart"},pivot:{class:l,type:"pivot"},"deepsee.lightpivottable":{class:l,type:"pivot"},textmeter:{class:c,type:"text"},map:{class:C,type:"map"},"deepsee.enhancedmapportlet":{class:C,type:"map"},"rf.mapportlet":{class:C,type:"map"}};S[e.emptyWidgetClass]={class:m,type:"empty"},this.register=function(e,t,o,r){S[e]={class:o,type:t,addonInfo:r}},this.getClass=function(e){if(S[e.toLowerCase()])return S[e.toLowerCase()].class},this.getDesc=function(e){return S[e.toLowerCase()]},this.getType=function(e){if(S[e.toLowerCase()])return S[e.toLowerCase()].type};var D,x=this,F=dsw.addons;if(F){if(F&&F.length)for(var L=0;L<F.length;L++){D=F[L].split("/").pop(),D=O+D;try{this.register(D.toLowerCase(),w.get(D).type||"custom",w.get(D),w.get(D))}catch(e){console.error("Can't register addon: "+D+". Be aware that all names is case sensitive!")}}}else y.$on("addons:loaded",function(e){if(e&&e.length)for(var t=0;t<e.length;t++){D=e[t].split("/").pop(),D=O+D.split(".").slice(0,-1);try{x.register(D.toLowerCase(),w.get(D).type||"custom",w.get(D),w.get(D))}catch(e){console.error("Can't register addon: "+D+". Be aware that all names is case sensitive!")}}})}])}(),angular.module("widgets").controller("widget",["$scope","Lang","TypeMap","gridsterConfig","ngDialog","Filters","BaseWidget","Storage","Connector",function(n,e,t,s,l,c,o,a,d){var u=this;this._applyFilter=function(){u.updateFiltersText(),u.requestData()},o.apply(this,[n]),n.model={error:"",filters:c.getWidgetModelFilters(this.desc.name)},u.updateFiltersText();var r=t.getClass(u.desc.type);r?r.apply(this,[n]):(u.supported=!1,u.showError(e.get("errWidgetNotSupported")+": "+u.desc.type)),0!==n.model.filters.length||this.hasDatasourceChoser||this.hasActions||n.item.pvItems.length||this.hideToolbar(),n.onInit=this.onInit,n.requestData=this.requestData,n.toggleFilter=function(e,t){var o=c.getFilter(e);if(!o)return;var r="INPUT"===t.currentTarget.tagName.toUpperCase()?t.currentTarget.nextElementSibling.offsetParent:t.currentTarget.offsetParent.offsetParent;if(r){var i=r.getBoundingClientRect();m(".ngdialog.ngdialog-theme-plain .ngdialog-content","margin-left",i.left+"px"),dsw.mobile?(m(".ngdialog.ngdialog-theme-plain .ngdialog-content","margin-top","0px"),m(".ngdialog.ngdialog-theme-plain .ngdialog-content","margin-left","0px"),m(".ngdialog.ngdialog-theme-plain .ngdialog-content","width",window.innerWidth+"px"),m(".ngdialog.ngdialog-theme-plain .ngdialog-content","height","100%")):m(".ngdialog.ngdialog-theme-plain .ngdialog-content","margin-top",i.top+16+"px")}var s="ngdialog-theme-plain";dsw.mobile&&(s+=" ngdialog-mobile");l.open({template:"src/views/filter.html",data:{filter:o,dataSource:u.desc.dataSource,widget:u},controller:"filter",showClose:!1,className:s})},n.$on("refresh-all",function(){u.requestData()}),n.$on("refresh:"+n.item.$$hashKey,function(){u.requestData()});var i=n.$on("filter"+u.desc.name,f),h=n.$on("filterAll",f);function p(e,t){var o=n.item[t];return o&&(e+="&"+t+"="+o),e}function g(){u.onResize()}function f(){u._applyFilter.apply(u,arguments)}function m(e,t,o){for(var r=[],i=0;i<document.styleSheets.length;i++)for(var s in document.styleSheets[i].cssRules?r=document.styleSheets[i].cssRules:document.styleSheets[i].rules&&(r=document.styleSheets[i].rules),r)r[s].selectorText==e&&(r[s].style[t]=o)}n.$on("gridster-item-transition-end",g),n.$on("gridster-resized",g),n.$watch("item.row",function(e,t,o){if(!s.isDragging)return;if(!isNaN(o.item.row)){var r=a.getWidgetsSettings(u.desc.dashboard,d.getNamespace()),i=u.desc.name;r[i]||(r[i]={}),r[i].row=o.item.row,a.setWidgetsSettings(r,u.desc.dashboard,d.getNamespace())}},!0),n.$watch("item.col",function(e,t,o){if(!s.isDragging)return;if(!isNaN(o.item.row)){var r=a.getWidgetsSettings(u.desc.dashboard,d.getNamespace()),i=u.desc.name;r[i]||(r[i]={}),r[i].col=o.item.col,a.setWidgetsSettings(r,u.desc.dashboard,d.getNamespace())}},!0),n.$watch("item.sizeX",function(e,t,o){if(!s.isResizing)return;if(!isNaN(o.item.sizeX)){var r=a.getWidgetsSettings(u.desc.dashboard,d.getNamespace()),i=u.desc.name;r[i]||(r[i]={}),r[i].sizeX=o.item.sizeX,a.setWidgetsSettings(r,u.desc.dashboard,d.getNamespace())}},!0),n.$watch("item.sizeY",function(e,t,o){if(!s.isResizing)return;if(!isNaN(o.item.sizeY)){var r=a.getWidgetsSettings(u.desc.dashboard,d.getNamespace()),i=u.desc.name;r[i]||(r[i]={}),r[i].sizeY=o.item.sizeY,a.setWidgetsSettings(r,u.desc.dashboard,d.getNamespace())}},!0),n.$on("resetWidgets",function(){var e=a.getWidgetsSettings(u.desc.dashboard,d.getNamespace()),t=u.desc.name,o=e[t];if(!o)return;delete o.sizeX,delete o.sizeY,delete o.row,delete o.col,a.setWidgetsSettings(e,u.desc.dashboard,d.getNamespace())}),n.$on("setType:"+n.item.$$hashKey,function(e,t){u.desc.type=t,u.chart&&-1!=t.indexOf("chart")&&u.setType(t.replace("chart",""));n.$broadcast("typeChanged")}),n.$on("share:"+n.item.$$hashKey,function(){var e,t,o=u.chart,r=c.getFiltersShareUrl(),i=r.split("#")[1];i&&-1===i.indexOf("?")?r+="?widget="+n.item.idx:r+="&widget="+n.item.idx;n._elem&&n._elem[0]&&n._elem[0].offsetParent&&(e=n._elem[0].offsetParent.offsetWidth,t=n._elem[0].offsetParent.offsetHeight);t&&(r+="&height="+t);if(r=p(r,"isLegend"),r=p(r,"isTop"),r=p(r,"showZero"),r=p(r,"showValues"),o&&o.series){var s=o.series.map(function(e,t){return{v:e.visible,i:t}}).filter(function(e){return!e.v});s.length&&(r+="&hiddenSeries="+s.map(function(e){return e.i}).join(","))}var a='<iframe style="border: none" src="'+r+'" ';e&&t&&(a=(a=a+'width="'+e+'" ')+'height="'+t+'" ');a+="></iframe>",l.open({template:"src/views/share.html",data:{html:a},controller:"share",showClose:!1,className:"ngdialog-theme-default"})}),n.$on("copyMDX:"+n.item.$$hashKey,function(){var e=u.getMDX();l.open({template:"src/views/share.html",data:{html:e},controller:"share",showClose:!1,className:"ngdialog-theme-default"})}),n.$on("$destroy",function(){i(),h()})}]),angular.module("app").service("Lang",["$window","LANGSTR",function(e,o){var t=this;switch(this.getLanguages=function(){var e=[];for(var t in o)e.push(t);return e},this.get=function(e){return o[t.current]&&o[t.current][e]?o[t.current][e]:e},e.navigator.language.toLowerCase()){case"en":case"ru":this.current="ru";break;case"de":this.current="de";break;default:this.current="en"}}]).filter("lang",["Lang",function(t){return function(e){return t.get(e)}}]).constant("LANGSTR",{en:{resetClickFilter:"Reset click filter",copyMDX:"Copy MDX",seriesColor:"Series colors",copy:"Copy",shareDashboard:"Share dashboard",relatedFilters:"Related filters",theme:"Theme",showLog:"Show log",server:"Server",saveFilters:"Save filters",exportSettings:"Export settings",importSettings:"Import settings",export:"Export",pngImage:"Image (*.png)",svgImage:"Image (*.svg)",jpgImage:"Image (*.jpg)",pdfDoc:"Document (*.pdf)",xlsDoc:"Document (*.xls)",csvDoc:"Document (*.csv)",about:"About",cancel:"Cancel",save:"Save",load:"Load",share:"Share",curSettings:"Current settings",newView:"New",language:"Language",dashboard:"Dashboard",folder:"Folder",signin:"Sign in",signout:"Sign out",login:"Login",signinOAuth:"OAuth sign in",password:"Password",namespace:"Namespace",loading:"Loading...",search:"Search",accept:"Accept",close:"Close",dismiss:"Clear",home:"Home",zoom:"Zoom",resetSettings:"Reset settings",addToFavorites:"Add to favorites",removeFromFav:"Remove from favorites",refresh:"Refresh",showFolders:"Show folders",showTop:"Show top items",viewAs:"View as",count:"Count",filters:"Filters",setDefault:"Reset to default",dashColumns:"Column count",widgetHeight:"Widget height(px)",widgetHeightDyn:"Default: fit to window",noData:"No data to display",byRows:"Display by rows",by2columns:"Display by two columns",by3columns:"Display by three columns",print:"Print...",fav:"Favorites",options:"Settings",gotoDeepSee:"DeepSee",showLegend:"On/off legend",showPivot:"Show as pivot table",back:"Back",exclude:"Exclude",all:"All",interval:"Interval",not:"Not",from:"From",to:"To",metroStyle:"Metro UI",bgColor:"Background color",fntColor:"Font color",icon:"Icon",done:"Done",widget:"Widget",showImages:"Show images",dataSource:"Data source",hideTitle:"Hide title",showZero:"Set axis minimum to zero",showValues:"Show values",err:"Error",errWidgetRequest:"Unable to load widget data",errLoginRequired:"Please enter login",errPassRequired:"Please enter password",errUnauth:"Uknown login and password pair. Please try again",errNotFound:"Requested url not fount on server",errTimeout:"Request timeout",errWidgetNotSupported:"Widget is not supported",errNoWidgets:"No widgets received from server",errNoDashboards:"No dashboards in this namespace",shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},de:{resetClickFilter:"Reset click filter",copyMDX:"Copy MDX",seriesColor:"Series colors",copy:"Copy",shareDashboard:"Share dashboard",relatedFilters:"Related filters",theme:"Oberflächendesign",showLog:"Log",server:"Server",saveFilters:"Filter speichern",exportSettings:"Export Einstellungen",importSettings:"Import Einstellungen",export:"Exportieren",pngImage:"als Bild (*.png)",svgImage:"als Bild (*.svg)",jpgImage:"als Bild (*.jpg)",pdfDoc:"als Dokument (*.pdf)",xlsDoc:"als Dokument (*.xls)",csvDoc:"als Dokument (*.csv)",about:"Über",cancel:"Abbrechen",save:"Speichern",load:"Laden",share:"Teilen",curSettings:"Einstellungen",newView:"Neu",language:"Sprache",dashboard:"Dashboard",folder:"Ordner",signin:"Anmelden",signout:"Abmelden",login:"Benutzer",signinOAuth:"Mit OAuth einloggen",password:"Passwort",namespace:"Namespace",loading:"Laden...",search:"Suche",accept:"Start",close:"Schließen",dismiss:"Leeren",home:"Startseite",zoom:"Zoom",resetSettings:"Kacheln einstellungen",addToFavorites:"Zu Favoriten hinzufügen",removeFromFav:"Von Favoriten entfernen",refresh:"Neu laden",showFolders:"Ordner anzeigen",showTop:"Top Items",viewAs:"Anzeige wechseln",count:"Anzahl",filters:"Filter",setDefault:"Zurücksetzen",dashColumns:"Spaltenanzahl",widgetHeight:"Widget Höhe(px)",widgetHeightDyn:"Default: fit to window",noData:"Keine Daten vorhanden",byRows:"Anzeige nach Zeilen",by2columns:"Anzeige mit zwei Spalten",by3columns:"Anzeige mit drei Spalten",print:"Drucken...",fav:"Favoriten",options:"Einstellungen",gotoDeepSee:"DeepSee",showLegend:"Legende An/Aus",showPivot:"Als Tabelle anzeigen",back:"Zurück",exclude:"Außer",all:"Alle",interval:"Interval",not:"Nicht",from:"Von",to:"Bis",metroStyle:"Metro UI",bgColor:"Farbe Hintergrund",fntColor:"Farbe Schrift",icon:"Icon",done:"Fertig",widget:"Widget",showImages:"Bilder anzeigen",dataSource:"Datenquelle",hideTitle:"Titel verbergen",showZero:"Achsen auf Ursprung",showValues:"Werte anzeigen",err:"Fehler",errWidgetRequest:"Fehler beim Laden der Daten",errLoginRequired:"Bitte anmelden",errPassRequired:"Bitte Passwort eingeben",errUnauth:"Benutzer oder Passwort ungültig",errNotFound:"URL nicht gefunden",errTimeout:"Zeitüberschreitung der Anfrage",errWidgetNotSupported:"Widget nicht unterstützt",errNoWidgets:"Keine Widgets vom Server",errNoDashboards:"Keine Dashboards vorhanden",shortMonths:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]},cs:{resetClickFilter:"Reset click filter",copyMDX:"Copy MDX",seriesColor:"Series colors",copy:"Copy",shareDashboard:"Share dashboard",relatedFilters:"Related filters",saveFilters:"Uložit filtry",exportSettings:"Export nastavení",importSettings:"Import nastavení",export:"Export",pngImage:"Image (*.png)",svgImage:"Image (*.svg)",jpgImage:"Image (*.jpg)",pdfDoc:"Document (*.pdf)",xlsDoc:"Document (*.xls)",csvDoc:"Document (*.csv)",about:"O mě",cancel:"Zrušit",save:"Uložit",load:"Načíst",share:"Sdílet",curSettings:"Momentální nastavení",newView:"Nový",language:"Jazyky",dashboard:"Nástěnka",folder:"Složka",signin:"Přihlásit",signout:"Odhlásit",login:"Uživatelské jméno",signinOAuth:"OAuth sign in",password:"Heslo",namespace:"Namespace",loading:"Načítám...",search:"Hledat",accept:"Příjmout",close:"Zavřít",dismiss:"Zamítnout",home:"Domů",zoom:"Přiblížit",resetSettings:"Reset Titulků",addToFavorites:"Přidat do oblíbených",removeFromFav:"Oddevrat z oblíbench",refresh:"Obnovit",showFolders:"Zobrazit složku",showTop:"Zobrazit první položky",viewAs:"Zobrazit jako",count:"Počet",filters:"Filtry",setDefault:"Obnovit výchozí",dashColumns:"Počet slouců",widgetHeight:"Výška widgetu(px)",widgetHeightDyn:"Default: fit to window",noData:"Nejsou data k zobrazení",byRows:"Zobrazit řádky",by2columns:"Zobrazit podle dvou sloupců",by3columns:"Zobrazit podle tří sloupců",print:"Tisk...",fav:"Oblíbené",options:"Nastavení",gotoDeepSee:"DeepSee",showLegend:"Zapnout/Vypnout Legendu",showPivot:"Zobrazit jako kontingenční tabulku",back:"Zpět",exclude:"Vyloučit",all:"Vše",interval:"Interval",not:"Not",from:"Od",to:"Do",metroStyle:"Metro UI",bgColor:"Barva pozadí",fntColor:"Barva písma",icon:"Ikona",done:"Hotovo",widget:"Widget",showImages:"Zobrazit obrázky",dataSource:"Zdroje dat",hideTitle:"Skrýt titulek",showZero:"Nastavt minimum osy na nulu",showValues:"Zobrazit hodnoty",err:"Error",errWidgetRequest:"Nelze načíst data widgetu",errLoginRequired:"Prosím, zadejte přihlašovací jméno",errPassRequired:"Prosím zadejte heslo",errUnauth:"Nesprávné uživatelské jméno nebo heslo",errNotFound:"Požadovaná adresa URL nbyla nalezena na serveru",errTimeout:"vypršel čas Requestu",errWidgetNotSupported:"Widget není podporován",errNoWidgets:"Žádné přijaté widgety ze serveru",errNoDashboards:"Žádné nástěnky v namespace",shortMonths:["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"]},ru:{resetClickFilter:"Сбросить click фильтр",copyMDX:"Скопировать MDX",seriesColor:"Цвет серий",copy:"Копировать",shareDashboard:"Поделиться дешбордом",relatedFilters:"Взаимосвязанные фильтры",theme:"Тема",showLog:"Показать ошибки",server:"Сервер",saveFilters:"Сохранять фильтры",exportSettings:"Экспорт настроек",importSettings:"Импорт настроек",export:"Экспорт",pngImage:"Картинка (*.png)",svgImage:"Картинка (*.svg)",jpgImage:"Картинка (*.jpg)",pdfDoc:"Документ (*.pdf)",xlsDoc:"Документ (*.xls)",csvDoc:"Документ (*.csv)",about:"О программе",cancel:"Отмена",save:"Сохранить",load:"Загрузить",share:"Поделиться",curSettings:"Текущие настройки",newView:"Добавить",language:"Язык",dashboard:"Индикаторная панель",folder:"Папка",signin:"Вход",signout:"Выход",login:"Логин",signinOAuth:"Вход используя OAuth",password:"Пароль",namespace:"Область",loading:"Загрузка...",search:"Поиск",accept:"Принять",close:"Закрыть",dismiss:"Сбросить",home:"Домой",zoom:"Увеличение",refresh:"Обновить",resetSettings:"Сбросить настройки",addToFavorites:"Добавить в избраное",removeFromFav:"Удалить из избраного",showFolders:"Отображать папки",showTop:"Показать только верхние",viewAs:"Отобразить как",count:"Кол-во",filters:"Фильтры",setDefault:"Установить по умолчанию",dashColumns:"Колонки",widgetHeight:"Высота виджетов(px)",widgetHeightDyn:"По умолчанию: подогнать к высоте окна",noData:"Нет данных",byRows:"Отобразить построчно",by2columns:"Отобразить двумя колонками",by3columns:"Отобразить тремя колонками",print:"Печать...",fav:"Избраное",options:"Настройки",gotoDeepSee:"DeepSee",showLegend:"Вкл/выкл легенду",showPivot:"Показать как таблицу",back:"Назад",exclude:"Исключить",all:"Все",not:"Не",interval:"Интервал",from:"От",to:"До",metroStyle:"Стиль Metro",bgColor:"Цвет фона",fntColor:"Цвет шрифта",icon:"Значок",done:"Готово",widget:"Виджет",showImages:"Отображать картинки",dataSource:"Источник данных",hideTitle:"Скрывать заголовок",showZero:"Отображать 0 на оси",showValues:"Отображать значения",err:"Ошибка",errWidgetRequest:"Невозможо получить данные виджета",errLoginRequired:"Пожалуйста введите логин",errPassRequired:"Пожалуйста введите пароль",errUnauth:"Неверный логин или пароль",errNotFound:"Заданый адрес не найден на сервере",errTimeout:"Превышен интервал ожидания запроса",errWidgetNotSupported:"Виджет не поддерживается",errNoWidgets:"Сервер вернул пустой список виджетов",errNoDashboards:"В данной обласни нет дашбордов",shortMonths:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"]}}),angular.module("app").controller("about",["$scope","$http",function(t,e){e({method:"GET",url:"changelog.md",withCredentials:!(t.changelog="")}).then(function(e){t.changelog=e.data||""})}]);
angular.module("templates").run(["$templateCache", function($templateCache) {$templateCache.put("src/views/about.html","<h2>DeepSeeWeb v.2.1.51</h2>\r\n<p>\r\nRenderer for DeepSee Dashboards in Browser with MDX2JSON as a Serverside and JS web-client.\r\n</p>\r\n<p>More info at: <a href=\"https://github.com/intersystems-ru/DeepSeeWeb\">Github DeepSeeWeb repository</a></p>\r\n<h2>Changelog</h2><div class=\"txt-changelog\">{{changelog}}</div>\r\n\r\n");
$templateCache.put("src/views/dashboard.html","<div ng-cloak>\r\n    <div gridster=\"gridsterOpts\" ng-if=\"!isMobile\">\r\n        <ul>\r\n            <li ng-class=\"{\'panel panel-default widget-holder noselect\': true, \'expanded\': item.isExpanded}\" gridster-item=\"item\" ng-repeat=\"item in model.items\" >\r\n                <div class=\"panel-heading widget-title\">\r\n                    <div class=\"widget-title-btn-left\" ng-show=\"item.backButton\" ng-click=\"item.drillUp()\">\r\n                        <i class=\"fa fa-chevron-left\"></i>&nbsp;{{\'back\' | lang}}\r\n                    </div>\r\n                    <div class=\"widget-title-btn-left\" ng-show=\"item.clickFilterActive\" ng-click=\"item.resetClickFilter()\">\r\n                        <i class=\"fa fa-times\"></i>&nbsp;{{\'resetClickFilter\' | lang}}\r\n                    </div>\r\n                    <div class=\"widget-title-btn\" ng-click=\"item.toggleExpanded()\" ng-class=\"item.isExpanded ? \'active\' : \'\'\">⛶</div>\r\n                    <div class=\"widget-title-btn\" ng-show=\"item.isChart || item.isMap\" ng-click=\"item.displayAsPivot()\" ng-class=\"item.pivotMdx ? \'active\' : \'\'\" title=\"{{\'showPivot\' | lang}}\"><i class=\"fa fa-table\"></i></div>\r\n                    <div class=\"widget-title-btn\" ng-show=\"item.isBtnValues\" ng-click=\"item.toggleValues()\" ng-class=\"item.showValues ? \'active\' : \'\'\" title=\"{{\'showValues\' | lang}}\"><i>v</i></div>\r\n                    <div class=\"widget-title-btn\" ng-show=\"item.isBtnZero\" ng-click=\"item.showZeroOnAxis()\" ng-class=\"item.showZero ? \'active\' : \'\'\" title=\"{{\'showZero\' | lang}}\"><i class=\"fa\">0</i></div>\r\n                    <div class=\"widget-title-btn\" ng-show=\"item.isChart\" ng-click=\"item.toggleTop()\" ng-class=\"item.isTop ? \'active\' : \'\'\" title=\"{{\'showTop\' | lang}}\"><i class=\"fa fa-star\"></i></div>\r\n                    <div class=\"widget-title-btn\" ng-show=\"item.isChart\" ng-click=\"item.toggleLegend()\" ng-class=\"item.isLegend ? \'\' : \'notActive\'\" title=\"{{\'showLegend\' | lang}}\"><i class=\"fa fa-info\"></i></div>\r\n                    <div class=\"widget-title-btn\" ng-show=\"item.isChart\" ng-click=\"item.showSettings()\" title=\"{{\'options\' | lang}}\"><i class=\"fa fa-cog\"></i></div>\r\n                    <div class=\"widget-title-drag\"><span>{{item.title}}</span></div>\r\n                </div>\r\n                <widget class=\"widget\" ng-controller=\"widget\"></widget>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div ng-if=\"isMobile\" class=\"mobile-content\" id=\"mobileDashboard\" ng-style=\"{width: model.items.length*100 + \'vw\' }\" mobile-slider>\r\n        <!--  ng-style=\"{left: $last ? 0 : $index*100+\'vw\'}\"-->\r\n        <div class=\"panel panel-default widget-holder noselect\" ng-repeat=\"item in model.items\">\r\n            <div class=\"widget-title-drag\" ng-class=\"(!item.backButton && !(item.isChart || item.isMap) && !item.isChart && !item.isBtnValues && !item.isBtnZero) ? \'mobile-header-whole\':\'\'\"><span>{{item.title}}</span></div>\r\n            <div class=\"panel-heading widget-title\">\r\n                <div class=\"widget-title-btn-left\" ng-show=\"item.backButton\" ng-click=\"item.drillUp()\">\r\n                    <i class=\"fa fa-chevron-left\"></i>\r\n                </div>\r\n                <div class=\"widget-title-btn\" ng-show=\"item.isChart || item.isMap\" ng-click=\"item.displayAsPivot()\" ng-class=\"item.pivotMdx ? \'active\' : \'\'\" title=\"{{\'showPivot\' | lang}}\"><i class=\"fa fa-table\"></i></div>\r\n                <div class=\"widget-title-btn\" ng-show=\"item.isBtnValues\" ng-click=\"item.toggleValues()\" ng-class=\"item.showValues ? \'active\' : \'\'\" title=\"{{\'showValues\' | lang}}\"><i class=\"fa fa-bar-chart\"></i></div>\r\n                <div class=\"widget-title-btn\" ng-show=\"item.isBtnZero\" ng-click=\"item.showZeroOnAxis()\" ng-class=\"item.showZero ? \'active\' : \'\'\" title=\"{{\'showZero\' | lang}}\"><i class=\"fa fa-level-down\"></i></div>\r\n                <div class=\"widget-title-btn\" ng-show=\"item.isChart\" ng-click=\"item.toggleTop()\" ng-class=\"item.isTop ? \'active\' : \'\'\" title=\"{{\'showTop\' | lang}}\"><i class=\"fa fa-sort-amount-desc\"></i></div>\r\n                <div class=\"widget-title-btn\" ng-show=\"item.isChart\" ng-click=\"item.toggleLegend()\" ng-class=\"item.isLegend ? \'\' : \'notActive\'\" title=\"{{\'showLegend\' | lang}}\"><i class=\"fa fa-list-ul\"></i></div>\r\n            </div>\r\n            <div class=\"mobile-header\"></div>\r\n            <widget class=\"widget\" ng-controller=\"widget\"></widget>\r\n            <div class=\"mobile-header\"></div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"dropdown position-fixed\" id=\"ctx-item-menu\" mobile-hidden>\r\n        <ul class=\"dropdown-menu\" role=\"menu\">\r\n            <li>\r\n                <a class=\"pointer\" role=\"menuitem\" tabindex=\"1\" ng-click=\"refreshItem()\">\r\n                    {{\'refresh\' | lang}}\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a class=\"pointer\" role=\"menuitem\" tabindex=\"2\" ng-click=\"printItem()\">\r\n                    {{\'print\' | lang}}\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a class=\"pointer\" role=\"menuitem\" tabindex=\"3\" ng-click=\"shareItem()\">\r\n                    {{\'share\' | lang}}\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a class=\"pointer\" role=\"menuitem\" tabindex=\"4\" ng-click=\"copyMDX()\">\r\n                    {{\'copyMDX\' | lang}}\r\n                </a>\r\n            </li>\r\n            <li role=\"presentation\" class=\"divider\"></li>\r\n            <li class=\"dropdown-submenu\">\r\n                <a tabindex=\"-1\">{{\'export\' | lang}}</a>\r\n                <ul class=\"dropdown-menu\">\r\n                    <li><a ng-show=\"ctxItem.isChart\" ng-click=\"ctxItem.doExport(\'svg\')\">{{\'svgImage\' | lang}}</a></li>\r\n                    <li><a ng-show=\"ctxItem.isChart\" tabindex=\"-1\" ng-click=\"ctxItem.doExport(\'png\')\">{{\'pngImage\' | lang}}</a></li>\r\n                    <li><a ng-show=\"ctxItem.isChart\" ng-click=\"ctxItem.doExport(\'jpg\')\">{{\'jpgImage\' | lang}}</a></li>\r\n                    <li><a ng-show=\"ctxItem.isChart\" ng-click=\"ctxItem.doExport(\'pdf\')\">{{\'pdfDoc\' | lang}}</a></li>\r\n                    <li><a ng-click=\"ctxItem.doExport(\'xls\')\">{{\'xlsDoc\' | lang}}</a></li>\r\n                    <li><a ng-click=\"ctxItem.doExport(\'csv\')\">{{\'csvDoc\' | lang}}</a></li>\r\n                </ul>\r\n            </li>\r\n            <li class=\"dropdown-submenu\">\r\n                <a tabindex=\"-1\">{{\'viewAs\' | lang}}</a>\r\n                <ul class=\"dropdown-menu\">\r\n                    <li><a tabindex=\"-1\" ng-click=\"setType(\'areachart\')\">Area chart</a></li>\r\n                    <li><a ng-click=\"setType(\'barchart\')\">Bar chart</a></li>\r\n                    <li><a ng-click=\"setType(\'columnchart\')\">Column chart</a></li>\r\n                    <li><a ng-click=\"setType(\'linechart\')\">Line chart</a></li>\r\n                    <li><a ng-click=\"setType(\'piechart\')\">Pie chart</a></li>\r\n                </ul>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>\r\n");
$templateCache.put("src/views/emptyWidgetContent.html","<div ng-repeat=\"flt in model.filters\" class=\"pull-left flt-holder\" ng-style=\"{width: item.viewSize + \'%\'}\">\r\n    <label>{{flt.label}}</label>\r\n    <div class=\"input-group\">\r\n        <input readonly type=\"text\" class=\"form-control input-sm \" value=\"{{flt.text}}\" title=\"{{flt.text}}\" style=\"background-color: #FFF; cursor: pointer\" ng-click=\"toggleFilter(flt.idx,$event)\">\r\n        <span class=\"input-group-btn\">\r\n            <button class=\"btn btn-default btn-sm\" type=\"button\" ng-click=\"toggleFilter(flt.idx,$event)\"><i class=\"fa fa-search\"></i></button>\r\n        </span>\r\n    </div>\r\n</div>\r\n<div ng-repeat=\"choser in item.dsItems\" class=\"pull-left flt-holder\" ng-style=\"{width: item.viewSize + \'%\'}\">\r\n    <label>{{choser.label}}</label>\r\n    <select class=\"form-control input-sm\" ng-model=\"item.dsSelected\" ng-options=\"el for el in choser.labels\" ng-change=\"onDataSourceChange(choser)\"></select>\r\n</div>\r\n\r\n<div ng-repeat=\"var in item.pvItems\" class=\"pull-left flt-holder\" ng-style=\"{width: item.viewSize + \'%\'}\">\r\n    <label>{{var.label}}</label>\r\n    <input class=\"form-control input-xs\" ng-model=\"var.value\" ng-enter=\"emitVarChange(var)\">\r\n</div>");
$templateCache.put("src/views/emptyWidgetToolbar.html","<button\r\n        class=\"btn btn-default btn-sm\"\r\n        ng-click=\"item.setFiltersToDefaults()\"\r\n        title=\"{{\'setDefault\'|lang}}\" ><i class=\"fa fa-undo\"></i>\r\n</button>\r\n<button\r\n        class=\"btn btn-default btn-sm\"\r\n        ng-class=\"item.viewSize == 100 ? \'active\' : \'\'\"\r\n        ng-click=\"item.setViewSize(100)\"\r\n        style=\"outline: none\"\r\n        title=\"{{\'byRows\'|lang}}\"><i class=\"fa fa-bars\"></i>\r\n</button>\r\n<button\r\n        class=\"btn btn-default btn-sm\"\r\n        ng-class=\"item.viewSize == 50 ? \'active\' : \'\'\"\r\n        ng-click=\"item.setViewSize(50)\"\r\n        style=\"outline: none\"\r\n        title=\"{{\'by2columns\'|lang}}\"><i class=\"fa fa-th-large\"></i>\r\n</button>\r\n<button\r\n        class=\"btn btn-default btn-sm\"\r\n        ng-class=\"item.viewSize == 33.33333 ? \'active\' : \'\'\"\r\n        ng-click=\"item.setViewSize(33.33333)\"\r\n        style=\"outline: none\"\r\n        title=\"{{\'by3columns\'|lang}}\"><i class=\"fa fa-th\"></i>\r\n</button>\r\n");
$templateCache.put("src/views/filter.html","<div class=\"flt-modal\">\r\n    <div class=\"mobile-filters-header\" desktop-hidden>{{model.filter.label}}</div>\r\n    <div class=\"mobile-header\" desktop-hidden></div>\r\n    <div class=\"filter-toolbar-holder\">\r\n        <div class=\"flt-toolbar\">\r\n            <div class=\"form-horizontal\" style=\"width: 100%\">\r\n                <input style=\"width: 120px;height: 20px; margin-top: 5px; margin-right: 2px\" class=\"form-control input-sm pull-left\" type=\"search\" placeholder=\"{{\'search\' | lang}}\" ng-model=\"model.search\" ng-change=\"onSearch()\" ng-enter=\"searchFilters()\" auto-focus>\r\n                <div class=\"btn-group pull-right filter-modal-buttons\">\r\n                    <button class=\"btn btn-default btn-sm\" ng-click=\"acceptFilter()\"><i class=\"fa fa-check\"></i>&nbsp;{{\'accept\' | lang}}</button>\r\n                    <button class=\"btn btn-default btn-sm\" ng-click=\"removeFilter()\"><i class=\"fa fa-eraser\"></i>&nbsp;{{\'dismiss\' | lang}}</button>\r\n                    <button class=\"btn btn-default btn-sm\" ng-click=\"closeThisDialog()\"><i class=\"fa fa-remove\"></i></button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"flt-toolbar flt-options\">\r\n            <div class=\"form-horizontal\" style=\"width: 100%\">\r\n                <span ng-hide=\"model.isInterval\">\r\n                    <label class=\"filter-label\">\r\n                        <input type=\"checkbox\" ng-model=\"model.isAll\" ng-click=\"setAll()\">\r\n                        <span>{{\'all\' | lang}}</span>\r\n                    </label>\r\n                </span>\r\n                <span ng-hide=\"model.isInterval\">\r\n                    <label class=\"filter-label\">\r\n                        <input type=\"checkbox\" ng-model=\"model.isExclude\">\r\n                        <span>{{\'exclude\' | lang}}</span>\r\n                    </label>\r\n                </span>\r\n                <label class=\"filter-label\">\r\n                    <input type=\"checkbox\" ng-model=\"model.isInterval\">\r\n                    <span>{{\'interval\' | lang}}</span>\r\n                </label>\r\n            </div>\r\n        </div>\r\n    </div>\r\n<div class=\"container-fluid\" style=\"padding-top: 10px\" ng-show=\"model.isInterval\">\r\n    <div class=\"form-group\">\r\n        <label>{{\'from\' | lang}}</label>\r\n        <select class=\"form-control\" ng-model=\"model.from\" ng-options=\"item.name for item in model.values\"></select>\r\n    </div>\r\n    <div class=\"form-group\">\r\n        <label>{{\'to\' | lang}}</label>\r\n        <select class=\"form-control\" ng-model=\"model.to\" ng-options=\"item.name for item in model.values\"></select>\r\n    </div>\r\n</div>\r\n<div class=\"filter-items\" ng-hide=\"model.isInterval\">\r\n    <table class=\"table table-striped table-hover table-small\">\r\n        <tbody>\r\n            <tr ng-repeat=\"v in model.values\">\r\n                <td style=\"width:24px;padding-left:6px;vertical-align: inherit;\"><input type=\"checkbox\" ng-model=\"v.checked\" ng-click=\"onItemSelect()\"></td>\r\n                <td ng-click=\"toggleRow(v)\" ng-class=\"v.default ? \'bold\' : \'\'\">{{v.name}}<div class=\"flt-item-desc\" ng-if=\"v.info\">{{v.info}}</div></td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n    <div class=\"loader-holder\" ng-show=\"model.isLoading\">\r\n        <div class=\"loader\"></div>\r\n    </div>\r\n    <div class=\"mobile-header\" desktop-hidden></div>\r\n</div>\r\n</div>");
$templateCache.put("src/views/filters.html","<span ng-repeat=\"var in item.pvItems\" class=\"pull-left flt-holder\">\r\n    <label>{{var.label}}</label>\r\n    <input class=\"form-control input-xs\" ng-model=\"var.value\" ng-enter=\"emitVarChange(var)\">\r\n</span>\r\n\r\n<span ng-repeat=\"choser in item.dsItems\" class=\"pull-left flt-holder\">\r\n    <label>{{choser.label}}</label>\r\n    <select class=\"form-control input-sm\" ng-model=\"choser.dsSelected\" ng-options=\"el for el in choser.labels\" ng-change=\"onDataSourceChange(choser)\"></select>\r\n</span>\r\n<span ng-repeat=\"action in item.acItems\" class=\"pull-left flt-holder\">\r\n    <button class=\"form-control btn btn-default btn-sm btn-action\" ng-click=\"performAction(action);\">{{action.label || action.action}}</button>\r\n</span>\r\n<span ng-repeat=\"flt in model.filters\" class=\"pull-left flt-holder\">\r\n    <label>{{flt.label}}</label>\r\n    <div class=\"input-group\">\r\n        <input readonly type=\"text\" class=\"form-control input-sm\" value=\"{{flt.text}}\" title=\"{{flt.text}}\" style=\"cursor: pointer\" ng-click=\"toggleFilter(flt.idx,$event)\">\r\n        <span class=\"input-group-btn\">\r\n            <button class=\"btn btn-default btn-sm\" type=\"button\" ng-click=\"toggleFilter(flt.idx,$event)\"><i class=\"fa fa-search\"></i></button>\r\n        </span>\r\n    </div>\r\n</span>");
$templateCache.put("src/views/home.html","<div ng-cloak>\r\n    <div gridster=\"tilesOpt\">\r\n        <ul class=\"home-tiles-list\">\r\n            <li class=\"metro-tile\"\r\n                ng-class=\"\'cl\' + tile.color + \' \' + (tile.template ? \'tile-with-widget\' : \'\') + \' \' + (tile.Cover ? \'tile-covered\': \'\') +\' \' + (model.editing ? \'editing\' : \'\') + \' \' + (model.edItem == tile ? \'metro-tile-selected\' : \'\')\"\r\n                gridster-item=\"tile\"\r\n                ng-repeat=\"tile in dashboards\"\r\n                ng-click=\"onItemClick(tile, $event)\"\r\n                ng-style=\"{\'background-image\': \'url(\' + tile.Cover + \')\'}\"\r\n                    >\r\n                <div ng-include=\"tile.template\"></div>\r\n                <div class=\"metro-tile-icon\">\r\n                    <svg viewBox=\"-10 -16 20 20\" ng-class=\"model.fontColors[tile.fontColor]\">\r\n                        <g><text text-anchor=\"middle\" font-size=\"16px\">{{model.icons[tile.icon]}}</text></g>\r\n                    </svg>\r\n                </div>\r\n\r\n                <h4 ng-hide=\"tile.hideTitle\" ng-class=\"model.fontColors[tile.fontColor]\"><span ng-show=\"model.edItem != tile\">{{tile.customTitle || tile.title}}</span>\r\n                    <input type=\"text\" ng-model=\"tile.customTitle\" ng-show=\"model.edItem == tile\" blur-on-enter>\r\n                </h4>\r\n\r\n            </li>\r\n        </ul>\r\n\r\n    </div>\r\n    <div class=\"sidebar-bottom\" ng-class=\"model.edItem ? \'\' : \'closed\'\">\r\n        <span class=\"sidebar-block\">\r\n            <label>{{\'bgColor\' | lang}}</label>\r\n            <div class=\"color-rect\" ng-click=\'setTileColor($index)\' ng-class=\"col + \' \' + (model.edItem.color == $index ? \'active\' : \'\')\" ng-repeat=\"col in model.colors\">\r\n                <span class=\"fa fa-check\" ng-show=\"model.edItem.color == $index\"></span>\r\n            </div>\r\n        </span>\r\n        <span class=\"sidebar-block\">\r\n            <label>{{\'fntColor\' | lang}}</label>\r\n            <div ng-click=\'setFontColor($index)\'\r\n                 ng-class=\"\'color-rect \' + \'cl\' + model.edItem.color + \' \' +  (model.edItem.font == $index ? \'active\' : \'\')\"\r\n                 ng-repeat=\"col in model.fontColors\"><span ng-class=\"col\" style=\"margin-left: 7px;margin-top: -1px;\">T</span>\r\n                    <span class=\"fa fa-check\" ng-show=\"model.edItem.fontColor == $index\"></span>\r\n            </div>\r\n        </span>\r\n        <span class=\"sidebar-block\">\r\n            <label>{{\'icon\' | lang}}</label>\r\n            <div class=\"color-rect\" ng-repeat=\"ico in model.icons\"  ng-click=\'setIcon($index)\' ng-class=\"\'cl\' + model.edItem.color + \' \' +  (model.edItem.icon == $index ? \'active\' : \'\')\">\r\n                <svg viewBox=\"-10 -16 20 20\" ng-class=\"model.fontColors[model.edItem.fontColor]\">\r\n                    <g><text text-anchor=\"middle\" font-size=\"16px\">{{ico}}</text></g>\r\n                </svg>\r\n            </div>\r\n        </span>\r\n        <span class=\"sidebar-block\">\r\n            <label>{{\'widget\' | lang}}</label>\r\n            <select ng-model=\"model.edItem.widget\" style=\"min-width: 120px; height: 26px; border: 1px solid #A9A9A9;\">\r\n                <option ng-repeat=\"opt in model.widgetList\" value=\"{{opt.idx}}\" ng-selected=\"opt.idx===model.edItem.widget\">{{opt.name}}</option>\r\n            </select>\r\n        </span>\r\n        <span class=\"sidebar-block\">\r\n            <label>{{\'hideTitle\' | lang}}</label>\r\n            <input type=\"checkbox\" ng-model=\"model.edItem.hideTitle\" blur-on-enter>\r\n        </span>\r\n    </div>\r\n    <div class=\"btn btn-default btn-dashboard\" ng-click=\"enableEditing()\" ng-class=\"model.editing?\'btn-edit-dash\': \'\'\">\r\n        <i class=\"fa fa-wrench\" ng-show=\"!model.editing\"></i>\r\n        <i class=\"fa fa-check\" ng-show=\"model.editing\"> {{\'done\' | lang}}</i>\r\n    </div>\r\n</div>");
$templateCache.put("src/views/log.html","<div class=\"mobile-header\"></div>\r\n{{ngDialogData.html}}");
$templateCache.put("src/views/login.html","<span class=\"ver\">{{model.ver}}</span>\r\n<span class=\"qr-scanner-btn\" desktop-hidden ng-click=\"scanSettings()\"><i class=\"fa fa-camera\"></i></span>\r\n<div class=\"container login-screen\" ng-cloak>\r\n    <div class=\"row logo\">\r\n        <div class=\"col-md-4 col-md-offset-4 center\">\r\n            <img src=\"img/DeepSee.svg\" height=\"100px\" alt=\"logo\" class=\"deepsee-logo\" mobile-hidden>\r\n            <img src=\"img/eye.svg\" height=\"100px\" alt=\"logo\" class=\"deepsee-logo\" desktop-hidden>\r\n            <!--<div class=\"mobile-logo fa fa-eye\" desktop-hidden></div>-->\r\n        </div>\r\n    </div>\r\n    <div class=\"row\">\r\n        <form class=\"col-md-4 col-md-offset-4 login-form\" ng-submit=\"onLoginClick()\">\r\n                <div class=\"form-group\" desktop-hidden=\"\" ng-hide=\"model.isDesktop\">\r\n                    <div class=\"input-group\">\r\n                        <span class=\"input-group-addon\"><i class=\"w16 fa fa-cloud\"></i></span>\r\n                        <input type=\"text\" name=\"server\" class=\"form-control\" ng-model=\"model.server\" placeholder=\"{{\'server\' | lang}}\" focus-next=\"username\">\r\n                    </div>\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <div class=\"input-group\">\r\n                        <span class=\"input-group-addon\"><i class=\"w16 fa fa-user\"></i></span>\r\n                        <input id=\"username\" type=\"text\" name=\"username\" class=\"form-control\" ng-model=\"model.login\" placeholder=\"{{\'login\' | lang}}\" auto-focus focus-next=\"pass\">\r\n                    </div>\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <div class=\"input-group\">\r\n                        <span class=\"input-group-addon\"><i class=\"w16 fa fa-lock\"></i></span>\r\n                        <input id=\"pass\" name=\"password\" type=\"password\" class=\"form-control\" ng-model=\"model.password\" placeholder=\"{{\'password\' | lang}}\" focus-next=\"ns\">\r\n                    </div>\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <div class=\"input-group\">\r\n                        <span class=\"input-group-addon\"><i class=\"w16 fa fa-database\"></i></span>\r\n                        <input id=\"ns\" type=\"text\" class=\"form-control\" ng-model=\"model.namespace\" placeholder=\"{{\'namespace\' | lang}}\" focus-next=\"btnLogin\" required>\r\n                    </div>\r\n                </div>\r\n                <div class=\"button-row\">\r\n                    <div ng-hide=\"model.isDesktop\" class=\"btn btn-block btn-success btn-preset\" ng-click=\"showServers()\" desktop-hidden><i class=\"fa fa-arrow-up\"></i></div>\r\n                    <div ng-hide=\"model.isDesktop\" class=\"btn btn-block btn-success btn-preset\" ng-click=\"saveServer()\" desktop-hidden><i class=\"fa fa-save\"></i></div>\r\n                    <div id=\"btnLogin\" class=\"btn btn-large btn-block btn-success\" ng-click=\"onLoginClick()\">{{\'signin\' | lang}}</div>\r\n                    <div ng-show=\"model.oAuthUrl\" id=\"btnLoginOAuth\" class=\"btn btn-large btn-block btn-link\" ng-click=\"onLoginOAuthClick()\">{{\'signinOAuth\' | lang}}</div>\r\n                </div>\r\n        </form>\r\n    </div>\r\n    <div class=\"row\">\r\n        <div class=\"err-msg\">\r\n            <span class=\"label label-danger\" ng-show=\"model.error\">{{model.error}}</span>\r\n        </div>\r\n    </div>\r\n</div>\r\n");
$templateCache.put("src/views/menu.html","<div ng-controller=\"menu\">\r\n    <nav class=\"navbar navbar-default\" ng-show=\"model.visible\" ng-cloak>\r\n        <div class=\"ver\" mobile-hidden>{{model.ver}}</div>\r\n\r\n        <div class=\"navbar-collapse\">\r\n            <span class=\"navbar-brand\" mobile-hidden>\r\n                {{model.title}}\r\n            </span>\r\n            <span class=\"mobile-navbar-brand\" ng-show=\"!model.onDashboard\" desktop-hidden>\r\n                {{model.title}}\r\n                <span style=\"position: absolute; right: 0; display: none\">\r\n                    <div><i class=\"fa fa-search\"></i>\r\n                        <input type=\"text\" class=\"mobile-dashboard-search form-control\" placeholder=\"{{model.lblSearch}}\" ng-model=\"model.searchText\" ng-change=\"search(model.searchText)\">\r\n                    </div>\r\n\r\n                </span>\r\n            </span>\r\n            <form class=\"navbar-btn navbar-left\">\r\n                <div class=\"btn-group\">\r\n                    <div class=\"btn btn-default\" ng-click=\"onHomeClick()\"><i class=\"fa fa-home\"></i><span desktop-hidden>{{model.lblHome}}</span></div>\r\n                </div>\r\n\r\n                <div class=\"btn-group\" ng-show=\"model.favs.length != 0 || model.onDashboard\">\r\n                    <div type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\" aria-expanded=\"false\">\r\n                        <i class=\"fa\" ng-class=\"model.canAdd ? \'fa-star-o\':\'fa-star\'\"></i><span desktop-hidden>{{model.lblFav}}</span>\r\n                    </div>\r\n                    <ul class=\"dropdown-menu\" role=\"menu\" style=\"cursor: pointer\">\r\n                        <li ng-show=\"model.canAdd && model.onDashboard\"><a hreaf=\"\" ng-click=\"addToFavorites()\"><span>{{\'addToFavorites\' | lang}}</span></a></li>\r\n                        <li ng-show=\"!model.canAdd && model.onDashboard\"><a hreaf=\"\" ng-click=\"removeFromFav()\"><span>{{\'removeFromFav\' | lang}}</span></a></li>\r\n                        <li class=\"divider\" ng-show=\"model.favs.length != 0 && model.onDashboard\"></li>\r\n                        <li ng-repeat=\"fav in model.favs\"><a hreaf=\"\" ng-click=\"navigateFav(fav)\">{{fav.label}}</a></li>\r\n                    </ul>\r\n                </div>\r\n                <div class=\"btn-group\">\r\n                    <div type=\"button\" class=\"btn btn-default\" ng-click=\"showSettings()\">\r\n                        <i class=\"fa fa-gear\"></i><span desktop-hidden>{{model.lblSettings}}</span>\r\n                    </div>\r\n                </div>\r\n                <div class=\"btn-group\" ng-show=\"!model.onDashboard\" desktop-hidden>\r\n                    <div type=\"button\" title=\"{{\'signout\' | lang}}\" class=\"btn btn-default\" ng-click=\"onSingoutClick()\"><span mobile-hidden>{{model.username}}&nbsp;</span><i class=\"fa fa-sign-out\"></i><span>{{model.lblLogout}}</span></div>\r\n                </div>\r\n\r\n                <div class=\"btn-group\" ng-show=\"model.onDashboard\" mobile-hidden>\r\n                    <div class=\"btn btn-default\" ng-click=\"gotoDeepSee()\" title=\"{{\'gotoDeepSee\'|lang}}\"><i class=\"fa fa-mail-forward\"></i><span desktop-hidden>{{\'gotoDeepSee\'|lang}}</span></div>\r\n                </div>\r\n\r\n                <div class=\"btn-group\" ng-show=\"model.onDashboard\" mobile-hidden>\r\n                    <div class=\"btn btn-default\" ng-click=\"shareDashboard()\" title=\"{{\'shareDashboard\'|lang}}\"><i class=\"fa fa-link\"></i><span desktop-hidden>{{\'shareDashboard\'|lang}}</span></div>\r\n                </div>\r\n\r\n                <div class=\"btn-group\" ng-show=\"model.onDashboard\" desktop-hidden mobile-hidden>\r\n                    <div type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\" aria-expanded=\"false\">\r\n                        <i class=\"fa fa-list\"></i>\r\n                    </div>\r\n                    <ul class=\"dropdown-menu\" role=\"menu\" style=\"cursor: pointer\">\r\n                        <li><a hreaf=\"\" >dfsfds</a></li>\r\n                        <li><a hreaf=\"\" >dfsfds</a></li>\r\n                        <li><a hreaf=\"\" >dfsfds</a></li>\r\n                        <li><a hreaf=\"\" >dfsfds</a></li>\r\n                    </ul>\r\n                </div>\r\n\r\n                <div class=\"btn-group\" ng-show=\"model.onDashboard && model.filterButton\" desktop-hidden>\r\n                    <div class=\"btn btn-default\" ng-class=\"model.filtersVisible ? \' active\': \'\'\" ng-click=\"showGlobalFilter()\"><i class=\"fa fa-filter\"></i><span>{{model.lblFilter}}</span></div>\r\n                </div>\r\n\r\n                <div class=\"btn-group\" mobile-hidden>\r\n                    <div class=\"btn btn-default\" ng-click=\"about()\"><i class=\"fa fa-question\"></i><span desktop-hidden>{{model.lblAbout}}</span></div>\r\n                </div>\r\n            </form>\r\n\r\n            <form class=\"navbar-form navbar-left\" role=\"search\" ng-show=\"!model.onDashboard\" mobile-hidden>\r\n                <div class=\"input-group\">\r\n                    <input type=\"text\" class=\"form-control\" placeholder=\"{{model.lblSearch}}\" ng-model=\"model.searchText\" ng-change=\"search(model.searchText)\">\r\n                    <span class=\"input-group-btn\">\r\n                        <div class=\"btn btn-default\" type=\"button\" ng-click=\"model.searchText=\'\';search(\'\')\" style=\"outline: none\"><i class=\"fa fa-remove\"></i></div>\r\n                    </span>\r\n                </div>\r\n            </form>\r\n\r\n            <form class=\"navbar-form navbar-right\" mobile-hidden>\r\n                <span class=\"info-dev\" ng-show=\"model.devMode\"><i class=\"fa fa-link\"></i>&nbsp;Dev mode: {{model.devMode}}&nbsp;</span>\r\n                <div class=\"btn-group\" mobile-hidden>\r\n                    <div type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\" aria-expanded=\"false\" title=\"EN\">\r\n                        <i class=\"fa fa-comment\"></i><span desktop-hidden>{{model.lblLang}}</span>\r\n                    </div>\r\n                    <ul class=\"dropdown-menu\" role=\"menu\" style=\"cursor: pointer\">\r\n                        <li><a hreaf=\"\" ng-click=\"setLang(lang)\" ng-repeat=\"lang in model.langs\">{{lang}}</a></li>\r\n                    </ul>\r\n                </div>\r\n                <ul class=\"nav navbar-nav\">\r\n                    <li class=\"dropdown\">\r\n                        <a class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\"><i class=\"fa fa-database\"></i> {{model.namespace}}<span class=\"caret\"></span></a>\r\n                        <ul class=\"spaces dropdown-menu\">\r\n                            <li ng-class=\"{active: ns.toLowerCase() === model.namespace.toLowerCase()}\" ng-repeat=\"ns in model.namespaces track by $index\"><a ng-click=\"changeNamespace(ns)\">{{ns}}</a></li>\r\n                        </ul>\r\n                    </li>\r\n                </ul>\r\n                <div class=\"btn-group\">\r\n                    <div style=\"flex-direction: row\" title=\"{{model.lblLogout}}\" class=\"btn-sign-out btn btn-default\" ng-click=\"onSingoutClick()\"><span>{{model.username}}</span><i class=\"fa fa-sign-out\"></i></div>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    </nav>\r\n</div>");
$templateCache.put("src/views/serverList.html","<div class=\"dialog-contents\">\r\n    <h3 class=\"settings-header\">{{\'server\' | lang}}</h3>\r\n    <div class=\"mob-header-btn-right\" ng-click=\"toggleDeleteMode()\"><i class=\"fa fa-trash-o\"></i></div>\r\n    <div class=\"container-fluid\">\r\n\r\n                <div role=\"tabpanel\" class=\"tab-pane active settings-content\" id=\"main\">\r\n                    <div class=\"mobile-header\" desktop-hidden></div>\r\n                    <div class=\"container-fluid\">\r\n                        <div class=\"mob-list-item\" style=\"justify-content: space-between;white-space: nowrap;overflow: hidden;\" ng-repeat=\"srv in model.servers track by $index\" ng-click=\"selectServer(srv, $event)\">\r\n                            <span style=\"display: flex; align-items: center;\">\r\n                                <input type=\"checkbox\" style=\"margin-right: 6px; margin-left: -6px\" ng-show=\"model.isDeleteMode\" ng-model=\"srv.doDelete\">\r\n                                <strong style=\"margin-right: 16px\">{{srv.name}}</strong>\r\n                            </span>\r\n                            <span style=\"float: right\">\r\n                                <i class=\"w16 fa fa-cloud\"></i>&nbsp;<span style=\"margin-right: 10px\">{{srv.server}}</span>\r\n                                <i class=\"w16 fa fa-user\"></i>&nbsp;{{srv.login}}\r\n                            </span>\r\n                        </div>\r\n                        <div class=\"mobile-header\" ng-show=\"model.isDeleteMode\"></div>\r\n                    </div>\r\n                </div>\r\n\r\n\r\n        <div class=\"line-divider\" mobile-hidden></div>\r\n\r\n        <div class=\"row modal-mobile-footer\" ng-show=\"model.isDeleteMode\">\r\n            <!--<div class=\"col-md-6\" mobile-hidden>-->\r\n                <!--<div class=\"input-group\">-->\r\n                    <!--<div class=\"float-left\" ng-hide=\"model.addMode\">-->\r\n                        <!--{{\'curSettings\' | lang}}&nbsp;-->\r\n                    <!--</div>-->\r\n                    <!--<select class=\"float-left\" ng-show=\"!model.addMode\" ng-model=\"model.selectedSettings\" ng-options=\"item for item in model.settingsNames\" ></select>-->\r\n                    <!--<input class=\"float-left input-xs\" type=\"text\" ng-show=\"model.addMode\" ng-model=\"model.settingsName\" focus-func=\"setFocusOnInput\" ng-enter=\"onAddClick()\">-->\r\n                    <!--<span class=\"input-group-btn float-left\">-->\r\n                        <!--<button type=\"button\" class=\"btn btn-default btn-xs\" ng-click=\"onAddClick()\" ng-hide=\"model.addMode\">+</button>-->\r\n                        <!--<button type=\"button\" class=\"btn btn-default btn-xs\" ng-click=\"onCancelClick()\" ng-show=\"model.addMode\"><i class=\"fa fa-close\"></i></button>-->\r\n                    <!--</span>-->\r\n                <!--</div>-->\r\n            <!--</div>-->\r\n            <!--<div class=\"col-md-6\">-->\r\n                <!--<div class=\"pull-right\">-->\r\n                    <!--<button type=\"button\" class=\"btn btn-default\" ng-click=\"onLoadClick()\">{{\'load\' | lang}}</button>-->\r\n                    <!--<button type=\"button\" class=\"btn btn-default\" ng-click=\"applySettrings()\">{{\'save\' | lang}}</button>-->\r\n                    <!--<button type=\"button\" class=\"btn btn-default\" ng-click=\"closeThisDialog()\" mobile-hidden>{{\'close\' | lang}}</button>-->\r\n                <!--</div>-->\r\n            <!--</div>-->\r\n            <div class=\"col-md-6\">\r\n                <div class=\"pull-right\">\r\n                    <button type=\"button\" class=\"btn btn-default\" ng-click=\"deleteServers()\">{{\'accept\' | lang}}</button>\r\n                    <button type=\"button\" class=\"btn btn-default\" ng-click=\"cancelDeleteMode()\">{{\'cancel\' | lang}}</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    <!--</div>-->\r\n</div>");
$templateCache.put("src/views/settings.html","    <div class=\"dialog-contents\" ng-init=\"onInit()\">\r\n    <h3 class=\"settings-header\">{{\'options\' | lang}}</h3>\r\n    <div class=\"container-fluid\">\r\n        <div class=\"row\">\r\n            <ul ng-hide=\"model.isWidgetSettings\" class=\"nav nav-tabs settings-tabbar\" role=\"tablist\">\r\n                <li role=\"presentation\" class=\"active settings-tab\"><a data-target=\"#main\" aria-controls=\"main\" role=\"tab\" data-toggle=\"tab\">Main</a></li>\r\n                <li role=\"presentation\" class=\"settings-tab\"><a data-target=\"#colors\" aria-controls=\"colors\" role=\"tab\" data-toggle=\"tab\">Colors</a></li>\r\n                <!--<li role=\"presentation\" class=\"settings-tab\"><a data-target=\"#addons\" aria-controls=\"addons\" role=\"tab\" data-toggle=\"tab\">Addons</a></li>-->\r\n            </ul>\r\n            <div class=\"tab-content\">\r\n                <div ng-hide=\"model.isWidgetSettings\" role=\"tabpanel\" class=\"tab-pane active settings-content\" id=\"main\">\r\n                    <div class=\"mobile-header\" desktop-hidden></div>\r\n                    <div class=\"container-fluid\">\r\n                        <div class=\"row\">\r\n                                    <div class=\"col-md-4\">\r\n                                        <div class=\"form-group\">\r\n                                            {{\'language\' | lang}}\r\n                                            <select ng-model=\"model.language\">\r\n                                                <option ng-repeat=\"l in ::model.langs\" value=\"{{::l}}\" ng-selected=\"{{::l==model.language}}\">{{::l}}</option>\r\n                                            </select>\r\n                                        </div>\r\n                                        <div class=\"form-group\" mobile-hidden>\r\n                                            {{\'theme\' | lang}}\r\n                                            <select ng-model=\"model.theme\" ng-options=\"item.file as item.text for item in model.themes\"></select>\r\n                                        </div>\r\n                                        <div class=\"checkbox\">\r\n                                            <label>\r\n                                                <input type=\"checkbox\" ng-model=\"model.showFolders\">\r\n                                                <span>\r\n                                                    {{\'showFolders\' | lang}}\r\n                                                </span>\r\n                                            </label>\r\n                                        </div>\r\n                                        <div class=\"checkbox\">\r\n                                            <label>\r\n                                                <input type=\"checkbox\" ng-model=\"model.showImages\">\r\n                                                <span>\r\n                                                {{\'showImages\' | lang}}\r\n                                                </span>\r\n                                            </label>\r\n                                        </div>\r\n                                        <div class=\"checkbox\">\r\n                                            <label>\r\n                                                <input type=\"checkbox\" ng-model=\"model.isSaveFilters\"><span>{{\'saveFilters\' | lang}}</span>\r\n                                            </label>\r\n                                        </div>\r\n                                        <div class=\"checkbox\">\r\n                                            <label>\r\n                                                <input type=\"checkbox\" ng-model=\"model.isRelatedFilters\"><span>{{\'relatedFilters\' | lang}}</span>\r\n                                            </label>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class=\"col-md-4\" mobile-hidden>\r\n                                        <div class=\"form-group\">\r\n                                            <span>{{\'dashColumns\' | lang}}</span>\r\n                                            <input class=\"input-xs\" type=\"text\" ng-model=\"model.colCount\">\r\n                                            <span>{{\'widgetHeight\' | lang}}</span>\r\n                                            <input class=\"input-xs\" type=\"text\" ng-model=\"model.widgetHeight\" placeholder=\"{{\'widgetHeightDyn\' | lang}}\">\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class=\"col-md-4\">\r\n                                        <div class=\"form-group mobile-action-buttons\">\r\n                                            <button type=\"button\" class=\"btn btn-default btn-xs\" ng-click=\"resetSettings()\" mobile-hidden>{{\'resetSettings\' | lang}}</button>\r\n                                            <button type=\"button\" class=\"btn btn-default btn-xs\" ng-click=\"exportSettings()\" mobile-hidden>{{\'exportSettings\' | lang}}</button>\r\n                                            <button type=\"button\" class=\"btn btn-default btn-xs\" ng-click=\"showLog()\" desktop-hidden=\"\">{{\'showLog\' | lang}}</button>\r\n                                        </div>\r\n                                    </div>\r\n                        </div>\r\n                        <div class=\"row\" mobile-hidden>\r\n                            <div class=\"col-md-4\">\r\n                                <div class=\"form-group\">\r\n                                    {{\'importSettings\' | lang}}\r\n                                    <div id=\"uploader-block\"><input id=\"uploader\" class=\"fm-uploader\" type=\"file\" enctype=\"multipart/form-data\"/></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div ng-class=\"model.isWidgetSettings ? \'active\': \'\'\" role=\"tabpanel\" class=\"tab-pane settings-content\" id=\"colors\">\r\n                    <div class=\"container-fluid\">\r\n                        <div class=\"col-md-6\">\r\n                            {{\'seriesColor\' | lang}}\r\n                            <div class=\"row\" ng-repeat=\"c in model.themeColors.hcColors track by $index\" >\r\n                                <color-picker ng-model=\"model.themeColors.hcColors[$index]\" options=\"model.colorPickerOpt\"></color-picker>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            Chart background\r\n                            <color-picker ng-model=\"model.themeColors.hcBackground\" options=\"model.colorPickerOpt\"></color-picker>\r\n                            Lines color\r\n                            <color-picker ng-model=\"model.themeColors.hcLineColor\" options=\"model.colorPickerOpt\"></color-picker>\r\n                            Text color\r\n                            <color-picker ng-model=\"model.themeColors.hcTextColor\" options=\"model.colorPickerOpt\"></color-picker>\r\n                            Series border color\r\n                            <color-picker ng-model=\"model.themeColors.hcBorderColor\" options=\"model.colorPickerOpt\"></color-picker>\r\n                            Fill opacity\r\n                            <input class=\"input-xs\" type=\"text\" ng-model=\"model.themeColors.hcOpacity\">\r\n                        </div>\r\n                        <div class=\"col-md-4\">\r\n                            <div class=\"form-group mobile-action-buttons\">\r\n                                <button type=\"button\" class=\"btn btn-default btn-xs\" ng-click=\"resetColors()\" mobile-hidden>{{\'resetColors\' | lang}}</button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div role=\"tabpanel\" class=\"tab-pane settings-content\" id=\"addons\">\r\n                    <div style=\"width:100%; height: 100%\" mobile-hidden></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n\r\n        <div class=\"line-divider\" mobile-hidden></div>\r\n        <div class=\"row modal-mobile-footer\">\r\n            <div class=\"col-md-12\">\r\n                <div class=\"pull-right\">\r\n                    <button type=\"button\" class=\"btn btn-default\" ng-click=\"applySettrings()\">{{\'save\' | lang}}</button>\r\n                    <button type=\"button\" class=\"btn btn-default\" ng-click=\"closeThisDialog()\" mobile-hidden>{{\'close\' | lang}}</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>");
$templateCache.put("src/views/share.html","<textarea rows=\"8\" style=\"width: 100%\">{{ngDialogData.html}}</textarea>\r\n<div style=\"width: 100%; text-align: center\">\r\n    <button type=\"button\" class=\"btn btn-default\" ng-click=\"closeThisDialog()\">{{\'close\' | lang}}</button>\r\n</div>\r\n");
$templateCache.put("src/views/shareDashboard.html","<div class=\"dialog-contents\" ng-init=\"onInit()\">\r\n    <h3 class=\"settings-header\">{{\'shareDashboard\' | lang}}</h3>\r\n    <div class=\"container-fluid\">\r\n        <input id=\"shareText\" class=\"input-sm\" value=\"{{ngDialogData.url}}\" style=\"width: 100%;\">\r\n        <div class=\"line-divider\" mobile-hidden></div>\r\n        <div class=\"row modal-mobile-footer\">\r\n            <div class=\"col-md-12\">\r\n                <div class=\"pull-right\">\r\n                    <button type=\"button\" class=\"btn btn-default\" ng-click=\"copyUrl()\">{{\'copy\' | lang}}</button>\r\n                    <button type=\"button\" class=\"btn btn-default\" ng-click=\"closeThisDialog()\" mobile-hidden>{{\'close\' | lang}}</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>");
$templateCache.put("src/views/tile.html","<div class=\"widget\" ng-controller=\"widget\" style=\"width: 100%; height: 100%;  pointer-events: none;\">\r\n    <div widget-content=\"getDesc(item.idx).type\" class=\"widget-content\" style=\"top: 0px;\"></div>\r\n</div>");
$templateCache.put("src/views/widget.html","<div class=\"widget-toolbar\" ng-show=\"item.toolbar\" ng-include=\"item.toolbarView\"></div>\r\n\r\n<!-- widget content -->\r\n<div context-menu=\"onCtxMenuShow(item)\" context-menu-disabled=\"item.menuDisabled\" data-target=\"ctx-item-menu\" ng-class=\"{ \'highlight\': highlight, \'expanded\' : expanded }\">\r\n    <div widget-content=\"getDesc(item.idx).type\" class=\"widget-content\" style=\"top:{{item.toolbar?52:16}}px\"></div>\r\n</div>\r\n<!-------------------->\r\n<!--\r\n<div class=\"widget-loader\" ng-show=\"item.isLoading\"><div class=\"loader\"></div></div>\r\n-->\r\n<div class=\"widget-error\" ng-show=\"model.error\">{{model.error}}</div>");}]);